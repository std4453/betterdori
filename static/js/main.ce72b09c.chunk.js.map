{"version":3,"sources":["assets/cancel.svg","assets/submit.svg","assets/settings.svg","assets/hamburger.svg","assets/delete.svg","assets/album.svg","assets/export.svg","assets/import.svg","assets/select.svg","assets/single.svg","assets/slide-1.svg","assets/slide-2.svg","assets/flick.svg","assets/timer.svg","assets/player.svg","assets/pause.svg","assets/play.svg","assets/x05.svg","assets/x10.svg","assets/x15.svg","assets/x20.svg","assets/follow.svg","assets/bars.svg","assets/d1.svg","assets/d2.svg","assets/d3.svg","assets/d4.svg","assets/d6.svg","assets/d8.svg","assets/focus.svg","assets/cross.svg","assets/flick.mp3","assets/tap.mp3","ui/Toolbar.jsx","ui/Button.jsx","chart/storage.js","ui/Dialog.jsx","ui/Menus.jsx","tools/useEvent.js","ui/Control.jsx","ui/Carousel.jsx","ui/Switch.jsx","ui/Controls.jsx","chart/useTool.js","chart/useScore.js","chart/useResettableState.js","chart/useChart.js","tools/useFrame.js","chart/Score.jsx","chart/Bars.jsx","chart/Notes.jsx","tools/useDrag.js","utils.js","chart/Thumb.jsx","chart/Stencil.jsx","chart/ThumbTimers.jsx","tools/Player.jsx","tools/SoundFX.jsx","tools/Progress.jsx","tools/usePen.js","tools/Placement.jsx","tools/Divisions.jsx","tools/Modification.jsx","tools/PlaceTimer.jsx","tools/Select.jsx","chart/Navigation.jsx","chart/Chart.jsx","Loading.jsx","App.js","serviceWorker.js","index.js"],"names":["module","exports","useStyles","makeStyles","root","position","display","flexDirection","justifyContent","width","Toolbar","children","classes","className","height","cursor","userSelect","content","pointerEvents","left","top","right","bottom","border","borderWidth","alignItems","selected","backgroundColor","icon","alt","color","fontFamily","fontWeight","fontSize","marginBottom","Button","onClick","props","useState","ctrl","setCtrl","useEffect","onKeyDown","e","key","onKeyUp","window","addEventListener","removeEventListener","classNames","src","emptyScore","type","cmd","beat","bpm","save","data","localStorage","setItem","JSON","stringify","createSubmit","timers","notes","convert","score","forEach","push","lane","note","sort","submit","newTimers","newNotes","setTimeout","console","log","useDialog","opened","setOpened","resolve","setResolve","reject","setReject","open","useCallback","Promise","finally","useMemo","overlay","zIndex","sheetContainer","sheet","padding","horizontal","marginTop","cell","title","lineHeight","input","outline","paddingLeft","text","paddingRight","button","DialogContext","createContext","Dialog","dialog","form","useForm","context","onSubmit","handleSubmit","Provider","value","CSSTransition","in","timeout","mountOnEnter","unmountOnExit","Sheet","useContext","Horizontal","Cell","el","Element","innerRef","rest","classes2","ref","Title","Input","inheritClasses","register","Text","Cancel","cancel","Submit","url","marginRight","Menus","setScore","musicURL","setMusicURL","deleteDialog","openDeleteDialog","a","musicURLDialog","openMusicURLDialog","hamburger","deleteIcon","album","name","defaultValue","exportIcon","importIcon","settings","useEvent","fn","wrappedFn","container","Control","code","setCode","matchCode","index","childrenCount","Children","count","margin","Math","min","style","Carousel","state","setState","states","icons","ind","indexOf","next","length","nonactive","opacity","Switch","Controls","music","follow","setFollow","setDivision","currentBPM","setCurrentBPM","paused","setPausedRaw","setPaused","pause","play","updatePaused","playbackRate","setPlaybackRateRaw","setPlaybackRate","updatePlaybackRate","setD1","setD2","setD3","setD4","setD6","setD8","bpmDialog","openBPMDialog","select","single","slide1","slide2","flick","timer","bars","d1","d2","d3","d4","d6","d8","player","x05","x10","x15","x20","followIcon","useTool","useScore","duration","time2Timers","scaleRef","containerEl","setContainerEl","scrollRef","useRef","x","rect","setRect","getBoundingClientRect","inflate","y","current","clientY","clientX","time","max","le","startTime","ratioTop","keepInView","viewTop","innerHeight","deflate","mouseRef","updateMouse","useResettableState","initial","setValue","division","scale","progressOffset","scrollSpeed","thumbScrollSpeed","scaleSpeed","minScale","maxScale","useChart","initialTimers","res","createTree","insert","initialNotes","setTimers","setNotes","useAutoSave","ranges","lastTime","it1","begin","it2","at","hasNext","beat1","beat2","time1","time2","end","time2Notes","quantize","rangeStartTime","rangeStartBeat","rangeEndBeat","gt","quantizedBeat","round","quantizedTime","delta","abs","countNotes","valid","findNotePure","it","ge","findNote","forEachNote","visit","filter","forEachGroup","matchNotePure","threshold","minBeat","startBeat","minDist","minLane","NaN","noteBeat","noteLane","dist","pow","isNaN","matchNote","snakes","pos","lastY","lastLane","y1","x0","x1","y0","tapLines","maxLane","start","deltaBeat","major","useFrame","requestAnimationFrame","onFrameWrapped","overflow","willChange","canvas","Score","onContextMenu","preventDefault","stopPropagation","setCanvas","ctx","getContext","endTime","fillStyle","fillRect","currentTime","updateView","params","mouse","laneWidth","i","side","lineWidth","strokeStyle","beginPath","moveTo","lineTo","stroke","renderLanes","scroll","deltaTime","cy","setLineDash","renderBars","textAlign","font","bottomTime","nextTime","fillText","cx","closePath","fill","renderTimers","renderTapLines","cx0","cx1","cy0","cy1","renderSnakes","progress","renderProgress","startsWith","toFixed","renderPlacementCaret","renderPlayerCaret","thumb","slide","full","middle","selecting","arc","PI","size","renderNotes","lanes","sideLane","borderRight","marginLeft","middleLane","bar","borderBottom","Bars","borderRadius","visibility","transform","boxSizing","focusable","focus","borderLeft","borderTop","tapLine","snake","middleSelected","Note","cross","Snake","viewBox","preserveAspectRatio","strokeWidth","points","Notes","noteEls","useDrag","onDragStart","onDrag","onDragEnd","dragging","shift","lestX","startX","startY","onMouseDown","shiftKey","lastX","onMouseMove","steps","t","onMouseUp","normalizeWheel","event","sX","sY","pX","pY","detail","wheelDelta","wheelDeltaY","wheelDeltaX","axis","HORIZONTAL_AXIS","deltaY","deltaX","deltaMode","spinX","spinY","pixelX","pixelY","Thumb","thumbEl","setThumbEl","updateScroll","viewSize","onWheel","nativeEvent","viewHeight","newTop","newScroll","stencil","Stencil","Timer","ThumbTimers","timerEls","Player","onSpace","_","setMyCode","handleKeys","onKeyEvent","isDisabled","SoundFX","tap","Howl","tapFX","flickFX","lastTimeRef","onFrame","hasTap","hasFlick","Progress","seekProgress","usePen","prefix","useRemove","quantizeThreshold","snapThreshold","notesRef","codeRef","overriddenSetNotes","quantizedLane","matched","matchedLane","remove","placeNote","singleClick","substring","toUpperCase","notePos","update","foundTail","lt","prev","Placement","setSingle","setSlideA","setSlideB","Divisions","setDivision1","setDivision2","setDivision3","setDivision4","setDivision6","setDivision8","modifyNote","Modification","setFlick","PlaceTimer","find","dragArea","dragLine","Select","setSelect","click","move","matchedTime","startIndex","setDragArea","setDragLine","sqrt","x2","y2","setAttribute","clearSelectionPure","toggleNotesPure","endBeat","startLane","endLane","tmpSource","newIt","tmpNotes","deltaLane","newBeat","newLane","lane1","lane2","Navigation","ctrlKey","ratio","newScale","newHeight","prevent","passive","Chart","chartParams","scoreParams","toolParams","Loading","App","initialScore","item","getItem","parse","load","Audio","musicLoaded","setMusicLoaded","onDurationChange","onEmptied","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.ce72b09c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/cancel.f8a7f639.svg\";","module.exports = __webpack_public_path__ + \"static/media/submit.4360bbde.svg\";","module.exports = __webpack_public_path__ + \"static/media/settings.348c169b.svg\";","module.exports = __webpack_public_path__ + \"static/media/hamburger.833119f1.svg\";","module.exports = __webpack_public_path__ + \"static/media/delete.5075b33e.svg\";","module.exports = __webpack_public_path__ + \"static/media/album.5f063155.svg\";","module.exports = __webpack_public_path__ + \"static/media/export.2a28091b.svg\";","module.exports = __webpack_public_path__ + \"static/media/import.f76106f8.svg\";","module.exports = __webpack_public_path__ + \"static/media/select.c1d3a7c6.svg\";","module.exports = __webpack_public_path__ + \"static/media/single.710e706e.svg\";","module.exports = __webpack_public_path__ + \"static/media/slide-1.9c55945b.svg\";","module.exports = __webpack_public_path__ + \"static/media/slide-2.e739354f.svg\";","module.exports = __webpack_public_path__ + \"static/media/flick.7b4a2e40.svg\";","module.exports = __webpack_public_path__ + \"static/media/timer.593d700f.svg\";","module.exports = __webpack_public_path__ + \"static/media/player.07060722.svg\";","module.exports = __webpack_public_path__ + \"static/media/pause.9cf9cdb6.svg\";","module.exports = __webpack_public_path__ + \"static/media/play.aa3ead50.svg\";","module.exports = __webpack_public_path__ + \"static/media/x05.535eb49c.svg\";","module.exports = __webpack_public_path__ + \"static/media/x10.bedeac54.svg\";","module.exports = __webpack_public_path__ + \"static/media/x15.b4cf543a.svg\";","module.exports = __webpack_public_path__ + \"static/media/x20.f8430c66.svg\";","module.exports = __webpack_public_path__ + \"static/media/follow.f06e8e66.svg\";","module.exports = __webpack_public_path__ + \"static/media/bars.04bc19f8.svg\";","module.exports = __webpack_public_path__ + \"static/media/d1.d440bb37.svg\";","module.exports = __webpack_public_path__ + \"static/media/d2.70994b05.svg\";","module.exports = __webpack_public_path__ + \"static/media/d3.bed3323c.svg\";","module.exports = __webpack_public_path__ + \"static/media/d4.9e36ff58.svg\";","module.exports = __webpack_public_path__ + \"static/media/d6.0d8fa81a.svg\";","module.exports = __webpack_public_path__ + \"static/media/d8.c7296f0f.svg\";","module.exports = __webpack_public_path__ + \"static/media/focus.b3b0efea.svg\";","module.exports = __webpack_public_path__ + \"static/media/cross.53b51969.svg\";","module.exports = __webpack_public_path__ + \"static/media/flick.190f0e5d.mp3\";","module.exports = __webpack_public_path__ + \"static/media/tap.343a1b11.mp3\";","import React from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'flex-start',\n        width: '2em',\n    },\n});\n\nfunction Toolbar({ children }) {\n    const classes = useStyles();\n    return (\n        <div className={classes.root}>\n            {children}\n        </div>\n    );\n}\n\nexport default Toolbar;\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport classNames from 'classnames';\n\nconst useStyles = makeStyles({\n    root: {\n        width: '2em',\n        height: '2em',\n        cursor: 'pointer',\n        userSelect: 'none',\n        position: 'relative',\n        '&:after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            pointerEvents: 'none',\n            left: 0,\n            top: 0,\n            right: 0,\n            bottom: 0,\n            border: '0px solid black',\n        },\n        '&:hover:after': {\n            borderWidth: 5,\n        },\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    selected: {\n        backgroundColor: 'rgba(0, 0, 0, 0.06)',\n    },\n    icon: {\n        pointerEvents: 'none',\n        height: '2em',\n    },\n    alt: {\n        position: 'absolute',\n        left: '100%',\n        top: `${100 / 3}%`,\n        height: `${100 / 3}%`,\n        width: `${100 / 3}%`,\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        backgroundColor: '#000',\n        color: '#FFF',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n        fontSize: '0.6em',\n        '& div': {\n            marginBottom: 0,\n        }\n    },\n});\n\nfunction Button({ selected, onClick, alt, icon, children, ...props }) {\n    const classes = useStyles(props);\n    const [ctrl, setCtrl] = useState(false);\n    useEffect(() => {\n        const onKeyDown = (e) => { if (e.key === 'Control') setCtrl(true); };\n        const onKeyUp = (e) => { if (e.key === 'Control') setCtrl(false); };\n        window.addEventListener('keydown', onKeyDown);\n        window.addEventListener('keyup', onKeyUp);\n        return () => {\n            window.removeEventListener('keydown', onKeyDown);\n            window.removeEventListener('keyup', onKeyUp);\n        };\n    }, []);\n    return (\n        <div\n            className={classNames(classes.root, { [classes.selected]: selected })}\n            onClick={onClick}>\n            {icon && <img src={icon} alt=\"\" className={classes.icon}/>}\n            {children}\n            {ctrl && alt && <div className={classes.alt}>\n                <div>{alt}</div>\n            </div>}\n        </div>\n    );\n}\n\nexport default Button;\n","import { useEffect, useMemo } from \"react\";\n\nconst emptyScore = [{\n    type: 'System',\n    cmd: 'BPM',\n    beat: 0,\n    bpm: 120,\n}];\n\nconst load = () => {\n    const item = localStorage.getItem('score');\n    if (item === null) return emptyScore;\n    else return JSON.parse(item);\n};\n\nconst save = (data) => {\n    localStorage.setItem('score', JSON.stringify(data));\n};\n\nconst createSubmit = () => {\n    let timers = null, notes = null;\n    const convert = (timers, notes) => {\n        const score = [];\n        timers.forEach((beat, { bpm }) => {\n            score.push({\n                type: 'System',\n                cmd: 'BPM',\n                beat,\n                bpm,\n            });\n        });\n        notes.forEach((beat, { lane, ...note }) => {\n            score.push({\n                type: 'Note',\n                beat,\n                ...note,\n                lane: lane + 1, // bestdori uses lanes starting from 1\n            });\n        });\n        score.sort(({ beat: b1 }, { beat: b2 }) => b1 - b2);\n        return score;\n    };\n    const submit = (newTimers, newNotes) => {\n        timers = newTimers;\n        notes = newNotes;\n        setTimeout(() => {\n            // check if we're the newest version, if not, return,\n            // since another newer version is on the way.\n            if (timers !== newTimers || notes !== newNotes) return; \n            save(convert(newTimers, newNotes));\n            console.log('Score saved!');\n        }, 5000); // saver after 5 seconds of inactivity\n    };\n    const saveImmediately = () => {\n        save(convert(timers, notes));\n    };\n    return { submit, save: saveImmediately };\n}\n\nconst useAutoSave = ({ timers, notes }) => {\n    const { submit, save } = useMemo(createSubmit, []); // does not change\n    useEffect(() => {\n        window.addEventListener('beforeunload', save);\n        return () => window.removeEventListener('beforeunload', save);\n    }, [save]);\n    useEffect(() => {\n        submit(timers, notes);\n    }, [notes, submit, timers]);\n};\n\nexport { emptyScore, load, save, useAutoSave };\n","import React, { useState, useCallback, useMemo, createContext, useContext } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport { CSSTransition } from 'react-transition-group';\nimport { useForm } from 'react-hook-form';\nimport cancel from '../assets/cancel.svg';\nimport submit from '../assets/submit.svg';\n\nconst useDialog = () => {\n    const [opened, setOpened] = useState(false);\n    const [resolve, setResolve] = useState(null);\n    const [reject, setReject] = useState(null);\n    const open = useCallback(() => {\n        setOpened(true);\n        return new Promise((resolve, reject) => {\n            setResolve(() => resolve);\n            setReject(() => reject);\n        }).finally(() => {\n            setOpened(false);\n            setResolve(null);\n            setReject(null);\n        });\n    }, []);\n    const res = useMemo(() => ({\n        opened, resolve, reject, open,\n    }), [open, opened, reject, resolve]);\n    return res;\n};\n\nconst useStyles = makeStyles({\n    overlay: {\n        position: 'fixed',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.5)',\n        zIndex: 5,\n    },\n    sheetContainer: {\n        position: 'fixed',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 6,\n        pointerEvents: 'none',\n    },\n    sheet: {\n        backgroundColor: '#FFF',\n        padding: '1em',\n        pointerEvents: 'auto',\n    },\n    horizontal: {\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n        marginTop: -10,\n        marginBottom: -10,\n    },\n    cell: {\n        marginTop: 10,\n        marginBottom: 10,\n        display: 'block',\n    },\n    title: {\n        fontWeight: 'bold',\n        fontSize: `${40 / 60}em`,\n        lineHeight: `${50 / 40}em`,\n        width: `${480 / 40}em`,\n    },\n    input: {\n        outline: 'none',\n        border: 'none',\n        backgroundColor: '#000',\n        color: '#FFF',\n        fontSize: `${34 / 60}em`,\n        lineHeight: `${50 / 34}em`,\n        height: `${50 / 34}em`,\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n        paddingLeft: `${10 / 34}em`,\n        width: `${320 / 34}em`,\n    },\n    text: {\n        fontSize: `${32 / 60}em`,\n        lineHeight: `${50 / 32}em`,\n        height: `${50 / 32}em`,\n        fontWeight: 'normal',\n        paddingRight: `${60 / 32}em`,\n    },\n    button: {\n        width: `${120 / 60}em`,\n        height: `${50 / 60}em`,\n        backgroundColor: 'rgba(0, 0, 0, 0.06)',\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        cursor: 'pointer',\n        position: 'relative',\n        '&:hover::after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            left: 0,\n            top: 0,\n            right: 0,\n            bottom: 0,\n            backgroundColor: 'rgba(0, 0, 0, 0.14)',\n        },\n        border: 'none',\n        outline: 'none',\n        fontSize: 'inherit',\n    },\n    icon: {\n        height: '100%',\n    },\n});\n\nconst DialogContext = createContext(null);\n\nfunction Dialog({ dialog, children }) {\n    const classes = useStyles();\n    const onClick = useCallback(() => {\n        if (dialog.reject) dialog.reject();\n    }, [dialog]);\n    const form = useForm();\n    const context = useMemo(() => ({ ...dialog, form }), [dialog, form]);\n    \n    return (\n        <form onSubmit={form.handleSubmit(dialog.resolve)}>\n            <DialogContext.Provider value={context}>\n                <CSSTransition\n                    in={dialog.opened}\n                    timeout={120}\n                    classNames=\"fade\"\n                    mountOnEnter\n                    unmountOnExit>\n                    <div className={classes.overlay} onClick={onClick}/>\n                </CSSTransition>\n                {children}\n            </DialogContext.Provider>\n        </form>\n    );\n}\n\nfunction Sheet({ children }) {\n    const classes = useStyles();\n    const { opened } = useContext(DialogContext);\n    return (\n        <CSSTransition\n            in={opened}\n            timeout={120}\n            classNames=\"scale\"\n            mountOnEnter\n            unmountOnExit>\n            <div className={classes.sheetContainer}>\n                <div className={classes.sheet}>\n                    {children}\n                </div>\n            </div>\n        </CSSTransition>\n    );\n}\n\nfunction Horizontal({ children }) {\n    const classes = useStyles();\n    return (\n        <div className={classes.horizontal}>\n            {children}\n        </div>\n    );\n}\n\nfunction Cell({ el: Element = 'div', children, classes, innerRef, ...rest }) {\n    const classes2 = useStyles({ classes });\n    return (\n        <Element className={classes2.cell} ref={innerRef} {...rest}>\n            {children}\n        </Element>\n    );\n}\n\nfunction Title({ children }) {\n    const classes = useStyles();\n    return (\n        <Cell classes={{ cell: classes.title }}>\n            {children}\n        </Cell>\n    );\n}\n\nfunction Input({ classes: inheritClasses, ...props }) {\n    const classes = useStyles({ classes: inheritClasses });\n    const { form: { register } } = useContext(DialogContext);\n    return (\n        <Cell\n            el=\"input\"\n            classes={{ cell: classes.input }}\n            innerRef={register}\n            {...props}/>\n    );\n}\n\nfunction Text({ children }) {\n    const classes = useStyles();\n    return (\n        <Cell classes={{ cell: classes.text }}>\n            {children}\n        </Cell>\n    );\n}\n\nfunction Cancel(props) {\n    const classes = useStyles();\n    const { reject } = useContext(DialogContext);\n    return (\n        <Cell classes={{ cell: classes.button }} onClick={reject} {...props}>\n            <img className={classes.icon} alt=\"Cancel\" src={cancel}/>\n        </Cell>\n    );\n}\n\nfunction Submit(props) {\n    const classes = useStyles();\n    return (\n        <Cell el=\"button\" type=\"submit\" classes={{ cell: classes.button }} {...props}>\n            <img className={classes.icon} alt=\"Submit\" src={submit}/>\n        </Cell>\n    );\n}\n\nexport { useDialog, Dialog, Sheet, Horizontal, Cell, Title, Input, Text, Cancel, Submit };\n","import React, { useCallback } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport Toolbar from './Toolbar';\nimport Button from './Button';\nimport { emptyScore } from '../chart/storage';\nimport { Dialog, useDialog, Sheet, Horizontal, Input, Title, Text, Cancel, Submit } from './Dialog';\n\nimport settings from '../assets/settings.svg';\nimport hamburger from '../assets/hamburger.svg';\nimport deleteIcon from '../assets/delete.svg';\nimport album from '../assets/album.svg';\nimport exportIcon from '../assets/export.svg';\nimport importIcon from '../assets/import.svg';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        fontSize: 40,\n    },\n    bpm: {\n        fontSize: '0.8em',\n        lineHeight: 1,\n        color: '#000',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n    },\n    url: {\n        width: `${560 / 34}em`,\n        marginRight: `${80 / 34}em`,\n    },\n});\n\nfunction Menus({ setScore, musicURL, setMusicURL }) {\n    const classes = useStyles();\n    const deleteDialog = useDialog();\n    const openDeleteDialog = useCallback(async () => {\n        try {\n            await deleteDialog.open();\n            // score state in App.js saves the initial score, which\n            // resets the chart every time its *reference* changes.\n            // here, we set score to a copy of the emptyScore object,\n            // otherwise the second reset will not be effective\n            setScore([...emptyScore]);\n        } catch (e) {\n            // do nothing\n        }\n    }, [deleteDialog, setScore]);\n    const musicURLDialog = useDialog();\n    const openMusicURLDialog = useCallback(async () => {\n        try {\n            const { url } = await musicURLDialog.open();\n            setMusicURL(url);\n        } catch (e) {\n            // do nothing\n        }\n    }, [musicURLDialog, setMusicURL]);\n    return (\n        <div className={classes.root}>\n            <Toolbar>\n                <Button icon={hamburger}/>\n                <Button icon={deleteIcon} onClick={openDeleteDialog}/>\n                <Dialog dialog={deleteDialog}>\n                    <Sheet>\n                        <Horizontal>\n                            <div>\n                                <Title></Title>\n                                <Text></Text>\n                            </div>\n                            <div>\n                                <Cancel/>\n                                <Submit/>\n                            </div>\n                        </Horizontal>\n                    </Sheet>\n                </Dialog>\n                <Button icon={album} onClick={openMusicURLDialog}/>\n                <Dialog dialog={musicURLDialog}>\n                    <Sheet>\n                        <Horizontal>\n                            <div>\n                                <Title></Title>\n                                <Input name=\"url\" defaultValue={musicURL} classes={{ input: classes.url }}/>\n                            </div>\n                            <div>\n                                <Cancel/>\n                                <Submit/>\n                            </div>\n                        </Horizontal>\n                    </Sheet>\n                </Dialog>\n                <Button icon={exportIcon}/>\n                <Button icon={importIcon}/>\n                <Button icon={settings}/>\n            </Toolbar>\n        </div>\n    );\n}\n\nexport default Menus;\n","import { useEffect } from \"react\";\n\nconst useEvent = (el, name, fn) => {\n    useEffect(() => {\n        if (!el) return;\n        let valid = true;\n        const wrappedFn = (e) => {\n            if (!valid) return;\n            if (fn) fn(e);\n        }\n        el.addEventListener(name, wrappedFn);\n        return () => el.removeEventListener(name, wrappedFn);\n    }, [el, fn, name]);\n}\n\nexport default useEvent;\n","import React, { useCallback, Children } from 'react';\nimport Button from './Button';\nimport { makeStyles } from '@material-ui/styles';\nimport Toolbar from './Toolbar';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n    },\n    container: {\n        position: 'absolute',\n        left: '100%',\n        top: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.06)',\n    },\n});\n\nfunction Control({ code, setCode, matchCode, children, index, ...rest }) {\n    const classes = useStyles();\n    const onClick = useCallback(() => setCode(matchCode), [matchCode, setCode]);\n    const selected = code === matchCode;\n    const childrenCount = Children.count(children);\n    const margin = Math.min(childrenCount - 1, index);\n    return (\n        <div className={classes.root}>\n            <Button onClick={onClick} selected={selected} {...rest}/>\n            {selected && <div className={classes.container} style={{ top: `${-2 * margin}em` }}>\n                <Toolbar>\n                    {children}\n                </Toolbar>\n            </div>}\n        </div>\n    );\n}\n\nexport default Control;\n","import React, { useCallback } from 'react';\nimport Button from './Button';\n\nfunction Carousel({ state, setState, states, icons, ...rest }) {\n    const ind = states.indexOf(state);\n    const onClick = useCallback(() => {\n        const next = states[(ind + 1) % states.length];\n        setState(next);\n    }, [ind, setState, states]);\n    return (\n        <Button onClick={onClick} selected={false} icon={icons[ind]} {...rest}/>\n    );\n}\n\nexport default Carousel;\n","import React, { useCallback } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport classNames from 'classnames';\nimport Button from './Button';\n\nconst useStyles = makeStyles({\n    nonactive: {\n        opacity: 0.35,\n    },\n});\n\nfunction Switch({ state, setState, icon }) {\n    const classes = useStyles();\n    const onClick = useCallback(() => setState(state => !state), [setState]);\n    return (\n        <Button\n            onClick={onClick}\n            selected={false}\n            icon={icon}\n            classes={{ icon: classNames({ [classes.nonactive]: !state }) }}/>\n    );\n}\n\nexport default Switch;\n","import React, { useCallback, useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport Control from './Control';\nimport Toolbar from './Toolbar';\nimport Carousel from './Carousel';\nimport Switch from './Switch';\nimport Button from './Button';\nimport { Dialog, useDialog, Sheet, Horizontal, Title, Input, Cancel, Submit } from './Dialog';\n\nimport select from '../assets/select.svg';\nimport single from '../assets/single.svg';\nimport slide1 from '../assets/slide-1.svg';\nimport slide2 from '../assets/slide-2.svg';\nimport flick from '../assets/flick.svg';\nimport timer from '../assets/timer.svg';\nimport player from '../assets/player.svg';\nimport pause from '../assets/pause.svg';\nimport play from '../assets/play.svg';\nimport x05 from '../assets/x05.svg';\nimport x10 from '../assets/x10.svg';\nimport x15 from '../assets/x15.svg';\nimport x20 from '../assets/x20.svg';\nimport followIcon from '../assets/follow.svg';\nimport bars from '../assets/bars.svg';\nimport d1 from '../assets/d1.svg';\nimport d2 from '../assets/d2.svg';\nimport d3 from '../assets/d3.svg';\nimport d4 from '../assets/d4.svg';\nimport d6 from '../assets/d6.svg';\nimport d8 from '../assets/d8.svg';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        fontSize: 40,\n    },\n    bpm: {\n        fontSize: '0.8em',\n        lineHeight: 1,\n        color: '#000',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n    },\n});\n\nfunction Controls({\n    music, follow, setFollow, setDivision, code, setCode, currentBPM, setCurrentBPM,\n}) {\n    const classes = useStyles();\n    const [paused, setPausedRaw] = useState(music.paused);\n    const setPaused = useCallback((paused) => {\n        if (paused) music.pause();\n        else music.play();\n    }, [music]);\n    useEffect(() => {\n        const updatePaused = () => setPausedRaw(music.paused);\n        music.addEventListener('play', updatePaused);\n        music.addEventListener('pause', updatePaused);\n        return () => {\n            music.removeEventListener('play', updatePaused);\n            music.removeEventListener('pause', updatePaused);\n        };\n    }, [music]);\n    const [playbackRate, setPlaybackRateRaw] = useState(music.playbackRate);\n    const setPlaybackRate = useCallback((playbackRate) => {\n        music.playbackRate = playbackRate;\n    }, [music]);\n    useEffect(() => {\n        const updatePlaybackRate = () => setPlaybackRateRaw(music.playbackRate);\n        music.addEventListener('ratechange', updatePlaybackRate);\n        return () => music.removeEventListener('ratechange', updatePlaybackRate);\n    });\n    const setD1 = useCallback(() => setDivision(1), [setDivision]);\n    const setD2 = useCallback(() => setDivision(2), [setDivision]);\n    const setD3 = useCallback(() => setDivision(3), [setDivision]);\n    const setD4 = useCallback(() => setDivision(4), [setDivision]);\n    const setD6 = useCallback(() => setDivision(6), [setDivision]);\n    const setD8 = useCallback(() => setDivision(8), [setDivision]);\n    const bpmDialog = useDialog();\n    const openBPMDialog = useCallback(async () => {\n        try {\n            const { bpm } = await bpmDialog.open();\n            setCurrentBPM(bpm);\n        } catch (e) {\n            // do nothing\n        }\n    }, [bpmDialog, setCurrentBPM]);\n    return (\n        <div className={classes.root}>\n            <Toolbar>\n                <Control code={code} setCode={setCode} alt=\"E\" index={0} matchCode=\"select\" icon={select}/>\n                <Control code={code} setCode={setCode} alt=\"F\" index={2} matchCode=\"placement/single\" icon={single}/>\n                <Control code={code} setCode={setCode} alt=\"S\" index={3} matchCode=\"placement/slide-a\" icon={slide1}/>\n                <Control code={code} setCode={setCode} alt=\"D\" index={4} matchCode=\"placement/slide-b\" icon={slide2}/>\n                <Control code={code} setCode={setCode} alt=\"W\" index={5} matchCode=\"modification/flick\" icon={flick}/>\n                <Control code={code} setCode={setCode} alt=\"A\" index={6} matchCode=\"timer\" icon={timer}>\n                    <Button onClick={openBPMDialog}>\n                        <div className={classes.bpm}>{currentBPM}</div>\n                    </Button>\n                </Control>\n                <Dialog dialog={bpmDialog}>\n                    <Sheet>\n                        <Horizontal>\n                            <div>\n                                <Title></Title>\n                                <Input name=\"bpm\" defaultValue={currentBPM}/>\n                            </div>\n                            <div>\n                                <Cancel/>\n                                <Submit/>\n                            </div>\n                        </Horizontal>\n                    </Sheet>\n                </Dialog>\n                <Control code={code} setCode={setCode} index={7} matchCode=\"bars\" icon={bars}>\n                    <Button alt=\"1\" onClick={setD1} icon={d1}/>\n                    <Button alt=\"2\" onClick={setD2} icon={d2}/>\n                    <Button alt=\"3\" onClick={setD3} icon={d3}/>\n                    <Button alt=\"4\" onClick={setD4} icon={d4}/>\n                    <Button alt=\"6\" onClick={setD6} icon={d6}/>\n                    <Button alt=\"8\" onClick={setD8} icon={d8}/>\n                </Control>\n                <Control code={code} setCode={setCode} alt=\"R\" index={8} matchCode=\"player\" icon={player}>\n                    <Carousel\n                        state={paused}\n                        setState={setPaused}\n                        states={[false, true]}\n                        icons={[pause, play]}/>\n                    <Carousel\n                        state={playbackRate}\n                        setState={setPlaybackRate}\n                        states={[0.5, 1.0, 1.5, 2.0]}\n                        icons={[x05, x10, x15, x20]}/>\n                    <Switch\n                        state={follow}\n                        setState={setFollow}\n                        icon={followIcon}/>\n                </Control>\n            </Toolbar>\n        </div>\n    );\n}\n\nexport default Controls;\n","import { useState } from \"react\"\n\nconst useTool = () => {\n    const [code, setCode] = useState('select');\n    return { code, setCode };\n};\n\nexport default useTool;\n","import { useState, useCallback, useRef, useEffect } from 'react';\nimport useEvent from '../tools/useEvent';\n\nconst useScore = ({ music: { duration }, time2Timers, scaleRef }) => {\n    const [containerEl, setContainerEl] = useState(null);\n    const scrollRef = useRef(0);\n    const [rect, setRect] = useState({ x: 0, width: 100 });\n    useEffect(() => {\n        if (!containerEl) return;\n        setRect(containerEl.getBoundingClientRect());\n    }, [containerEl]);\n\n    const inflate = useCallback((e) => {\n        const { x, width } = rect;\n        const y = -scrollRef.current;\n        const height = scaleRef.current * duration;\n        const top = e.clientY - y;\n        const left = e.clientX - x;\n        const time = Math.max((1 - top / height) * duration, 0);\n        const { key: startTime, value: { beat: startBeat, bpm } } = time2Timers.le(time);\n        const beat = startBeat + (time - startTime) / 60 * bpm;\n        const lane = left / width * 11 - 2.5;\n        const ratioTop = top / height;\n        return { top, left, time, beat, lane, ratioTop };\n    }, [duration, rect, scaleRef, time2Timers]);\n\n    const keepInView = useCallback((position) => {\n        const height = scaleRef.current * duration;\n        let viewTop = position - window.innerHeight;\n        if (viewTop < 0) viewTop = 0;\n        else if (position > height) viewTop = height - window.innerHeight;\n        scrollRef.current = viewTop;\n    }, [duration, scaleRef]);\n\n    const deflate = useCallback(({ time, lane }) => {\n        const { x, width } = rect;\n        const y = -scrollRef.current;\n        const height = scaleRef.current * duration;\n        return {\n            x: x + (lane + 2.5) / 11 * width,\n            y: y + height * (1 - time / duration),\n        };\n    }, [duration, rect, scaleRef]);\n\n    const mouseRef = useRef({ clientX: 0, clientY: 0 });\n    const updateMouse = useCallback((e) => {\n        mouseRef.current = e;\n    }, []);\n    useEvent(containerEl, 'mousemove', updateMouse);\n    \n    const params = {\n        containerEl, setContainerEl,\n        inflate, keepInView, deflate, scrollRef, rect, mouseRef,\n    };\n\n    return params;\n};\n\nexport default useScore;\n","import { useState, useEffect } from \"react\"\n\nconst useResettableState = (initial) => {\n    const [value, setValue] = useState(initial);\n    useEffect(() => {\n        setValue(initial);\n    }, [initial]);\n    return [value, setValue];\n}\n\nexport default useResettableState;\n","import { useMemo, useState, useCallback, useRef } from 'react';\nimport createTree from 'functional-red-black-tree';\nimport { useAutoSave } from './storage';\nimport useResettableState from './useResettableState';\n\nconst initial = {\n    // initial values\n    follow: false,\n    division: 2,\n    scale: 600,\n    bpm: 120,\n\n    // other settings\n    progressOffset: 180,\n    scrollSpeed: 0.03,\n    thumbScrollSpeed: 0.027,\n    scaleSpeed: 0.0005,\n    minScale: 50,\n    maxScale: 2000,\n};\n\nfunction useChart({ music, score }) {\n    const initialTimers = useMemo(() => {\n        let res = createTree();\n        for (const { type, cmd, beat, bpm } of score) {\n            if (type !== 'System' || cmd !== 'BPM') continue;\n            res = res.insert(beat, { bpm });\n        }\n        return res;\n    }, [score]);\n    const initialNotes = useMemo(() => {\n        let res = createTree();\n        for (const { type, beat, lane, ...rest } of score) {\n            if (type !== 'Note') continue;\n            res = res.insert(beat, { ...rest, lane: lane - 1 });\n        }\n        return res;\n    }, [score]);\n    const [timers, setTimers] = useResettableState(initialTimers);\n    const [notes, setNotes] = useResettableState(initialNotes);\n    useAutoSave({ timers, notes });\n    \n    const ranges = useMemo(() => {\n        const res = [];\n        let lastTime = 0;\n        for (let it1 = timers.begin, it2 = timers.at(1); it1.hasNext; it1.next(), it2.next()) {\n            const { key: beat1, value: { bpm } } = it1, { key: beat2 } = it2;\n            const time1 = lastTime, time2 = lastTime + (beat2 - beat1) / bpm * 60;\n            res.push({ time1, time2, beat1, beat2, bpm });\n            lastTime = time2;\n        }\n        const { key: beat1, value: { bpm } } = timers.end;\n        res.push({\n            time1: lastTime, time2: music.duration,\n            beat1, beat2: (music.duration - lastTime) / 60 * bpm + beat1, bpm\n        });\n        return res;\n    }, [timers, music]);\n    const time2Timers = useMemo(() => {\n        let res = createTree();\n        for (const { time1: time, beat1: beat, bpm } of ranges) {\n            res = res.insert(time, { beat, bpm });\n        }\n        res = res.insert(ranges[ranges.length - 1].time2, { beat: ranges[ranges.length - 1].beat2 });\n        return res;\n    }, [ranges]);\n    const time2Notes = useMemo(() => {\n        let res = createTree();\n        for (const { beat1, beat2, time1, bpm } of ranges) {\n            // eslint-disable-next-line no-loop-func\n            notes.forEach((beat, note) => {\n                const time = (beat - beat1) / bpm * 60 + time1;\n                res = res.insert(time, { ...note, beat });\n            }, beat1, beat2);\n        }\n        return res;\n    }, [ranges, notes]);\n\n    const [division, setDivision] = useState(initial.division);\n    const [follow, setFollow] = useState(initial.follow);\n    const scaleRef = useRef(initial.scale);\n\n    const quantize = useCallback((time) => {\n        const { key: rangeStartTime, value: { bpm, beat: rangeStartBeat } } = time2Timers.le(time);\n        const { value: { beat: rangeEndBeat } } = time2Timers.gt(time);\n        let quantizedBeat = rangeStartBeat + Math.round(\n            (time - rangeStartTime) / 60 * bpm * division\n        ) / division;\n        // if quantized result exceeds the previous range, it falls on the beginning\n        // of the next range instead\n        if (quantizedBeat > rangeEndBeat) quantizedBeat = rangeEndBeat;\n        const quantizedTime = rangeStartTime + (quantizedBeat - rangeStartBeat) / bpm * 60;\n        const delta = Math.abs(quantizedTime - time) / 60 * bpm * division;\n        return { beat: quantizedBeat, time: quantizedTime, bpm, delta };\n    }, [division, time2Timers]);\n    const countNotes = useCallback((time) => {\n        const { valid, index } = time2Notes.le(time);\n        // an invalid iterator with index = size - 1 is returned if the\n        // key is smaller than the smallest key. index + 1 since we want to\n        // disolay the number of notes *including* this one.\n        return valid ? index + 1 : 0;\n    }, [time2Notes]);\n    const findNotePure = useCallback((notes, beat, lane) => {\n        for (const it = notes.ge(beat); it.valid && it.key === beat; it.next()) {\n            if (it.value.lane !== lane) continue;\n            return it;\n        }\n        return null;\n    }, []);\n    const findNote = useCallback((beat, lane) => findNotePure(notes, beat, lane), [findNotePure, notes]);\n    const forEachNote = useCallback((visit, filter) => {\n        time2Notes.forEach((time, note) => {\n            if (filter) {\n                for (const key in filter) {\n                    if (filter[key] !== note[key]) return;\n                }\n                visit(time, note);\n            }\n        });\n    }, [time2Notes]);\n    const forEachGroup = useCallback((visit) => {\n        for (let it = time2Notes.begin; it.valid;) {\n            const { key: time } = it;\n            const notes = [];\n            do {\n                notes.push(it.value);\n                it.next();\n            } while (it.key <= time && it.valid);\n            visit(time, notes);\n        }\n    }, [time2Notes]);\n    const scaleX = 8;\n    const matchNotePure = useCallback((notes, time2Timers, time, lane, threshold) => {\n        const { key: startTime, value: { beat: startBeat, bpm } } = time2Timers.le(time);\n        const beat = startBeat + (time - startTime) / 60 * bpm; \n        let minDist = threshold * threshold, minBeat, minLane = NaN;\n        notes.forEach((noteBeat, { lane: noteLane }) => {\n            const dist = Math.pow((noteLane - lane) / scaleX, 2) + Math.pow(noteBeat - beat, 2);\n            if (dist < minDist) {\n                minDist = dist;\n                minBeat = noteBeat;\n                minLane = noteLane;\n            }\n        }, beat - threshold, beat + threshold);\n        if (isNaN(minLane)) return null;\n        else return {\n            beat: minBeat,\n            lane: minLane,\n            time: startTime + (minBeat - startBeat) / bpm * 60,\n        };\n    }, []);\n    const matchNote = useCallback((time, lane, threshold) =>\n        matchNotePure(notes, time2Timers, time, lane, threshold),\n        [matchNotePure, notes, time2Timers]);\n\n    const [currentBPM, setCurrentBPM] = useState(initial.bpm);\n\n    const snakes = useMemo(() => {\n        const res = [];\n        ['A', 'B'].forEach((pos) => {\n            let lastY = 0, lastLane = -1;\n            forEachNote((time, { lane, end }) => {\n                if (lastLane !== -1) {\n                    const y1 = time;\n                    res.push({\n                        x0: lastLane, x1: lane,\n                        y0: lastY, y1,\n                    });\n                }\n                lastLane = end ? -1 : lane;\n                lastY = time;\n            }, { pos, note: 'Slide' });\n        });\n        return res;\n    }, [forEachNote]);\n\n    const tapLines = useMemo(() => {\n        const res = [];\n        forEachGroup((time, notes) => {\n            let minLane = 8, maxLane = -1;\n            for (const { lane, note: type, start, end } of notes) {\n                // Synchronus tap line appears two notes possess the same beat,\n                // but middle slide notes are not counted\n                if (type !== 'Slide' || start || end) {\n                    minLane = Math.min(minLane, lane);\n                    maxLane = Math.max(maxLane, lane);\n                }\n            }\n            if (minLane < maxLane - 1) { // at least two notes, distance >= 2, display sync tap line\n                res.push({\n                    time, minLane, maxLane,\n                });\n            }\n        });\n        return res;\n    }, [forEachGroup]);\n\n    const bars = useMemo(() => {\n        const bars = [];\n        for (const { beat1, beat2, bpm, time1 } of ranges) {\n            for (let beat = beat1; beat < beat2; beat += 1 / division) {\n                const deltaBeat = beat - beat1;\n                const time = time1 + deltaBeat / bpm * 60;\n                // use epsilon to avoid round off errors\n                const major = Math.abs(Math.round(deltaBeat) - deltaBeat) < 1e-5;\n                bars.push({\n                    time, major,\n                });\n            }\n        }\n        return bars;\n    }, [ranges, division]);\n\n    const params = {\n        music, timers, setTimers, notes, setNotes,\n        ranges, time2Timers, time2Notes,\n        ...initial, division, setDivision, follow, setFollow, scaleRef, currentBPM, setCurrentBPM,\n        quantize, countNotes, findNotePure, findNote, forEachNote, forEachGroup, matchNotePure, matchNote,\n        tapLines, bars, snakes,\n    };\n\n    return params;\n};\n\nexport default useChart;\n","import { useEffect } from \"react\";\n\nconst useFrame = (fn) => {\n    useEffect(() => {\n        let valid = true;\n        const onFrameWrapped = () => {\n            if (fn) fn();\n            if (valid) requestAnimationFrame(onFrameWrapped);\n        };\n        requestAnimationFrame(onFrameWrapped);\n        return () => { valid = false; };\n    }, [fn]);\n}\n\nexport default useFrame;\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport useFrame from '../tools/useFrame';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        width: '11em',\n        fontSize: `${470 / 11}px`,\n        height: '100%',\n        backgroundColor: '#000000',\n        overflow: 'hidden',\n        willChange: 'scroll-position',\n    },\n    canvas: {\n        position: 'fixed',\n        left: '25vw',\n        top: 0,\n    },\n});\n\nfunction updateView(\n    { code, music: { duration, currentTime, paused }, scaleRef: { current: scale }, progressOffset, keepInView, follow },\n) {\n    if (code !== 'player') return;\n    const progress = (duration - currentTime) * scale;\n    if (follow && !paused) keepInView(progress + progressOffset);\n}\n\nfunction renderBars(\n    { scrollRef: { current: scroll }, music: { duration }, scaleRef: { current: scale }, bars, rect: { width } },\n    { ctx, startTime, endTime },\n) {\n    for (const { time, major } of bars) {\n        const laneWidth = width / 11;\n        const deltaTime = laneWidth / scale / 2;\n        if (time < startTime - deltaTime || time > endTime + deltaTime) continue;\n        const cy = (duration - time) * scale - scroll;\n\n        ctx.lineWidth = 1;\n        ctx.strokeStyle = major ? 'rgba(255, 255, 255, 0.5)' : 'rgba(255, 255, 255, 0.3)';\n        ctx.beginPath();\n        ctx.setLineDash(major ? [] : [2, 2]);\n        ctx.moveTo(laneWidth * 2, cy);\n        ctx.lineTo(laneWidth * 9, cy);\n        ctx.stroke();\n        ctx.setLineDash([]);\n    }\n}\n\nfunction renderNotes(\n    { rect: { width }, scrollRef: { current: scroll }, music: { duration }, scaleRef: { current: scale }, code, time2Notes },\n    { ctx, startTime, endTime },\n) {\n    time2Notes.forEach((time, { lane, note: type, flick, start, end, thumb, selected }) => {\n        const laneWidth = width / 11;\n        const deltaTime = laneWidth / scale / 2;\n        if (time < startTime - deltaTime || time > endTime + deltaTime) return;\n        const cx = (lane + 2.5) * laneWidth; // center x\n        const cy = (duration - time) * scale - scroll;\n\n        const single = type === 'Single';\n        const slide = type === 'Slide';\n        const full = start || end;\n        const focusable = !thumb\n            && (code.startsWith('placement/')\n            || code.startsWith('modification/')\n            || code === 'select');\n        const middle = slide && !full;\n        const selecting = code === 'select';\n\n        if (single && !flick) {\n            ctx.fillStyle = '#FFF';\n            ctx.beginPath();\n            ctx.arc(cx, cy, laneWidth / 2, 0, Math.PI * 2);\n            ctx.fill();\n        }\n\n        if (slide && full && !flick) {\n            ctx.fillStyle = '#7ADEAE';\n            ctx.beginPath();\n            ctx.arc(cx, cy, laneWidth / 2, 0, Math.PI * 2);\n            ctx.fill();\n        }\n\n        if (flick) {\n            ctx.fillStyle = '#FFA0E8';\n            ctx.beginPath();\n            ctx.arc(cx, cy, laneWidth / 2, 0, Math.PI * 2);\n            ctx.fill();\n        }\n\n        if (middle && (!selecting || !selected)) {\n            ctx.lineWidth = 3;\n            ctx.strokeStyle = '#7ADEAE';\n            ctx.beginPath();\n            ctx.moveTo(cx - laneWidth / 2, cy);\n            ctx.lineTo(cx + laneWidth / 2, cy);\n            ctx.stroke();\n        }\n\n        if (middle && selected && selecting) {\n            ctx.lineWidth = 3;\n            ctx.strokeStyle = '#5996FF';\n            ctx.beginPath();\n            ctx.moveTo(cx - laneWidth / 2, cy);\n            ctx.lineTo(cx + laneWidth / 2, cy);\n            ctx.stroke();\n        }\n\n        if (selected && selecting && !middle) {\n            const size = laneWidth / 60 * 7;\n            ctx.lineWidth = 3;\n            ctx.strokeStyle = '#5996FF';\n            ctx.beginPath();\n            ctx.moveTo(cx - size, cy - size);\n            ctx.lineTo(cx + size, cy + size);\n            ctx.moveTo(cx + size, cy - size);\n            ctx.lineTo(cx - size, cy + size);\n            ctx.stroke();\n        }\n\n        if (focusable) {\n            // focus\n        }\n    });\n}\n\nfunction renderTapLines(\n    { rect: { width }, scrollRef: { current: scroll }, music: { duration }, scaleRef: { current: scale }, tapLines },\n    { ctx, startTime, endTime },\n) {\n    for (const { time, minLane, maxLane } of tapLines) {\n        const laneWidth = width / 11;\n        const deltaTime = laneWidth / scale / 2;\n        if (time < startTime - deltaTime || time > endTime + deltaTime) continue;\n        const cy = (duration - time) * scale - scroll;\n\n        ctx.lineWidth = 3;\n        ctx.strokeStyle = '#FFF';\n        ctx.beginPath();\n        ctx.moveTo((minLane + 2.5) * laneWidth, cy);\n        ctx.lineTo((maxLane + 2.5) * laneWidth, cy);\n        ctx.stroke();\n    }\n}\n\nfunction renderSnakes(\n    { rect: { width }, scrollRef: { current: scroll }, music: { duration }, scaleRef: { current: scale }, snakes },\n    { ctx, startTime, endTime },\n) {\n    for (const { x0, x1, y0, y1 } of snakes) {\n        const laneWidth = width / 11;\n        if (y1 < startTime || y0 > endTime) continue;\n        const cx0 = (x0 + 2.5) * laneWidth;\n        const cx1 = (x1 + 2.5) * laneWidth;\n        const cy0 = (duration - y0) * scale - scroll;\n        const cy1 = (duration - y1) * scale - scroll;\n\n        ctx.fillStyle = 'rgba(122, 222, 174, 0.4)';\n        ctx.beginPath();\n        ctx.moveTo(cx0 - laneWidth / 2, cy0);\n        ctx.lineTo(cx0 + laneWidth / 2, cy0);\n        ctx.lineTo(cx1 + laneWidth / 2, cy1);\n        ctx.lineTo(cx1 - laneWidth / 2, cy1);\n        ctx.closePath();\n        ctx.fill();\n    }\n}\n\nfunction renderLanes(\n    { rect: { width }, scale, music: { duration } },\n    { ctx },\n) {\n    const laneWidth = width / 11;\n    for (let i = 0; i <= 7; ++i) {\n        const side = i === 0 || i === 7;\n        ctx.lineWidth = side ? 5 : 1;\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';\n        ctx.beginPath();\n        ctx.moveTo(laneWidth * (i + 2), 0);\n        ctx.lineTo(laneWidth * (i + 2), scale * duration);\n        ctx.stroke();\n    }\n}\n\nfunction renderProgress(\n    { music: { duration, currentTime }, scaleRef: { current: scale }, code, scrollRef: { current: scroll }, rect: { width } },\n    { ctx },\n) {\n    if (code !== 'player') return;\n    const progress = (duration - currentTime) * scale - scroll;\n    ctx.lineWidth = 3;\n    ctx.strokeStyle = '#FF4E67';\n    ctx.beginPath();\n    ctx.moveTo(0, progress);\n    ctx.lineTo(width, progress);\n    ctx.stroke();\n}\n\nfunction renderPlacementCaret(\n    { quantize, rect: { width }, music: { duration }, scaleRef: { current: scale }, scrollRef: { current: scroll }, code },\n    { ctx, mouse: { time } },\n) {\n    if (!code.startsWith('placement/') && !code.startsWith('modification/') && code !== 'timer') return;\n    const { time: quantizedTime, beat } = quantize(time);\n    const laneWidth = width / 11;\n    const cy = (duration - quantizedTime) * scale - scroll;\n\n    ctx.lineWidth = 3;\n    ctx.strokeStyle = '#5996FF';\n    ctx.beginPath();\n    ctx.moveTo(laneWidth * 2, cy);\n    ctx.lineTo(laneWidth * 9, cy);\n    ctx.stroke();\n\n    ctx.fillStyle = '#5996FF';\n    ctx.font = `${laneWidth * 0.6}px D-Din`;\n    ctx.textAlign = 'end';\n    ctx.fillText(`${beat.toFixed(2)}'`, laneWidth * 2 - laneWidth * 0.15, cy + laneWidth * 0.3);\n}\n\nfunction renderPlayerCaret(\n    { rect: { width }, scrollRef: { current: scroll }, scaleRef: { current: scale }, music: { duration }, code, countNotes },\n    { ctx, mouse: { time } },\n) {\n    if (code !== 'player') return;\n    const laneWidth = width / 11;\n    const cy = (duration - time) * scale - scroll;\n\n    ctx.lineWidth = 3;\n    ctx.strokeStyle = '#5996FF';\n    ctx.beginPath();\n    ctx.moveTo(laneWidth * 2, cy);\n    ctx.lineTo(laneWidth * 9, cy);\n    ctx.stroke();\n\n    ctx.fillStyle = '#5996FF';\n    ctx.font = `${laneWidth * 0.6}px D-Din`;\n    ctx.textAlign = 'end';\n    ctx.fillText(`${countNotes(time)}`, laneWidth * (2 - 0.15), cy + laneWidth * 0.3);\n}\n\nfunction renderTimers(\n    { time2Timers, scrollRef: { current: scroll }, music: { duration }, scaleRef: { current: scale }, rect: { width } },\n    { ctx, startTime, endTime },\n) {\n    const laneWidth = width / 11;\n    const deltaTime = laneWidth / scale / 2;\n    ctx.fillStyle = '#FFCD18';\n    ctx.textAlign = 'start';\n    ctx.font = `${laneWidth * 0.6}px D-Din`;\n\n    const bottomTime = Math.max(duration - (scroll + window.innerHeight) / scale, 0);\n    const threshold = 1.25;\n    const { key: nextTime, valid } = time2Timers.gt(bottomTime);\n    if (valid && (nextTime - bottomTime) >= laneWidth * threshold / scale) {\n        const { value: { bpm } } = time2Timers.le(bottomTime);\n        ctx.fillText(`${bpm}`, (9 + 0.15) * laneWidth, window.innerHeight - 0.36 * laneWidth);\n        ctx.beginPath();\n        const cx = (9 + 0.55) * laneWidth;\n        const cy = window.innerHeight - 0.14 * laneWidth;\n        // console.log(cx, cy);\n        ctx.moveTo(cx - 5, cy - 3);\n        ctx.lineTo(cx + 5, cy - 3);\n        ctx.lineTo(cx, cy + 2);\n        ctx.closePath();\n        ctx.fill();\n    }\n\n    ctx.strokeStyle = '#FFCD18';\n    ctx.lineWidth = 3;\n    time2Timers.forEach((time, { bpm }) => {\n        if (time < startTime - deltaTime || time > endTime + deltaTime) return;\n        const cy = (duration - time) * scale - scroll;\n        ctx.beginPath();\n        ctx.moveTo(2 * laneWidth, cy);\n        ctx.lineTo(9 * laneWidth, cy);\n        ctx.stroke();\n        ctx.fillText(`${bpm}`, (9 + 0.15) * laneWidth, cy + 0.2 * laneWidth);\n    });\n}\n\nfunction Score(props) {\n    const { scaleRef, setContainerEl, scrollRef, music: { duration }, inflate, mouseRef } = props;\n\n    const classes = useStyles();\n\n    const onContextMenu = useCallback((e) => {\n        e.preventDefault();\n        e.stopPropagation();\n    }, []);\n\n    const [canvas, setCanvas] = useState(null);\n    const ctx = useMemo(() => {\n        if (!canvas) return null;\n        return canvas.getContext('2d');\n    }, [canvas]);\n    useEffect(() => {\n        if (!canvas) return;\n        canvas.width = 470;\n        canvas.height = window.innerHeight;\n    }, [canvas]);\n    \n    const render = () => {\n        if (!ctx || !canvas) return;\n        \n        const { width, height } = canvas;\n        const endTime = duration - scrollRef.current / scaleRef.current;\n        const startTime = Math.max(0, endTime - height / scaleRef.current);\n        ctx.fillStyle = '#000';\n        ctx.fillRect(0, 0, width, height);\n\n        updateView(props);\n\n        const params = {\n            ctx, startTime, endTime, mouse: inflate(mouseRef.current),\n        };\n\n        renderLanes(props, params);\n        renderBars(props, params);\n        renderTimers(props, params);\n        renderTapLines(props, params);\n        renderSnakes(props, params);\n        renderProgress(props, params);\n        renderPlacementCaret(props, params);\n        renderPlayerCaret(props, params);\n        renderNotes(props, params);\n    }\n    useFrame(render);\n\n    return (\n        <div\n            ref={setContainerEl}\n            className={classes.root}\n            onContextMenu={onContextMenu}>\n            <canvas className={classes.canvas} ref={setCanvas}/>\n        </div>\n    );\n};\n\nexport default Score;\n","import React, { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport classNames from 'classnames';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        height: '100%',\n        width: `${7 / 11 * 100}%`,\n        left: `${2 / 11 * 100}%`,\n        opacity: 0.5,\n        '&$thumb': {\n            opacity: 0.3,\n        },\n    },\n    lanes: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        width: '100%',\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n    },\n    sideLane: {\n        width: 0,\n        borderRight: '5px solid #FFF',\n        marginRight: -2,\n        marginLeft: -2,\n    },\n    middleLane: {\n        width: 0,\n        borderRight: '1px solid #FFF',\n    },\n    bar: {\n        position: 'absolute',\n        left: 0,\n        width: '100%',\n        borderBottom: '1px dashed rgba(255, 255, 255, 0.6)',\n    },\n    major: {\n        borderBottom: '1px solid #FFF',\n    },\n    thumb: {},\n});\n\nfunction Bars({ music: { duration }, ranges, division, thumb = false }) {\n    const classes = useStyles();\n    const bars = useMemo(() => {\n        const bars = [];\n        for (const { beat1, beat2, bpm, time1 } of ranges) {\n            for (let beat = beat1; beat < beat2; beat += 1 / division) {\n                const deltaBeat = beat - beat1;\n                const time = time1 + deltaBeat / bpm * 60;\n                // use epsilon to avoid round off errors\n                const major = Math.abs(Math.round(deltaBeat) - deltaBeat) < 1e-5;\n                bars.push(<div\n                    key={time}\n                    className={classNames(classes.bar, { [classes.major]: major })}\n                    style={{ bottom: `${time / duration * 100}%` }}\n                />);\n            }\n        }\n        return bars;\n    }, [ranges, duration, division, classes]);\n    return (\n        <div className={classNames(classes.root, { [classes.thumb]: thumb })}>\n            <div className={classes.lanes}>\n                <div className={thumb ? classes.middleLane : classes.sideLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={thumb ? classes.middleLane : classes.sideLane}/>\n            </div>\n            {bars}\n        </div>\n    );\n}\n\nexport default Bars;\n","import { makeStyles } from '@material-ui/styles';\nimport classNames from 'classnames';\nimport React, { useMemo } from 'react';\nimport focus from '../assets/focus.svg';\nimport cross from '../assets/cross.svg';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        height: '100%',\n        width: `${7 / 11 * 100}%`,\n        left: `${2 / 11 * 100}%`,\n    },\n    note: {\n        width: '1em',\n        height: '1em',\n        borderRadius: '50%',\n        position: 'absolute',\n        marginBottom: '-0.5em',\n        '&$focusable:hover $focus': {\n            visibility: 'initial',\n        },\n        '&$thumb': {\n            transform: 'scale(0.5)',\n        },\n        boxSizing: 'border-box',\n        '&$selected': {\n            border: '4px solid #5996FF',\n        },\n        '&$middle': {\n            border: 'none',\n        }\n    },\n    focusable: {\n        cursor: 'pointer',\n    },\n    focus: {\n        position: 'absolute',\n        width: '1.4em',\n        height: '1.4em',\n        left: '-0.2em',\n        top: '-0.2em',\n        pointerEvents: 'none',\n        visibility: 'hidden',\n        userSelect: 'none',\n    },\n    single: {\n        backgroundColor: '#FFF',\n    },\n    slide: {\n        backgroundColor: '#7ADEAE',\n    },\n    flick: {\n        backgroundColor: '#FFA0E8',\n        '&:after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            left: '50%',\n            top: '50%',\n            width: 0,\n            height: 0,\n            borderLeft: `${10 / 60}em solid transparent`,\n            borderRight: `${10 / 60}em solid transparent`,\n            borderBottom: `${16.739 / 60}em solid #FFF`,\n            borderTop: 'none',\n            marginLeft: `-${10 / 60}em`,\n            marginTop: `-${16.739 / 60 / 2}em`,\n        },\n        '&$thumb:after': {\n            visibility: 'hidden',\n        },\n    },\n    middle: {\n        '&:after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            left: 0,\n            right: 0,\n            bottom: '50%',\n            borderBottom: '3px solid #7ADEAE',\n            marginBottom: -1.5,\n        },\n        '&$middleSelected:after': {\n            borderBottom: '3px solid #5996FF',\n        },\n        '&$thumb:after': {\n            opacity: 0.6,\n        },\n    },\n    tapLine: {\n        position: 'absolute',\n        marginLeft: '1em',\n        marginRight: 0,\n        height: 0,\n        marginBottom: -1.5,\n        borderBottom: '3px solid #FFF',\n    },\n    snake: {\n        position: 'absolute',\n        left: 0,\n        right: 0,\n        display: 'flex',\n    },\n    thumb: {},\n    selected: {\n        position: 'absolute',\n        height: '100%',\n        left: 0,\n        top: 0,\n        pointerEvents: 'none',\n        userSelect: 'none',\n        zIndex: 2,\n    },\n    middleSelected: {},\n});\n\nfunction Note({ time, duration, lane, note: type, flick, start, end, code, thumb, selected }) {\n    const classes = useStyles();\n\n    const single = type === 'Single';\n    const slide = type === 'Slide';\n    const full = start || end;\n    const focusable = !thumb\n        && (code.startsWith('placement/')\n        || code.startsWith('modification/')\n        || code === 'select');\n    const middle = slide && !full;\n    const selecting = code === 'select';\n\n    return (\n        <div\n            className={classNames(classes.note, {\n                [classes.single]: single && !flick,\n                [classes.slide]: slide && full && !flick,\n                [classes.flick]: flick,\n                [classes.middle]: middle,\n                [classes.focusable]: focusable,\n                [classes.thumb]: thumb,\n                [classes.middleSelected]: middle && selected && selecting,\n            })}\n            style={{\n                bottom: `${time / duration * 100}%`,\n                left: `${lane / 7 * 100}%`,\n            }}>\n            <img\n                className={classes.focus}\n                alt=\"focus\"\n                src={focus}/>\n            {!thumb && selected && !middle && selecting && <img\n                className={classes.selected}\n                alt=\"selected\"\n                src={cross}/>}\n        </div>\n    );\n}\n\nfunction Snake({ x0, x1, y0, y1, thumb }) {\n    const classes = useStyles();\n    return (\n        <div\n            className={classes.snake}\n            style={{\n                bottom: `${y0 * 100}%`,\n                top: `${(1 - y1) * 100}%`,\n            }}>\n            <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 7 1\" preserveAspectRatio=\"none\">\n                <polygon\n                    fill=\"rgba(122, 222, 174, 0.4)\"\n                    strokeWidth=\"0\"\n                    points={`${x0},1 ${x0 + 1},1 ${x1 + 1},0 ${x1},0`}/>\n            </svg>\n        </div>\n    );\n}\n\nfunction Notes({\n    time2Notes, music: { duration }, notes, setNotes,\n    findNote, forEachNote, forEachGroup, code, thumb = false,\n}) {\n    const classes = useStyles();\n\n    const snakes = useMemo(() => {\n        const res = [];\n        if (thumb) return res;\n        ['A', 'B'].forEach((pos) => {\n            let lastY = 0, lastLane = -1;\n            forEachNote((time, { lane, end }) => {\n                if (lastLane !== -1) {\n                    const y1 = time / duration;\n                    res.push(<Snake\n                        key={`snake-${lastY}-${y1}-${pos}`}\n                        x0={lastLane} x1={lane}\n                        y0={lastY} y1={y1}/>);\n                }\n                lastLane = end ? -1 : lane;\n                lastY = time / duration;\n            }, { pos, note: 'Slide' });\n        });\n        return res;\n    }, [duration, forEachNote, thumb]);\n\n    const tapLines = useMemo(() => {\n        const res = [];\n        if (thumb) return res;\n        forEachGroup((time, notes) => {\n            let minLane = 8, maxLane = -1;\n            for (const { lane, note: type, start, end } of notes) {\n                // Synchronus tap line appears two notes possess the same beat,\n                // but middle slide notes are not counted\n                if (type !== 'Slide' || start || end) {\n                    minLane = Math.min(minLane, lane);\n                    maxLane = Math.max(maxLane, lane);\n                }\n            }\n            if (minLane < maxLane - 1) { // at least two notes, distance >= 2, display sync tap line\n                res.push(<div\n                    key={`tap-line-${time}`}\n                    className={classes.tapLine}\n                    style={{\n                        bottom: `${time / duration * 100}%`,\n                        left: `${minLane / 7 * 100}%`,\n                        right: `${(7 - maxLane) / 7 * 100}%`,\n                    }}\n                />)\n            }\n        });\n        return res;\n    }, [classes, duration, forEachGroup, thumb]);\n\n    const noteEls = useMemo(() => {\n        const res = [];\n        time2Notes.forEach((time, note) => {\n            res.push(<Note\n                key={`note-${note.beat}-${note.lane}`}\n                time={time}\n                duration={duration}\n                notes={notes}\n                setNotes={setNotes}\n                findNote={findNote}\n                code={code}\n                thumb={thumb}\n                {...note}/>);\n        });\n        return res;\n    }, [code, duration, findNote, notes, setNotes, time2Notes, thumb]);\n\n    const children = useMemo(() => [...snakes, ...tapLines, ...noteEls], [snakes, tapLines, noteEls]);\n    \n    return (\n        <div className={classes.root}>\n            {children}\n        </div>\n    );\n}\n\nexport default Notes;\n","import { useEffect, useMemo, useCallback } from 'react';\n\nconst interpolateInterval = 15;\n\nconst useDrag = ({ onDragStart, onDrag, onDragEnd, el }) => {\n    const states = useMemo(() => ({\n        left: false, right: false, dragging: false, shift: false,\n        lestX: 0, lastY: 0, startX: 0, startY: 0,\n    }), []);\n\n    const onMouseDown = useCallback((e) => {\n        if (e.button === 0) states.left = true;\n        if (e.button === 2) states.right = true;\n        states.shift = e.shiftKey;\n        states.lastX = e.clientX;\n        states.lastY = e.clientY;\n        states.startX = e.clientX;\n        states.startY = e.clientY;\n        if (!states.dragging) {\n            states.dragging = true;\n            if (onDragStart) {\n                const ret = onDragStart(e, states);\n                // disable event, no prevent default, no stop propagation.\n                if (ret === false) {\n                    states.left = states.right = states.dragging = false;\n                    return;\n                }\n            }\n        }\n        e.preventDefault();\n        e.stopPropagation();\n    }, [onDragStart, states]);\n\n    const onMouseMove = useCallback((e) => {\n        // due to browser mechanics, the mousemove event itself\n        // is throttled, so if the mouse moves too fase, two subsequent mousemove\n        // events will have a very large gap, and some notes that are located\n        // on the path of the mouse would be lost.\n        // the solution is to interpolate manually, if two mousemove events come\n        // with a big gap, the path is split into many segments, and fake events\n        // are added so that the path looks smooth to onDrag.\n        states.shift = e.shiftKey;\n        if (states.dragging) {\n            // here, the end point is always given to onDrag\n            let steps = Math.round(Math.abs(e.clientY - states.lastY) / interpolateInterval);\n            if (steps === 0) steps = 1;\n            for (let i = 1; i <= steps; ++i) {\n                const t = i / steps;\n                const clientX = states.lastX + (e.clientX - states.lastX) * t;\n                const clientY = states.lastY + (e.clientY - states.lastY) * t;\n                if (onDrag) onDrag({ clientX, clientY }, states);\n            }\n            states.lastX = e.clientX;\n            states.lastY = e.clientY;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n    }, [onDrag, states]);\n\n    const onMouseUp = useCallback((e) => {\n        if (states.dragging) {\n            if (onDragEnd) onDragEnd(e, states);\n            states.dragging = false;\n        }\n        // shift = e.shiftKey;\n        if (e.button === 0) states.left = false;\n        if (e.button === 2) states.right = false;\n        e.preventDefault();\n        e.stopPropagation();\n    }, [onDragEnd, states]);\n\n    useEffect(() => {\n        if (!el) return;\n        el.addEventListener('mousedown', onMouseDown);\n        el.addEventListener('mousemove', onMouseMove);\n        el.addEventListener('mouseup', onMouseUp);\n        return () => {\n            el.removeEventListener('mousedown', onMouseDown);\n            el.removeEventListener('mousemove', onMouseMove);\n            el.removeEventListener('mouseup', onMouseUp);\n        };\n    }, [el, onMouseDown, onMouseMove, onMouseUp]);\n};\n\nexport default useDrag;\n","// scroll speed normalizer from https://stackoverflow.com/a/30134826/3871776\n\n// Reasonable defaults\nvar PIXEL_STEP = 10;\nvar LINE_HEIGHT = 40;\nvar PAGE_HEIGHT = 800;\n\nfunction normalizeWheel(/*object*/ event) /*object*/ {\n    var sX = 0, sY = 0,       // spinX, spinY\n        pX = 0, pY = 0;       // pixelX, pixelY\n\n    // Legacy\n    if ('detail' in event) { sY = event.detail; }\n    if ('wheelDelta' in event) { sY = -event.wheelDelta / 120; }\n    if ('wheelDeltaY' in event) { sY = -event.wheelDeltaY / 120; }\n    if ('wheelDeltaX' in event) { sX = -event.wheelDeltaX / 120; }\n\n    // side scrolling on FF with DOMMouseScroll\n    if ('axis' in event && event.axis === event.HORIZONTAL_AXIS) {\n        sX = sY;\n        sY = 0;\n    }\n\n    pX = sX * PIXEL_STEP;\n    pY = sY * PIXEL_STEP;\n\n    if ('deltaY' in event) { pY = event.deltaY; }\n    if ('deltaX' in event) { pX = event.deltaX; }\n\n    if ((pX || pY) && event.deltaMode) {\n        if (event.deltaMode === 1) {          // delta in LINE units\n            pX *= LINE_HEIGHT;\n            pY *= LINE_HEIGHT;\n        } else {                             // delta in PAGE units\n            pX *= PAGE_HEIGHT;\n            pY *= PAGE_HEIGHT;\n        }\n    }\n\n    // Fall-back if spin cannot be determined\n    if (pX && !sX) { sX = (pX < 1) ? -1 : 1; }\n    if (pY && !sY) { sY = (pY < 1) ? -1 : 1; }\n\n    return {\n        spinX: sX,\n        spinY: sY,\n        pixelX: pX,\n        pixelY: pY\n    };\n}\n\nexport { normalizeWheel };\n","import React, { useCallback, useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport useDrag from '../tools/useDrag';\nimport { normalizeWheel } from '../utils';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        backgroundColor: '#000000',\n        width: '11em',\n        fontSize: `${78 / 11}px`,\n        right: 0,\n        top: 0,\n        height: '100%',\n        overflow: 'hidden',\n    },\n});\n\nfunction Thumb({\n    children, scaleRef, music: { duration }, containerEl, thumbScrollSpeed, scrollRef,\n}) {\n    const classes = useStyles();\n\n    const [thumbEl, setThumbEl] = useState(null);\n    const updateScroll = useCallback((e, { left }) => {\n        if (!containerEl) return;\n        if (!left) return;\n        const scale = scaleRef.current;\n        const position = e.clientY / window.innerHeight * duration;\n        const viewSize = window.innerHeight / scale; // in seconds\n        const height = duration * scale;\n        // const { height } = innerEl.getBoundingClientRect();\n        let top = (position - viewSize / 2) / duration * height; // in px\n        if (top < 0) top = 0;\n        if (top + window.innerHeight > height) top = height - window.innerHeight;\n        scrollRef.current = top;\n        // containerEl.scrollTop = top;\n    }, [containerEl, duration, scaleRef, scrollRef]);\n    useDrag({ onDrag: updateScroll, onDragEnd: updateScroll, el: thumbEl });\n\n    // scale = pixels per second\n    const onWheel = useCallback((e) => {\n        if (!containerEl) return;\n        const { pixelY } = normalizeWheel(e.nativeEvent);\n        const scale = scaleRef.current;\n        const height = duration * scale;\n        const viewTop = scrollRef.current / height * window.innerHeight;\n        const viewHeight = window.innerHeight / scale;\n        let newTop = viewTop + pixelY * thumbScrollSpeed;\n        if (newTop < 0) newTop = 0;\n        if (newTop + viewHeight > window.innerHeight) newTop = window.innerHeight - viewHeight;\n        const newScroll = newTop / window.innerHeight * height;\n        scrollRef.current = newScroll;\n    }, [containerEl, duration, scaleRef, scrollRef, thumbScrollSpeed]);\n\n    return (\n        <div className={classes.root} ref={setThumbEl} onWheel={onWheel}>\n            {children}\n        </div>\n    );\n};\n\nexport default Thumb;\n","import React, { useCallback, useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport useFrame from '../tools/useFrame';\n\nconst useStyles = makeStyles({\n    stencil: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        width: '100%',\n        height: '100%',\n        backgroundColor: 'rgba(0, 0, 0, 0.65)',\n        pointerEvents: 'none',\n        willChange: 'transform',\n    },\n});\n\nfunction Stencil({ music: { duration }, scaleRef, scrollRef }) {\n    const classes = useStyles();\n\n    const [upperEl, setUpperEl] = useState(null);\n    const [lowerEl, setLowerEl] = useState(null);\n    const updateStencil = useCallback(() => {\n        const height = duration * scaleRef.current;\n        // const height = innerEl.getBoundingClientRect().height;\n        const top = scrollRef.current / height;\n        const bottom = (scrollRef.current + window.innerHeight) / height;\n        // const top = containerEl.scrollTop / height;\n        // const bottom = (containerEl.scrollTop + window.innerHeight) / height;\n        if (upperEl) {\n            upperEl.style.transform = `translateY(\n                ${-(1 - top) * 100}%\n            )`;\n        }\n        if (lowerEl) {\n            lowerEl.style.transform = `translateY(\n                ${bottom * 100}%\n            )`;\n        }\n    }, [duration, scaleRef, scrollRef, upperEl, lowerEl]);\n    useFrame(updateStencil);\n    \n    return <>\n        <div ref={setUpperEl} className={classes.stencil}/>\n        <div ref={setLowerEl} className={classes.stencil}/>\n    </>;\n}\n\nexport default Stencil;\n","import React, { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        height: '100%',\n        left: `${2 / 11 * 100}%`,\n        right: `${2 / 11 * 100}%`,\n    },\n    timer: {\n        position: 'absolute',\n        left: 0,\n        right: 0,\n        height: 0,\n        borderBottom: '1px solid #FFCD18',\n        marginBottom: -0.5,\n    },\n});\n\nfunction Timer({ time,  duration }) {\n    const classes = useStyles();\n    return (\n        <div\n            className={classes.timer}\n            style={{ bottom: `${time / duration * 100}%` }}>\n        </div>\n    );\n}\n\nfunction ThumbTimers({ time2Timers, music: { duration } }) {\n    const classes = useStyles();\n\n    const timerEls = useMemo(() => {\n        const res = [];\n        time2Timers.forEach((time, { beat }) => {\n            res.push((\n                <Timer key={beat} time={time} duration={duration}/>\n            ));\n        });\n        return res;\n    }, [time2Timers, duration]);\n\n    return (\n        <div className={classes.root}>\n            {timerEls}\n        </div>\n    );\n}\n\nexport default ThumbTimers;\n","import React, { useCallback, useEffect } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\n\nfunction Player({ music, code, setCode }) {\n    const onSpace = useCallback((_, event) => {\n        if (music.paused) music.play();\n        else music.pause();\n        event.stopPropagation();\n        event.preventDefault();\n    }, [music]);\n    const setMyCode = useCallback(() => setCode('player'), [setCode]);\n    useEffect(() => {\n        if (code !== 'player') music.pause();\n    }, [code, music]);\n    return <>\n        <KeyboardEventHandler handleKeys={['r']} onKeyEvent={setMyCode}/>\n        <KeyboardEventHandler isDisabled={code !== 'player'} handleKeys={['space']} onKeyEvent={onSpace}/>\n    </>;\n}\n\nexport default Player;","import React, { useCallback, useMemo, useRef } from 'react';\nimport { Howl } from 'howler';\nimport flickFX from '../assets/flick.mp3';\nimport tapFX from '../assets/tap.mp3';\nimport useFrame from './useFrame';\n\nfunction SoundFX({ music, time2Notes }) {\n    const tap = useMemo(() => new Howl({ src: [tapFX] }), []);\n    const flick = useMemo(() => new Howl({ src: [flickFX] }), []);\n\n    // to bypass the React render procedure and elimanate delay playing sound,\n    // we check for new sound events every frame, that is, sound events that happened/\n    // after last frame and before this frame.\n    const lastTimeRef = useRef(0);\n    const onFrame = useCallback(() => {\n        if (music.paused) return;\n        let hasTap = false, hasFlick = false;\n        time2Notes.forEach((_, { flick }) => {\n            // both sound effects are played only once in one frame\n            if (flick) hasFlick = true;\n            else hasTap = true;\n        }, lastTimeRef.current, music.currentTime);\n        lastTimeRef.current = music.currentTime;\n        if (hasTap) tap.play();\n        if (hasFlick) flick.play();\n    }, [flick, music, tap, time2Notes]);\n    useFrame(onFrame);\n\n    return <div/>;\n};\n\nexport default SoundFX;\n","import { useCallback } from 'react';\nimport useEvent from './useEvent';\n\nfunction Progress({\n    music, containerEl, code, inflate,\n}) {\n    const seekProgress = useCallback((e) => {\n        if (code !== 'player') return;\n        const { time } = inflate(e);\n        music.currentTime = time;\n        if (music.paused) music.play();\n    }, [code, inflate, music]);\n    useEvent(containerEl, 'click', seekProgress);\n    return null;\n}\n\nexport default Progress;\n","import { useCallback, useEffect, useRef } from 'react';\nimport useDrag from './useDrag';\n\nconst usePen = ({\n    notes, setNotes, inflate, code, findNotePure, matchNotePure, time2Timers, quantize, containerEl,\n}, {\n    prefix, useRemove = true, type, onClick, quantizeThreshold = 0.25, snapThreshold = 0.1,\n}) => {\n    // notesRef serves as a cache to notes, the useEffect hook below keeps them\n    // the same every React render, and if several modifications are to be made\n    // to the notes object in the same React frame, notesRef.current will record\n    // these modification and keep the UI responsive. For more details, see\n    // comments to overriddenSetNotes beneath.\n    // the other purpose of notesRef is to eliminate the need to re-memo onDragStart,\n    // onDrag and onDragEnd every time notes changes. Otherwise, each new note will\n    // result in re-execution of the useEffect hook registering mouse listeners,\n    // destroying any internal state (like dragging) we kept in that closure.\n    const notesRef = useRef(notes);\n    useEffect(() => { notesRef.current = notes; }, [notes]);\n    const codeRef = useRef(code);\n    useEffect(() => { codeRef.current = code; }, [code]);\n\n    const onDragStart = useCallback(() => {\n        if (!code.startsWith(prefix)) return false;\n    }, [code, prefix]);\n    const onDrag = useCallback((e, { shift, left, right }) => {\n        const notes = notesRef.current;\n        // when dragging, the mousemove event might be fired multiple times in one\n        // React render, which invokes onDrag and placeNote and setNotes multiple times,\n        // each time adding a new note. However, changes in notes are not commited until\n        // the next React render, which calls the previous useEffect hook and updates\n        // notesRef.current. So, in this case, the notes object passed into placeNote\n        // will remain unchanged, and the new notes object passed into setNotes will be\n        // the notes at the beginning of this React render plus one note, and some notes\n        // will be lost.\n        // the solution is to set notesRef.current each time a new note is added, as a\n        // cache to notes, and allow subsequent onDrag calls to see the new note fast\n        // enough, thus the note loss is eliminated. Meanwhile, setNotes is still called,\n        // and the global notes state will be updated in the next React render, which\n        // allows ALL the new notes to be displayed.\n        const overriddenSetNotes = (newNotes) => {\n            setNotes(newNotes);\n            notesRef.current = newNotes;\n        };\n        if (!shift) return;\n        if (left) {\n            switch (type) {\n                case 'quantize': {\n                    const { time, lane } = inflate(e);\n                    const { beat, delta } = quantize(time);\n                    if (delta > quantizeThreshold) return;\n                    const quantizedLane = Math.round(lane);\n                    if (quantizedLane < 0 || quantizedLane >= 7) return;\n                    onClick(code, notes, findNotePure, overriddenSetNotes, beat, quantizedLane, false);\n                    break;\n                }\n                case 'snap': {\n                    const { time, lane } = inflate(e);\n                    const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n                    if (!matched) return;\n                    const { beat, lane: matchedLane } = matched;\n                    onClick(code, notes, findNotePure, overriddenSetNotes, beat, matchedLane, false);\n                    break;\n                }\n                default: break;\n            }\n        }\n        if (useRemove && right) {\n            const { time, lane } = inflate(e);\n            const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n            if (!matched) return;\n            const { beat, lane: matchedLane } = matched;\n            const it = findNotePure(notes, beat, matchedLane);\n            if (it) overriddenSetNotes(it.remove());\n        }\n    }, [\n        code, time2Timers, findNotePure, quantize, inflate, setNotes, matchNotePure,\n        type, useRemove, onClick, quantizeThreshold, snapThreshold,\n    ]);\n    const onDragEnd = useCallback((e, { shift, left, right }) => {\n        const notes = notesRef.current;\n        if (shift) return;\n        const { time, lane } = inflate(e);\n        if (left) {\n            switch (type) {\n                case 'quantize': {\n                    const { time, lane } = inflate(e);\n                    const { beat, delta } = quantize(time);\n                    if (delta > quantizeThreshold) return;\n                    const quantizedLane = Math.round(lane);\n                    if (quantizedLane < 0 || quantizedLane >= 7) return;\n                    onClick(code, notes, findNotePure, setNotes, beat, quantizedLane, true);\n                    break;\n                }\n                case 'snap': {\n                    const { time, lane } = inflate(e);\n                    const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n                    if (!matched) return;\n                    const { beat, lane: matchedLane } = matched;\n                    onClick(code, notes, findNotePure, setNotes, beat, matchedLane, true);\n                    break;\n                }\n                default: break;\n            }\n        }\n        if (useRemove && right) {\n            const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n            if (!matched) return;\n            const { beat, lane: matchedLane } = matched;\n            const it = findNotePure(notes, beat, matchedLane);\n            if (it) setNotes(it.remove());\n        }\n    }, [\n        code, time2Timers, findNotePure, inflate, matchNotePure, quantize, setNotes,\n        type, useRemove, onClick, quantizeThreshold, snapThreshold,\n    ]);\n\n    useDrag({ onDragStart, onDrag, onDragEnd, el: containerEl });\n};\n\nexport default usePen;\n","import React, { useCallback } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport usePen from './usePen';\n\nconst placeNote = (code, notes, findNotePure, setNotes, beat, lane, singleClick) => {\n    switch (code) {\n        case 'placement/single': {\n            // if a note already exists with the same note and line, abandon placement\n            if (findNotePure(notes, beat, lane)) break;\n            setNotes(notes.insert(beat, { note: 'Single', lane }));\n            break;\n        }\n        case 'placement/slide-a': case 'placement/slide-b': {\n            const pos = code.substring(code.length - 1).toUpperCase(); // A or B\n            const it = findNotePure(notes, beat, lane);\n            if (!it) {\n                // default to true so if no such notes are found, a head is created\n                let foundTail = true;\n                // search in reverse order and try to find the last slide note\n                // with same pos\n                for (const it2 = notes.lt(beat); it2.valid; it2.prev()) {\n                    const { value: { note: type, pos: notePos, end } } = it2;\n                    if (type !== 'Slide' || notePos !== pos) continue;\n                    if (!end) foundTail = false;\n                    break;\n                }\n                // if last slide with same pos was not tail, then the last snake\n                // has not terminated, and a middle slide note was inserted, otherwise\n                // a head note was inserted to create a new snake.\n                setNotes(notes.insert(beat, {\n                    lane, pos,\n                    note: 'Slide',\n                    flick: false,\n                    start: foundTail,\n                    end: false, // new note is never end\n                }));\n            } else if (singleClick) {\n                const { value: { note: type, pos: notePos, end, start } } = it;\n                // overwrite same type only\n                if (type !== 'Slide' || notePos !== pos) break;\n                setNotes(it.update({\n                    lane, pos,\n                    note: 'Slide',\n                    flick: false, // new note is never flick\n                    start: false, // new note is never head\n                    end: !(end || start), // if note was head or tail, convert to middle\n                }));\n            }\n            break;\n        }\n        default: break;\n    }\n};\n\nfunction Placement(props) {\n    const { setCode } = props;\n    const setSingle = useCallback(() => setCode('placement/single'), [setCode]);\n    const setSlideA = useCallback(() => setCode('placement/slide-a'), [setCode]);\n    const setSlideB = useCallback(() => setCode('placement/slide-b'), [setCode]);\n    \n    usePen(props, { prefix: 'placement/', type: 'quantize', onClick: placeNote });\n\n    return <>\n        <KeyboardEventHandler handleKeys={['f']} onKeyEvent={setSingle}/>\n        <KeyboardEventHandler handleKeys={['s']} onKeyEvent={setSlideA}/>\n        <KeyboardEventHandler handleKeys={['d']} onKeyEvent={setSlideB}/>\n    </>;\n}\n\nexport default Placement;\n","import React, { useCallback } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\n\nfunction Divisions({ setDivision }) {\n    const setDivision1 = useCallback(() => setDivision(1), [setDivision]);\n    const setDivision2 = useCallback(() => setDivision(2), [setDivision]);\n    const setDivision3 = useCallback(() => setDivision(3), [setDivision]);\n    const setDivision4 = useCallback(() => setDivision(4), [setDivision]);\n    const setDivision6 = useCallback(() => setDivision(6), [setDivision]);\n    const setDivision8 = useCallback(() => setDivision(8), [setDivision]);\n    return <>\n        <KeyboardEventHandler handleKeys={['1']} onKeyEvent={setDivision1}/>\n        <KeyboardEventHandler handleKeys={['2']} onKeyEvent={setDivision2}/>\n        <KeyboardEventHandler handleKeys={['3']} onKeyEvent={setDivision3}/>\n        <KeyboardEventHandler handleKeys={['4']} onKeyEvent={setDivision4}/>\n        <KeyboardEventHandler handleKeys={['6']} onKeyEvent={setDivision6}/>\n        <KeyboardEventHandler handleKeys={['8']} onKeyEvent={setDivision8}/>\n    </>;\n}\n\nexport default Divisions;\n","import React, { useCallback } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport usePen from './usePen';\n\nconst modifyNote = (code, notes, findNotePure, setNotes, beat, lane) => {\n    switch (code) {\n        case 'modification/flick': {\n            const it = findNotePure(notes, beat, lane);\n            if (!it) break;\n            const { value: note, value: { flick, note: type, end } } = it;\n            if (type === 'Slide' && !end) break; // cannot switch flick state\n            setNotes(it.update({ ...note, flick: !flick }));\n            break;\n        }\n        default: break;\n    }\n};\n\nfunction Modification(props) {\n    const { setCode } = props;\n    usePen(props, { prefix: 'modification/', type: 'snap', onClick: modifyNote });\n\n    const setFlick = useCallback(() => setCode('modification/flick'), [setCode]);\n    return <>\n        <KeyboardEventHandler handleKeys={['w']} onKeyEvent={setFlick}/>\n    </>;\n}\n\nexport default Modification;\n","import React, { useCallback } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport useEvent from './useEvent';\n\nfunction PlaceTimer({ code, containerEl, setCode, inflate, quantize, timers, setTimers, currentBPM }) {\n    const setMyCode = useCallback(() => setCode('timer'), [setCode]);\n\n    const onClick = useCallback((e) => {\n        if (code !== 'timer') return;\n        const { time } = inflate(e);\n        const { beat } = quantize(time);\n        const it = timers.find(beat);\n        if (it.valid) setTimers(it.update({ bpm: currentBPM }));\n        else setTimers(timers.insert(beat, { bpm: currentBPM }));\n    }, [code, currentBPM, inflate, quantize, setTimers, timers]);\n    useEvent(containerEl, 'click', onClick);\n    const onContextMenu = useCallback((e) => {\n        if (code !== 'timer') return;\n        const { time } = inflate(e);\n        const { beat } = quantize(time);\n        const it = timers.find(beat);\n        if (it.valid) setTimers(it.remove());\n    }, [code, inflate, quantize, setTimers, timers]);\n    useEvent(containerEl, 'contextmenu', onContextMenu);\n    \n    return (\n        <KeyboardEventHandler handleKeys={['a']} onKeyEvent={setMyCode}/>\n    );\n}\n\nexport default PlaceTimer;\n","import React, { useCallback, useState } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport { makeStyles } from '@material-ui/styles';\nimport createTree from 'functional-red-black-tree';\nimport useDrag from './useDrag';\n\nconst useStyles = makeStyles({\n    dragArea: {\n        position: 'fixed',\n        backgroundColor: 'rgba(89, 150, 255, 0.4)',\n        border: '1px solid #5996FF',\n        visibility: 'hidden',\n    },\n    dragLine: {\n        position: 'fixed',\n        pointerEvents: 'none',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n    },\n});\n\nconst clickThreshold = 10;\nconst snapThreshold = 0.1;\n\nfunction Select({\n    code, inflate, setCode, notes, setNotes, time2Timers, matchNotePure, findNotePure,\n    containerEl, quantize, deflate,\n}) {\n    const classes = useStyles();\n    const setSelect = useCallback(() => setCode('select'), [setCode]);\n\n    const onDragStart = useCallback((e, state) => {\n        if (code !== 'select') return false;\n        state.click = true;\n        const { time, lane } = inflate(e);\n        // if drag starts on a note, we assume that the user wants to move\n        // select notes (relative to the note where the dragging begins).\n        const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n        if (matched) {\n            // save state to moving\n            state.move = true;\n            const { time: matchedTime, lane: matchedLane, beat } = matched;\n            const { x, y } = deflate({ time: matchedTime, lane: matchedLane });\n            // in this case, startX and startY is set to the beat and lane\n            // of the current note, which would be exactly on the grid\n            state.startX = x;\n            state.startY = y;\n            state.startIndex = findNotePure(notes, beat, matchedLane).index;\n        } else state.move = false;\n    }, [code, deflate, findNotePure, inflate, matchNotePure, notes, time2Timers]);\n    const [dragArea, setDragArea] = useState(null);\n    const [dragLine, setDragLine] = useState(null);\n    const onDrag = useCallback((e, state) => {\n        const { startX, startY } = state;\n        // if the mouse did not go over clickThreshold pixels, we assume that\n        // the user wanted to make a simple click. state.click is used to track\n        // whether this threshold was exceeded during the dragging process\n        const dist = Math.sqrt(Math.pow(e.clientX - startX, 2) + Math.pow(e.clientY - startY, 2));\n        if (dist > clickThreshold) state.click = false;\n        if (dragArea) {\n            // dragArea tracks the rectangle between the starting point and the\n            // current point, like when you drag on the Windows desktop.\n            // the drag area is visible only when the user is selecting instead\n            // of moving\n            dragArea.style.visibility = !state.move ? 'unset' : 'hidden';\n            // width and height cannot be negative\n            const x1 = Math.min(e.clientX, startX), x2 = Math.max(e.clientX, startX);\n            const y1 = Math.min(e.clientY, startY), y2 = Math.max(e.clientY, startY);\n            dragArea.style.left = `${x1}px`;\n            dragArea.style.top = `${y1}px`;\n            dragArea.style.width = `${x2 - x1}px`;\n            dragArea.style.height = `${y2 - y1}px`;\n        }\n        if (dragLine) {\n            // dragLine is the line between the starting point (which is ALWAYS\n            // on the grid) and the current point, where the end point of the line\n            // is quantized to the grid.\n            const { time, lane } = inflate(e);\n            const { time: quantizedTime } = quantize(time);\n            let quantizedLane = Math.round(lane);\n            if (quantizedLane < 0) quantizedLane = 0;\n            if (quantizedLane > 6) quantizedLane = 6;\n            // find the position of the end point\n            const { x, y } = deflate({ time: quantizedTime, lane: quantizedLane });\n            // the drag area is visible only when the user is moving instead\n            // of selecting\n            dragLine.style.visibility = state.move ? 'unset' : 'hidden';\n            // the dragLine element is an SVG <line> element, where viewport is the\n            // whole screen.\n            const x1 = state.shift ? startX : x, x2 = startX;\n            const y1 = y, y2 = startY;\n            dragLine.setAttribute('x1', `${x1}`);\n            dragLine.setAttribute('x2', `${x2}`);\n            dragLine.setAttribute('y1', `${y1}`);\n            dragLine.setAttribute('y2', `${y2}`);\n        }\n    }, [deflate, dragArea, dragLine, inflate, quantize]);\n    const clearSelectionPure = useCallback((notes) => {\n        for (let it = notes.begin; it.valid; it.next()) {\n            const { index, value: { selected = false }, value: note } = it;\n            if (selected) {\n                notes = it.update({ ...note, selected: false });\n                // since notes is functional, the previous iterator will not\n                // be working after the update, so we must find the iterator\n                // pointing to the same element, but in the new tree.\n                it = notes.at(index); // new notes\n            }\n        }\n        return notes;\n    }, []);\n    const toggleNotesPure = useCallback((notes, startBeat, endBeat, startLane, endLane) => {\n        for (let it = notes.ge(startBeat); it.valid && it.key < endBeat; it.next()) {\n            const { index, value: note, value: { lane, selected } } = it;\n            if (lane >= startLane && lane < endLane) {\n                notes = it.update({ ...note, selected: !selected });\n                // see above\n                it = notes.at(index); // new notes\n            }\n        }\n        return notes;\n    }, []);\n    const onDragEnd = useCallback((e, { right, startX, startY, shift, click, move, startIndex }) => {\n        const { time, beat, lane } = inflate(e);\n        // if right button is pressed, under all circumstances, no matter\n        // whether click or move is true, we delete all the selected notes.\n        // if the last note is not selected, we clear the current selection\n        // and select that note, just as in moves.\n        // A right drag would not be meaningful, the behavior is undefined.\n        if (right) {\n            const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n            if (matched) {\n                let tmpSource = notes;\n                const { index, value: { selected } } = findNotePure(tmpSource, matched.beat, matched.lane);\n                if (!selected) {\n                    tmpSource = clearSelectionPure(tmpSource);\n                    const newIt = tmpSource.at(index);\n                    tmpSource = newIt.update({ ...newIt.value, selected: true });\n                }\n                let tmpNotes = createTree();\n                for (let it = tmpSource.begin; it.valid; it.next()) {\n                    const { key: noteBeat, value: note, value: { selected } } = it;\n                    if (!selected) tmpNotes = tmpNotes.insert(noteBeat, note);\n                }\n                setNotes(tmpNotes);\n            }\n        } else if (click) {\n            // if drag distance is too short that it's considered a click,\n            // we treat it as if the user is selecting a single note\n            let tmpNotes = notes;\n            // if shift was pressed, toggle selection, otherwise replace selection,\n            // hence we have to first clear the current selection\n            if (!shift) tmpNotes = clearSelectionPure(tmpNotes);\n            // if the user clicks on a note, select the note, otherwise clear\n            // selection (as if the user is selecting nothing).\n            const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n            if (matched) {\n                // toggle selection of the matched note\n                const { beat, lane: matchedLane } = matched;\n                const it = findNotePure(tmpNotes, beat, matchedLane);\n                tmpNotes = it.update({ ...it.value, selected: !it.value.selected });\n            }\n            setNotes(tmpNotes);\n        } else if (move) {\n            // if user is moving notes, we quantize the end point and find the\n            // delta of lanes and beats\n            const { time, lane } = inflate(e);\n            const { beat: quantizedBeat } = quantize(time);\n            let quantizedLane = Math.round(lane);\n            if (quantizedLane < 0) quantizedLane = 0;\n            if (quantizedLane > 6) quantizedLane = 6;\n\n            // update notes\n            // here we simply insert every note into the new tree, moving it if\n            // it's selected. Since a duplicate check (O(logn) for RBTs) precedes\n            // every insertion, the total time complexity would be (O(nlogn)), which\n            // is a fairly high cost and leaves space for optimization.\n            // TODO: optimize this\n            let tmpNotes = createTree();\n\n            // user experience adapted from Adobe Illustrator\n            // if the user starts to move from an unselected note, we first clears\n            // the current selection and selects the starting note, then move it\n            // (as the single selected note). On the contrary, if the starting note\n            // is selected, we simply move the whole selection. This allows the user\n            // to move a note (and select it in the same time) without having to \n            // select anything in advance.\n            // Note that this operation cannot be done when the drag begins, since\n            // it's not yet determined whether the drag will end up as a click, in\n            // which case we should NOT clear the current selection.\n            let tmpSource = notes;\n            // here, we do not simply inflate the starting point to get the starting\n            // beat and lane, since round-off errors will created unexpected results.\n            // instead, we use the index saved when the dragging begins to obtain\n            // the starting note, and use its beat and lane instead.\n            const { key: startBeat, value: { selected, lane: startLane } } = tmpSource.at(startIndex);\n            if (!selected) {\n                tmpSource = clearSelectionPure(tmpSource);\n                const newIt = tmpSource.at(startIndex);\n                tmpSource = newIt.update({ ...newIt.value, selected: true });\n            }\n\n            const deltaBeat = quantizedBeat - startBeat;\n            // if shift was pressed, do not move lanes.\n            const deltaLane = shift ? 0 : quantizedLane - startLane;\n\n            const insert = (beat, note) => {\n                const { lane } = note;\n                // no duplicates. This means that when the move places two notes at\n                // the same position, one of them will be ignored and there's NO\n                // guarentee which one this is.\n                if (!findNotePure(tmpNotes, beat, lane)) tmpNotes = tmpNotes.insert(beat, note);\n            };\n            // traverse through notes, if it's selected, insert it into tmpNotes\n            // after moving, otherwise simply copy it.\n            for (let it = tmpSource.begin; it.valid; it.next()) {\n                const { key: noteBeat, value: note, value: { selected, lane: noteLane } } = it;\n                if (!selected) insert(noteBeat, note);\n                else {\n                    const newBeat = noteBeat + deltaBeat;\n                    // new beat should be non-negative\n                    if (newBeat < 0) continue;\n                    // new lane cannot exceed the [0, 6] range, note that this might\n                    // cause the shape of the selection to change after moving, some\n                    // notes might even disappear, pressing shift will solve the problem.\n                    let newLane = noteLane + deltaLane;\n                    if (newLane < 0) newLane = 0;\n                    if (newLane > 6) newLane = 6;\n                    insert(newBeat, { ...note, lane: newLane });\n                }\n            }\n            setNotes(tmpNotes);\n        } else {\n            // if the user is selecting all notes in the rectangle, we traverse\n            // through all the notes inside the beat range and toggle the selection\n            // status.\n            let tmpNotes = notes;\n            // if shift was pressed, toggle selection, otherwise replace selection,\n            // hence we have to first clear the current selection\n            if (!shift) tmpNotes = clearSelectionPure(tmpNotes);\n            const { beat: beat1, lane: lane1 } = inflate({ clientX: startX, clientY: startY });\n            const beat2 = beat, lane2 = lane;\n            // STAR BEAT ~~\n            const startBeat = Math.min(beat1, beat2), endBeat = Math.max(beat1, beat2);\n            const startLane = Math.min(lane1, lane2), endLane = Math.max(lane1, lane2);\n            tmpNotes = toggleNotesPure(tmpNotes, startBeat, endBeat, startLane, endLane);\n            setNotes(tmpNotes);\n        }\n        // hide drag area and drag line\n        if (dragArea) dragArea.style.visibility = 'hidden';\n        if (dragLine) dragLine.style.visibility = 'hidden';\n    }, [clearSelectionPure, dragArea, dragLine, findNotePure, inflate, matchNotePure, notes, quantize, setNotes, time2Timers, toggleNotesPure]);\n    useDrag({ onDragStart, onDrag, onDragEnd, el: containerEl });\n    \n    return <>\n        <KeyboardEventHandler handleKeys={['v']} onKeyEvent={setSelect}/>\n        <div className={classes.dragArea} ref={setDragArea}/>\n        <div className={classes.dragLine}>\n            <svg width=\"100%\" height=\"100%\">\n                <line stroke=\"#5996FF\" strokeWidth=\"2\" x1=\"100\" x2=\"200\" y1=\"100\" y2=\"200\" ref={setDragLine} style={{ visibility: 'hidden' }}/>\n            </svg>\n        </div>\n    </>;\n}\n\nexport default Select;\n","import { useCallback, useEffect } from 'react';\nimport useEvent from '../tools/useEvent';\nimport { normalizeWheel } from '../utils';\n\nfunction Navigation({\n    music: { duration }, scaleRef, scaleSpeed, minScale, maxScale, scrollSpeed, scrollRef, containerEl,\n}) {\n    // scale = pixels per second\n    const onWheel = useCallback((e) => {\n        const { pixelY } = normalizeWheel(e);\n        const scale = scaleRef.current;\n        if (e.ctrlKey) { // scaling\n            const height = scale * duration;\n            // scaling keeps the cursor unmoved, that is, \n            const ratio = (e.clientY + scrollRef.current) / height;\n            // scale changes on a proportional basis, a same scroll distance\n            // results in a same proportion of scale change.\n            let newScale = scale * (1 - pixelY * scaleSpeed);\n            if (newScale < minScale) newScale = minScale;\n            if (newScale > maxScale) newScale = maxScale;\n            const newHeight = newScale * duration;\n            let newScroll = ratio * newHeight - e.clientY;\n            // keep whole score in viewport\n            if (newScroll < 0) newScroll = 0;\n            if (newScroll + window.innerHeight > newHeight) newScroll = newHeight - window.innerHeight;\n            scrollRef.current = newScroll;\n            scaleRef.current = newScale;\n        } else {\n            const height = scale * duration;\n            // scroll changes proportional to scale, a same scroll distance\n            // results in a same scroll change measured in *beats*. \n            let newScroll = scrollRef.current + pixelY * scrollSpeed * Math.sqrt(scale);\n            // keep whole score in viewport\n            if (newScroll < 0) newScroll = 0;\n            if (newScroll + window.innerHeight > height) newScroll = height - window.innerHeight;\n            scrollRef.current = newScroll;\n        }\n    }, [scaleRef, duration, scrollRef, scaleSpeed, minScale, maxScale, scrollSpeed]);\n    // prevent default ctrl+wheel zoom, for details about the { passive: false } option\n    // in addEventListener, see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n    useEffect(() => {\n        const prevent = (e) => {\n            if (!e.ctrlKey) return;\n            e.stopPropagation();\n            e.preventDefault();\n            return false;\n        };\n        window.addEventListener('wheel', prevent, { passive: false });\n        return () => window.removeEventListener('wheel', prevent);\n    }, []);\n    useEvent(containerEl, 'wheel', onWheel);\n\n    // jump to scroll bottom initially\n    useEffect(() => {\n        const height = duration * scaleRef.current;\n        scrollRef.current = height - window.innerHeight;\n    }, [duration, scaleRef, scrollRef]);\n\n    return null;\n}\n\nexport default Navigation;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nimport Controls from '../ui/Controls';\n\nimport useTool from './useTool';\nimport useScore from './useScore';\nimport useChart from './useChart';\n\nimport Score from './Score';\nimport Bars from './Bars';\nimport Notes from './Notes';\nimport Thumb from './Thumb';\nimport Stencil from './Stencil';\nimport ThumbTimers from './ThumbTimers';\n\nimport Player from '../tools/Player';\nimport SoundFX from '../tools/SoundFX';\nimport Progress from '../tools/Progress';\nimport Placement from '../tools/Placement';\nimport Divisions from '../tools/Divisions';\nimport Modification from '../tools/Modification';\nimport PlaceTimer from '../tools/PlaceTimer';\nimport Select from '../tools/Select';\nimport Navigation from './Navigation';\n\nconst useStyles = makeStyles({\n    middle: {\n        position: 'absolute',\n        left: '25%',\n        top: 0,\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'start',\n        alignItems: 'stretch',\n    },\n    right: {\n        position: 'absolute',\n        right: 0,\n        height: '100%',\n        top: 0,\n    },\n});\n\nfunction Chart({ music, score }) {\n    const classes = useStyles();\n\n    const chartParams = useChart({ music, score });\n    const scoreParams = useScore(chartParams);\n    const toolParams = useTool();\n    const params = { music, ...chartParams, ...scoreParams, ...toolParams };\n\n    return <>\n        <div className={classes.middle}>\n            <Score {...params}/>\n            <Navigation {...params}/>\n            <Progress {...params}/>\n            <PlaceTimer {...params}/>\n            <Modification  {...params}/>\n            <Placement {...params}/>\n            <Select {...params}/>\n            <Divisions {...params}/>\n            <Player {...params}/>\n            <SoundFX {...params}/>\n            <Controls {...params}/>\n        </div>\n        <div className={classes.right}>\n            <Thumb {...params}>\n                <Bars {...params} division={1 / 4} thumb={true}/>\n                <ThumbTimers {...params}/>\n                <Notes {...params} thumb={true}/>\n                {/* <Stencil {...params}/> */}\n            </Thumb>\n        </div>\n    </>;\n};\n\nexport default Chart;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n    middle: {\n        position: 'absolute',\n        left: '25%',\n        top: 0,\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'center',\n        alignItems: 'center',\n        width: 470,\n        fontSize: 28,\n        fontWeight: 'bold',\n        backgroundColor: '#000',\n        color: '#FFF',\n    },\n    right: {\n        position: 'absolute',\n        right: 0,\n        height: '100%',\n        top: 0,\n        width: '11em',\n        fontSize: `${78 / 11}px`,\n        backgroundColor: '#000',\n    },\n});\n\nfunction Loading({ children }) {\n    const classes = useStyles();\n    return <>\n        <div className={classes.middle}>\n            {children}\n        </div>\n        <div className={classes.right}/>\n    </>;\n};\n\nexport default Loading;\n","import React, { useState, useMemo, useEffect, useCallback } from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nimport Menus from './ui/Menus';\nimport { load } from './chart/storage';\nimport useEvent from './tools/useEvent';\nimport Chart from './chart/Chart';\nimport Loading from './Loading';\n\nconst useStyles = makeStyles({\n  root: {\n    width: '100%',\n    height: '100%',\n  },\n  left: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n  },\n  middle: {\n    position: 'absolute',\n    left: '25%',\n    top: 0,\n    height: '100%',\n  },\n});\n\nfunction App() {\n  const classes = useStyles();\n\n  const initialScore = useMemo(() => load(), []);\n  const [score, setScore] = useState(initialScore);\n\n  const [musicURL, setMusicURL] = useState(localStorage.getItem('music'));\n  useEffect(() => {\n    if (musicURL) localStorage.setItem('music', musicURL);\n  }, [musicURL]);\n\n  const music = useMemo(() => new Audio(), []);\n  useEffect(() => {\n    music.src = musicURL;\n    music.load();\n  }, [music, musicURL]);\n  const [musicLoaded, setMusicLoaded] = useState(false);\n  const onDurationChange = useCallback(() => setMusicLoaded(music.duration > 0), [music]);\n  useEvent(music, 'durationchange', onDurationChange);\n  const onEmptied = useCallback(() => setMusicLoaded(false), []);\n  useEvent(music, 'emptied', onEmptied);\n\n  const params = { score, setScore, musicURL, setMusicURL, music, musicLoaded };\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.left}>\n        <Menus {...params}/>\n      </div>\n      {musicLoaded ? (\n        <Chart {...params}/>\n      ) : (\n        <Loading>\n          {musicURL === null ? '' : ''}\n        </Loading>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}