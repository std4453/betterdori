{"version":3,"sources":["assets/cancel.svg","assets/submit.svg","assets/settings.svg","assets/hamburger.svg","assets/delete.svg","assets/album.svg","assets/export.svg","assets/import.svg","assets/select.svg","assets/single.svg","assets/slide-1.svg","assets/slide-2.svg","assets/flick.svg","assets/timer.svg","assets/player.svg","assets/pause.svg","assets/play.svg","assets/x05.svg","assets/x10.svg","assets/x15.svg","assets/x20.svg","assets/follow.svg","assets/bars.svg","assets/d1.svg","assets/d2.svg","assets/d3.svg","assets/d4.svg","assets/d6.svg","assets/d8.svg","assets/focus.svg","assets/cross.svg","assets/flick.mp3","assets/tap.mp3","assets/marker.svg","ui/Toolbar.jsx","ui/Button.jsx","chart/storage.js","ui/Dialog.jsx","ui/Menus.jsx","tools/useEvent.js","ui/Control.jsx","ui/Carousel.jsx","ui/Switch.jsx","ui/Controls.jsx","chart/useTool.js","chart/useScore.js","chart/useResettableState.js","chart/useChart.js","utils.js","chart/Score.jsx","chart/Bars.jsx","chart/Notes.jsx","tools/useDrag.js","chart/Thumb.jsx","tools/useFrame.js","chart/Stencil.jsx","chart/Timers.jsx","chart/ThumbTimers.jsx","tools/Player.jsx","tools/SoundFX.jsx","tools/Progress.jsx","tools/PlayerCaret.jsx","tools/Markers.jsx","tools/usePen.js","tools/Placement.jsx","tools/Divisions.jsx","tools/PlacementCaret.jsx","tools/Modification.jsx","tools/PlaceTimer.jsx","tools/Select.jsx","chart/Chart.jsx","Loading.jsx","App.js","serviceWorker.js","index.js"],"names":["module","exports","useStyles","makeStyles","root","position","display","flexDirection","justifyContent","width","Toolbar","children","classes","className","height","cursor","userSelect","content","pointerEvents","left","top","right","bottom","border","borderWidth","alignItems","selected","backgroundColor","icon","alt","color","fontFamily","fontWeight","fontSize","marginBottom","Button","onClick","props","useState","ctrl","setCtrl","useEffect","onKeyDown","e","key","onKeyUp","window","addEventListener","removeEventListener","classNames","src","emptyScore","type","cmd","beat","bpm","save","data","localStorage","setItem","JSON","stringify","createSubmit","timers","notes","convert","score","forEach","push","lane","note","sort","submit","newTimers","newNotes","setTimeout","console","log","useDialog","opened","setOpened","resolve","setResolve","reject","setReject","open","useCallback","Promise","finally","useMemo","overlay","zIndex","sheetContainer","sheet","padding","horizontal","marginTop","cell","title","lineHeight","input","outline","paddingLeft","text","paddingRight","button","DialogContext","createContext","Dialog","dialog","form","useForm","context","onSubmit","handleSubmit","Provider","value","CSSTransition","in","timeout","mountOnEnter","unmountOnExit","Sheet","useContext","Horizontal","Cell","el","Element","innerRef","rest","classes2","ref","Title","Input","inheritClasses","register","Text","Cancel","cancel","Submit","url","marginRight","Menus","setScore","musicURL","setMusicURL","deleteDialog","openDeleteDialog","a","musicURLDialog","openMusicURLDialog","hamburger","deleteIcon","album","name","defaultValue","exportIcon","importIcon","settings","useEvent","fn","wrappedFn","container","Control","code","setCode","matchCode","index","childrenCount","Children","count","margin","Math","min","style","Carousel","state","setState","states","icons","ind","indexOf","next","length","nonactive","opacity","Switch","Controls","music","follow","setFollow","setDivision","currentBPM","setCurrentBPM","paused","setPausedRaw","setPaused","pause","play","updatePaused","playbackRate","setPlaybackRateRaw","setPlaybackRate","updatePlaybackRate","setD1","setD2","setD3","setD4","setD6","setD8","bpmDialog","openBPMDialog","select","single","slide1","slide2","flick","timer","bars","d1","d2","d3","d4","d6","d8","player","x05","x10","x15","x20","followIcon","useTool","useScore","duration","time2Timers","containerEl","setContainerEl","innerEl","setInnerEl","inflate","getBoundingClientRect","x","y","clientY","clientX","time","le","startTime","ratioTop","keepInView","viewTop","innerHeight","scrollTop","deflate","useResettableState","initial","setValue","division","scale","progressOffset","scrollSpeed","thumbScrollSpeed","scaleSpeed","minScale","maxScale","useChart","initialTimers","res","createTree","insert","initialNotes","setTimers","setNotes","markers","setMarkers","useAutoSave","ranges","lastTime","it1","begin","it2","at","hasNext","beat1","beat2","time1","time2","end","time2Notes","time2Markers","marker","setScale","quantize","rangeStartTime","rangeStartBeat","rangeEndBeat","gt","quantizedBeat","round","quantizedTime","delta","abs","countNotes","valid","findNotePure","it","ge","findNote","forEachNote","visit","filter","forEachGroup","matchNotePure","threshold","minBeat","startBeat","minDist","minLane","NaN","noteBeat","noteLane","dist","pow","isNaN","matchNote","normalizeWheel","event","sX","sY","pX","pY","detail","wheelDelta","wheelDeltaY","wheelDeltaX","axis","HORIZONTAL_AXIS","deltaY","deltaX","deltaMode","spinX","spinY","pixelX","pixelY","overflow","inner","Score","onWheel","nativeEvent","ctrlKey","ratio","newScale","newHeight","newScroll","sqrt","prevent","stopPropagation","preventDefault","passive","onContextMenu","lanes","sideLane","borderRight","marginLeft","middleLane","bar","borderBottom","major","thumb","Bars","deltaBeat","borderRadius","visibility","transform","boxSizing","focusable","focus","slide","borderLeft","borderTop","middle","tapLine","snake","middleSelected","Note","start","full","startsWith","selecting","cross","Snake","x0","x1","y0","y1","viewBox","preserveAspectRatio","fill","strokeWidth","points","Notes","snakes","pos","lastY","lastLane","tapLines","maxLane","max","noteEls","useDrag","onDragStart","onDrag","onDragEnd","dragging","shift","lestX","startX","startY","onMouseDown","shiftKey","lastX","onMouseMove","steps","i","t","onMouseUp","Thumb","thumbEl","setThumbEl","updateScroll","viewSize","viewHeight","newTop","useFrame","requestAnimationFrame","onFrameWrapped","stencil","Stencil","upperEl","setUpperEl","lowerEl","setLowerEl","updateStencil","willChange","lastBPM","paddingBottom","Timer","observer","setEl","observe","unobserve","Timers","onIntersect","entries","boundingClientRect","target","IntersectionObserver","disconnect","timerEls","lastBPMEl","setLastBPMEl","updateTimerEls","bottomTime","em","nextTime","innerHTML","ThumbTimers","Player","onSpace","_","setMyCode","handleKeys","onKeyEvent","isDisabled","SoundFX","tap","Howl","tapFX","flickFX","lastTimeRef","useRef","onFrame","hasTap","hasFlick","current","currentTime","Progress","progressEl","setProgressEl","updateProgress","noscroll","progress","progressPosition","progressRatio","seekProgress","notesCounter","PlayerCaret","caretEl","setCaretEl","notesCounterEl","setNotesCounterEl","updateCaret","transition","Markers","getAttribute","remove","markerEls","data-beat","data-time","onMarker","find","usePen","prefix","useRemove","quantizeThreshold","snapThreshold","notesRef","codeRef","overriddenSetNotes","quantizedLane","matched","matchedLane","placeNote","singleClick","substring","toUpperCase","notePos","update","foundTail","lt","prev","Placement","setSingle","setSlideA","setSlideB","Divisions","setDivision1","setDivision2","setDivision3","setDivision4","setDivision6","setDivision8","PlacementCaret","toFixed","modifyNote","Modification","setFlick","PlaceTimer","dragArea","dragLine","Select","setSelect","click","move","matchedTime","startIndex","setDragArea","setDragLine","x2","y2","setAttribute","clearSelectionPure","toggleNotesPure","endBeat","startLane","endLane","tmpSource","newIt","tmpNotes","deltaLane","newBeat","newLane","lane1","lane2","stroke","Chart","chartParams","scoreParams","toolParams","params","Loading","App","initialScore","item","getItem","parse","load","Audio","musicLoaded","setMusicLoaded","onDurationChange","onEmptied","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.b9ac029d.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/cancel.f8a7f639.svg\";","module.exports = __webpack_public_path__ + \"static/media/submit.4360bbde.svg\";","module.exports = __webpack_public_path__ + \"static/media/settings.348c169b.svg\";","module.exports = __webpack_public_path__ + \"static/media/hamburger.833119f1.svg\";","module.exports = __webpack_public_path__ + \"static/media/delete.5075b33e.svg\";","module.exports = __webpack_public_path__ + \"static/media/album.5f063155.svg\";","module.exports = __webpack_public_path__ + \"static/media/export.2a28091b.svg\";","module.exports = __webpack_public_path__ + \"static/media/import.f76106f8.svg\";","module.exports = __webpack_public_path__ + \"static/media/select.c1d3a7c6.svg\";","module.exports = __webpack_public_path__ + \"static/media/single.710e706e.svg\";","module.exports = __webpack_public_path__ + \"static/media/slide-1.9c55945b.svg\";","module.exports = __webpack_public_path__ + \"static/media/slide-2.e739354f.svg\";","module.exports = __webpack_public_path__ + \"static/media/flick.7b4a2e40.svg\";","module.exports = __webpack_public_path__ + \"static/media/timer.593d700f.svg\";","module.exports = __webpack_public_path__ + \"static/media/player.07060722.svg\";","module.exports = __webpack_public_path__ + \"static/media/pause.9cf9cdb6.svg\";","module.exports = __webpack_public_path__ + \"static/media/play.aa3ead50.svg\";","module.exports = __webpack_public_path__ + \"static/media/x05.535eb49c.svg\";","module.exports = __webpack_public_path__ + \"static/media/x10.bedeac54.svg\";","module.exports = __webpack_public_path__ + \"static/media/x15.b4cf543a.svg\";","module.exports = __webpack_public_path__ + \"static/media/x20.f8430c66.svg\";","module.exports = __webpack_public_path__ + \"static/media/follow.f06e8e66.svg\";","module.exports = __webpack_public_path__ + \"static/media/bars.04bc19f8.svg\";","module.exports = __webpack_public_path__ + \"static/media/d1.d440bb37.svg\";","module.exports = __webpack_public_path__ + \"static/media/d2.70994b05.svg\";","module.exports = __webpack_public_path__ + \"static/media/d3.bed3323c.svg\";","module.exports = __webpack_public_path__ + \"static/media/d4.9e36ff58.svg\";","module.exports = __webpack_public_path__ + \"static/media/d6.0d8fa81a.svg\";","module.exports = __webpack_public_path__ + \"static/media/d8.c7296f0f.svg\";","module.exports = __webpack_public_path__ + \"static/media/focus.b3b0efea.svg\";","module.exports = __webpack_public_path__ + \"static/media/cross.53b51969.svg\";","module.exports = __webpack_public_path__ + \"static/media/flick.190f0e5d.mp3\";","module.exports = __webpack_public_path__ + \"static/media/tap.343a1b11.mp3\";","module.exports = __webpack_public_path__ + \"static/media/marker.0fccf3e6.svg\";","import React from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'flex-start',\n        width: '2em',\n    },\n});\n\nfunction Toolbar({ children }) {\n    const classes = useStyles();\n    return (\n        <div className={classes.root}>\n            {children}\n        </div>\n    );\n}\n\nexport default Toolbar;\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport classNames from 'classnames';\n\nconst useStyles = makeStyles({\n    root: {\n        width: '2em',\n        height: '2em',\n        cursor: 'pointer',\n        userSelect: 'none',\n        position: 'relative',\n        '&:after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            pointerEvents: 'none',\n            left: 0,\n            top: 0,\n            right: 0,\n            bottom: 0,\n            border: '0px solid black',\n        },\n        '&:hover:after': {\n            borderWidth: 5,\n        },\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    selected: {\n        backgroundColor: 'rgba(0, 0, 0, 0.06)',\n    },\n    icon: {\n        pointerEvents: 'none',\n        height: '2em',\n    },\n    alt: {\n        position: 'absolute',\n        left: '100%',\n        top: `${100 / 3}%`,\n        height: `${100 / 3}%`,\n        width: `${100 / 3}%`,\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        backgroundColor: '#000',\n        color: '#FFF',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n        fontSize: '0.6em',\n        '& div': {\n            marginBottom: 0,\n        }\n    },\n});\n\nfunction Button({ selected, onClick, alt, icon, children, ...props }) {\n    const classes = useStyles(props);\n    const [ctrl, setCtrl] = useState(false);\n    useEffect(() => {\n        const onKeyDown = (e) => { if (e.key === 'Control') setCtrl(true); };\n        const onKeyUp = (e) => { if (e.key === 'Control') setCtrl(false); };\n        window.addEventListener('keydown', onKeyDown);\n        window.addEventListener('keyup', onKeyUp);\n        return () => {\n            window.removeEventListener('keydown', onKeyDown);\n            window.removeEventListener('keyup', onKeyUp);\n        };\n    }, []);\n    return (\n        <div\n            className={classNames(classes.root, { [classes.selected]: selected })}\n            onClick={onClick}>\n            {icon && <img src={icon} alt=\"\" className={classes.icon}/>}\n            {children}\n            {ctrl && alt && <div className={classes.alt}>\n                <div>{alt}</div>\n            </div>}\n        </div>\n    );\n}\n\nexport default Button;\n","import { useEffect, useMemo } from \"react\";\n\nconst emptyScore = [{\n    type: 'System',\n    cmd: 'BPM',\n    beat: 0,\n    bpm: 120,\n}];\n\nconst load = () => {\n    const item = localStorage.getItem('score');\n    if (item === null) return emptyScore;\n    else return JSON.parse(item);\n};\n\nconst save = (data) => {\n    localStorage.setItem('score', JSON.stringify(data));\n};\n\nconst createSubmit = () => {\n    let timers = null, notes = null;\n    const convert = (timers, notes) => {\n        const score = [];\n        timers.forEach((beat, { bpm }) => {\n            score.push({\n                type: 'System',\n                cmd: 'BPM',\n                beat,\n                bpm,\n            });\n        });\n        notes.forEach((beat, { lane, ...note }) => {\n            score.push({\n                type: 'Note',\n                beat,\n                ...note,\n                lane: lane + 1, // bestdori uses lanes starting from 1\n            });\n        });\n        score.sort(({ beat: b1 }, { beat: b2 }) => b1 - b2);\n        return score;\n    };\n    const submit = (newTimers, newNotes) => {\n        timers = newTimers;\n        notes = newNotes;\n        setTimeout(() => {\n            // check if we're the newest version, if not, return,\n            // since another newer version is on the way.\n            if (timers !== newTimers || notes !== newNotes) return; \n            save(convert(newTimers, newNotes));\n            console.log('Score saved!');\n        }, 5000); // saver after 5 seconds of inactivity\n    };\n    const saveImmediately = () => {\n        save(convert(timers, notes));\n    };\n    return { submit, save: saveImmediately };\n}\n\nconst useAutoSave = ({ timers, notes }) => {\n    const { submit, save } = useMemo(createSubmit, []); // does not change\n    useEffect(() => {\n        window.addEventListener('beforeunload', save);\n        return () => window.removeEventListener('beforeunload', save);\n    }, [save]);\n    useEffect(() => {\n        submit(timers, notes);\n    }, [notes, submit, timers]);\n};\n\nexport { emptyScore, load, save, useAutoSave };\n","import React, { useState, useCallback, useMemo, createContext, useContext } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport { CSSTransition } from 'react-transition-group';\nimport { useForm } from 'react-hook-form';\nimport cancel from '../assets/cancel.svg';\nimport submit from '../assets/submit.svg';\n\nconst useDialog = () => {\n    const [opened, setOpened] = useState(false);\n    const [resolve, setResolve] = useState(null);\n    const [reject, setReject] = useState(null);\n    const open = useCallback(() => {\n        setOpened(true);\n        return new Promise((resolve, reject) => {\n            setResolve(() => resolve);\n            setReject(() => reject);\n        }).finally(() => {\n            setOpened(false);\n            setResolve(null);\n            setReject(null);\n        });\n    }, []);\n    const res = useMemo(() => ({\n        opened, resolve, reject, open,\n    }), [open, opened, reject, resolve]);\n    return res;\n};\n\nconst useStyles = makeStyles({\n    overlay: {\n        position: 'fixed',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.5)',\n        zIndex: 5,\n    },\n    sheetContainer: {\n        position: 'fixed',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 6,\n        pointerEvents: 'none',\n    },\n    sheet: {\n        backgroundColor: '#FFF',\n        padding: '1em',\n        pointerEvents: 'auto',\n    },\n    horizontal: {\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n        marginTop: -10,\n        marginBottom: -10,\n    },\n    cell: {\n        marginTop: 10,\n        marginBottom: 10,\n        display: 'block',\n    },\n    title: {\n        fontWeight: 'bold',\n        fontSize: `${40 / 60}em`,\n        lineHeight: `${50 / 40}em`,\n        width: `${480 / 40}em`,\n    },\n    input: {\n        outline: 'none',\n        border: 'none',\n        backgroundColor: '#000',\n        color: '#FFF',\n        fontSize: `${34 / 60}em`,\n        lineHeight: `${50 / 34}em`,\n        height: `${50 / 34}em`,\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n        paddingLeft: `${10 / 34}em`,\n        width: `${320 / 34}em`,\n    },\n    text: {\n        fontSize: `${32 / 60}em`,\n        lineHeight: `${50 / 32}em`,\n        height: `${50 / 32}em`,\n        fontWeight: 'normal',\n        paddingRight: `${60 / 32}em`,\n    },\n    button: {\n        width: `${120 / 60}em`,\n        height: `${50 / 60}em`,\n        backgroundColor: 'rgba(0, 0, 0, 0.06)',\n        display: 'flex',\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        cursor: 'pointer',\n        position: 'relative',\n        '&:hover::after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            left: 0,\n            top: 0,\n            right: 0,\n            bottom: 0,\n            backgroundColor: 'rgba(0, 0, 0, 0.14)',\n        },\n        border: 'none',\n        outline: 'none',\n        fontSize: 'inherit',\n    },\n    icon: {\n        height: '100%',\n    },\n});\n\nconst DialogContext = createContext(null);\n\nfunction Dialog({ dialog, children }) {\n    const classes = useStyles();\n    const onClick = useCallback(() => {\n        if (dialog.reject) dialog.reject();\n    }, [dialog]);\n    const form = useForm();\n    const context = useMemo(() => ({ ...dialog, form }), [dialog, form]);\n    \n    return (\n        <form onSubmit={form.handleSubmit(dialog.resolve)}>\n            <DialogContext.Provider value={context}>\n                <CSSTransition\n                    in={dialog.opened}\n                    timeout={120}\n                    classNames=\"fade\"\n                    mountOnEnter\n                    unmountOnExit>\n                    <div className={classes.overlay} onClick={onClick}/>\n                </CSSTransition>\n                {children}\n            </DialogContext.Provider>\n        </form>\n    );\n}\n\nfunction Sheet({ children }) {\n    const classes = useStyles();\n    const { opened } = useContext(DialogContext);\n    return (\n        <CSSTransition\n            in={opened}\n            timeout={120}\n            classNames=\"scale\"\n            mountOnEnter\n            unmountOnExit>\n            <div className={classes.sheetContainer}>\n                <div className={classes.sheet}>\n                    {children}\n                </div>\n            </div>\n        </CSSTransition>\n    );\n}\n\nfunction Horizontal({ children }) {\n    const classes = useStyles();\n    return (\n        <div className={classes.horizontal}>\n            {children}\n        </div>\n    );\n}\n\nfunction Cell({ el: Element = 'div', children, classes, innerRef, ...rest }) {\n    const classes2 = useStyles({ classes });\n    return (\n        <Element className={classes2.cell} ref={innerRef} {...rest}>\n            {children}\n        </Element>\n    );\n}\n\nfunction Title({ children }) {\n    const classes = useStyles();\n    return (\n        <Cell classes={{ cell: classes.title }}>\n            {children}\n        </Cell>\n    );\n}\n\nfunction Input({ classes: inheritClasses, ...props }) {\n    const classes = useStyles({ classes: inheritClasses });\n    const { form: { register } } = useContext(DialogContext);\n    console.log(classes.input);\n    return (\n        <Cell\n            el=\"input\"\n            classes={{ cell: classes.input }}\n            innerRef={register}\n            {...props}/>\n    );\n}\n\nfunction Text({ children }) {\n    const classes = useStyles();\n    return (\n        <Cell classes={{ cell: classes.text }}>\n            {children}\n        </Cell>\n    );\n}\n\nfunction Cancel(props) {\n    const classes = useStyles();\n    const { reject } = useContext(DialogContext);\n    return (\n        <Cell classes={{ cell: classes.button }} onClick={reject} {...props}>\n            <img className={classes.icon} alt=\"Cancel\" src={cancel}/>\n        </Cell>\n    );\n}\n\nfunction Submit(props) {\n    const classes = useStyles();\n    return (\n        <Cell el=\"button\" type=\"submit\" classes={{ cell: classes.button }} {...props}>\n            <img className={classes.icon} alt=\"Submit\" src={submit}/>\n        </Cell>\n    );\n}\n\nexport { useDialog, Dialog, Sheet, Horizontal, Cell, Title, Input, Text, Cancel, Submit };\n","import React, { useCallback } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport Toolbar from './Toolbar';\nimport Button from './Button';\nimport { emptyScore } from '../chart/storage';\nimport { Dialog, useDialog, Sheet, Horizontal, Input, Title, Text, Cancel, Submit } from './Dialog';\n\nimport settings from '../assets/settings.svg';\nimport hamburger from '../assets/hamburger.svg';\nimport deleteIcon from '../assets/delete.svg';\nimport album from '../assets/album.svg';\nimport exportIcon from '../assets/export.svg';\nimport importIcon from '../assets/import.svg';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        fontSize: 40,\n    },\n    bpm: {\n        fontSize: '0.8em',\n        lineHeight: 1,\n        color: '#000',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n    },\n    url: {\n        width: `${560 / 34}em`,\n        marginRight: `${80 / 34}em`,\n    },\n});\n\nfunction Menus({ setScore, musicURL, setMusicURL }) {\n    const classes = useStyles();\n    const deleteDialog = useDialog();\n    const openDeleteDialog = useCallback(async () => {\n        try {\n            await deleteDialog.open();\n            // score state in App.js saves the initial score, which\n            // resets the chart every time its *reference* changes.\n            // here, we set score to a copy of the emptyScore object,\n            // otherwise the second reset will not be effective\n            setScore([...emptyScore]);\n        } catch (e) {\n            // do nothing\n        }\n    }, [deleteDialog, setScore]);\n    const musicURLDialog = useDialog();\n    const openMusicURLDialog = useCallback(async () => {\n        try {\n            const { url } = await musicURLDialog.open();\n            setMusicURL(url);\n        } catch (e) {\n            // do nothing\n        }\n    }, [musicURLDialog, setMusicURL]);\n    return (\n        <div className={classes.root}>\n            <Toolbar>\n                <Button icon={hamburger}/>\n                <Button icon={deleteIcon} onClick={openDeleteDialog}/>\n                <Dialog dialog={deleteDialog}>\n                    <Sheet>\n                        <Horizontal>\n                            <div>\n                                <Title>删除谱面</Title>\n                                <Text>确认删除谱面？此操作无法恢复。</Text>\n                            </div>\n                            <div>\n                                <Cancel/>\n                                <Submit/>\n                            </div>\n                        </Horizontal>\n                    </Sheet>\n                </Dialog>\n                <Button icon={album} onClick={openMusicURLDialog}/>\n                <Dialog dialog={musicURLDialog}>\n                    <Sheet>\n                        <Horizontal>\n                            <div>\n                                <Title>音频地址</Title>\n                                <Input name=\"url\" defaultValue={musicURL} classes={{ input: classes.url }}/>\n                            </div>\n                            <div>\n                                <Cancel/>\n                                <Submit/>\n                            </div>\n                        </Horizontal>\n                    </Sheet>\n                </Dialog>\n                <Button icon={exportIcon}/>\n                <Button icon={importIcon}/>\n                <Button icon={settings}/>\n            </Toolbar>\n        </div>\n    );\n}\n\nexport default Menus;\n","import { useEffect } from \"react\";\n\nconst useEvent = (el, name, fn) => {\n    useEffect(() => {\n        if (!el) return;\n        let valid = true;\n        const wrappedFn = (e) => {\n            if (!valid) return;\n            if (fn) fn(e);\n        }\n        el.addEventListener(name, wrappedFn);\n        return () => el.removeEventListener(name, wrappedFn);\n    }, [el, fn, name]);\n}\n\nexport default useEvent;\n","import React, { useCallback, Children } from 'react';\nimport Button from './Button';\nimport { makeStyles } from '@material-ui/styles';\nimport Toolbar from './Toolbar';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n    },\n    container: {\n        position: 'absolute',\n        left: '100%',\n        top: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.06)',\n    },\n});\n\nfunction Control({ code, setCode, matchCode, children, index, ...rest }) {\n    const classes = useStyles();\n    const onClick = useCallback(() => setCode(matchCode), [matchCode, setCode]);\n    const selected = code === matchCode;\n    const childrenCount = Children.count(children);\n    const margin = Math.min(childrenCount - 1, index);\n    return (\n        <div className={classes.root}>\n            <Button onClick={onClick} selected={selected} {...rest}/>\n            {selected && <div className={classes.container} style={{ top: `${-2 * margin}em` }}>\n                <Toolbar>\n                    {children}\n                </Toolbar>\n            </div>}\n        </div>\n    );\n}\n\nexport default Control;\n","import React, { useCallback } from 'react';\nimport Button from './Button';\n\nfunction Carousel({ state, setState, states, icons, ...rest }) {\n    const ind = states.indexOf(state);\n    const onClick = useCallback(() => {\n        const next = states[(ind + 1) % states.length];\n        setState(next);\n    }, [ind, setState, states]);\n    return (\n        <Button onClick={onClick} selected={false} icon={icons[ind]} {...rest}/>\n    );\n}\n\nexport default Carousel;\n","import React, { useCallback } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport classNames from 'classnames';\nimport Button from './Button';\n\nconst useStyles = makeStyles({\n    nonactive: {\n        opacity: 0.35,\n    },\n});\n\nfunction Switch({ state, setState, icon }) {\n    const classes = useStyles();\n    const onClick = useCallback(() => setState(state => !state), [setState]);\n    return (\n        <Button\n            onClick={onClick}\n            selected={false}\n            icon={icon}\n            classes={{ icon: classNames({ [classes.nonactive]: !state }) }}/>\n    );\n}\n\nexport default Switch;\n","import React, { useCallback, useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport Control from './Control';\nimport Toolbar from './Toolbar';\nimport Carousel from './Carousel';\nimport Switch from './Switch';\nimport Button from './Button';\nimport { Dialog, useDialog, Sheet, Horizontal, Title, Input, Cancel, Submit } from './Dialog';\n\nimport select from '../assets/select.svg';\nimport single from '../assets/single.svg';\nimport slide1 from '../assets/slide-1.svg';\nimport slide2 from '../assets/slide-2.svg';\nimport flick from '../assets/flick.svg';\nimport timer from '../assets/timer.svg';\nimport player from '../assets/player.svg';\nimport pause from '../assets/pause.svg';\nimport play from '../assets/play.svg';\nimport x05 from '../assets/x05.svg';\nimport x10 from '../assets/x10.svg';\nimport x15 from '../assets/x15.svg';\nimport x20 from '../assets/x20.svg';\nimport followIcon from '../assets/follow.svg';\nimport bars from '../assets/bars.svg';\nimport d1 from '../assets/d1.svg';\nimport d2 from '../assets/d2.svg';\nimport d3 from '../assets/d3.svg';\nimport d4 from '../assets/d4.svg';\nimport d6 from '../assets/d6.svg';\nimport d8 from '../assets/d8.svg';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        fontSize: 40,\n    },\n    bpm: {\n        fontSize: '0.8em',\n        lineHeight: 1,\n        color: '#000',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n    },\n});\n\nfunction Controls({\n    music, follow, setFollow, setDivision, code, setCode, currentBPM, setCurrentBPM,\n}) {\n    const classes = useStyles();\n    const [paused, setPausedRaw] = useState(music.paused);\n    const setPaused = useCallback((paused) => {\n        if (paused) music.pause();\n        else music.play();\n    }, [music]);\n    useEffect(() => {\n        const updatePaused = () => setPausedRaw(music.paused);\n        music.addEventListener('play', updatePaused);\n        music.addEventListener('pause', updatePaused);\n        return () => {\n            music.removeEventListener('play', updatePaused);\n            music.removeEventListener('pause', updatePaused);\n        };\n    }, [music]);\n    const [playbackRate, setPlaybackRateRaw] = useState(music.playbackRate);\n    const setPlaybackRate = useCallback((playbackRate) => {\n        music.playbackRate = playbackRate;\n    }, [music]);\n    useEffect(() => {\n        const updatePlaybackRate = () => setPlaybackRateRaw(music.playbackRate);\n        music.addEventListener('ratechange', updatePlaybackRate);\n        return () => music.removeEventListener('ratechange', updatePlaybackRate);\n    });\n    const setD1 = useCallback(() => setDivision(1), [setDivision]);\n    const setD2 = useCallback(() => setDivision(2), [setDivision]);\n    const setD3 = useCallback(() => setDivision(3), [setDivision]);\n    const setD4 = useCallback(() => setDivision(4), [setDivision]);\n    const setD6 = useCallback(() => setDivision(6), [setDivision]);\n    const setD8 = useCallback(() => setDivision(8), [setDivision]);\n    const bpmDialog = useDialog();\n    const openBPMDialog = useCallback(async () => {\n        try {\n            const { bpm } = await bpmDialog.open();\n            setCurrentBPM(bpm);\n        } catch (e) {\n            // do nothing\n        }\n    }, [bpmDialog, setCurrentBPM]);\n    return (\n        <div className={classes.root}>\n            <Toolbar>\n                <Control code={code} setCode={setCode} alt=\"E\" index={0} matchCode=\"select\" icon={select}/>\n                <Control code={code} setCode={setCode} alt=\"F\" index={2} matchCode=\"placement/single\" icon={single}/>\n                <Control code={code} setCode={setCode} alt=\"S\" index={3} matchCode=\"placement/slide-a\" icon={slide1}/>\n                <Control code={code} setCode={setCode} alt=\"D\" index={4} matchCode=\"placement/slide-b\" icon={slide2}/>\n                <Control code={code} setCode={setCode} alt=\"W\" index={5} matchCode=\"modification/flick\" icon={flick}/>\n                <Control code={code} setCode={setCode} alt=\"A\" index={6} matchCode=\"timer\" icon={timer}>\n                    <Button onClick={openBPMDialog}>\n                        <div className={classes.bpm}>{currentBPM}</div>\n                    </Button>\n                </Control>\n                <Dialog dialog={bpmDialog}>\n                    <Sheet>\n                        <Horizontal>\n                            <div>\n                                <Title>节奏数值</Title>\n                                <Input name=\"bpm\" defaultValue={currentBPM}/>\n                            </div>\n                            <div>\n                                <Cancel/>\n                                <Submit/>\n                            </div>\n                        </Horizontal>\n                    </Sheet>\n                </Dialog>\n                <Control code={code} setCode={setCode} index={7} matchCode=\"bars\" icon={bars}>\n                    <Button alt=\"1\" onClick={setD1} icon={d1}/>\n                    <Button alt=\"2\" onClick={setD2} icon={d2}/>\n                    <Button alt=\"3\" onClick={setD3} icon={d3}/>\n                    <Button alt=\"4\" onClick={setD4} icon={d4}/>\n                    <Button alt=\"6\" onClick={setD6} icon={d6}/>\n                    <Button alt=\"8\" onClick={setD8} icon={d8}/>\n                </Control>\n                <Control code={code} setCode={setCode} alt=\"R\" index={8} matchCode=\"player\" icon={player}>\n                    <Carousel\n                        state={paused}\n                        setState={setPaused}\n                        states={[false, true]}\n                        icons={[pause, play]}/>\n                    <Carousel\n                        state={playbackRate}\n                        setState={setPlaybackRate}\n                        states={[0.5, 1.0, 1.5, 2.0]}\n                        icons={[x05, x10, x15, x20]}/>\n                    <Switch\n                        state={follow}\n                        setState={setFollow}\n                        icon={followIcon}/>\n                </Control>\n            </Toolbar>\n        </div>\n    );\n}\n\nexport default Controls;\n","import { useState } from \"react\"\n\nconst useTool = () => {\n    const [code, setCode] = useState('select');\n    return { code, setCode };\n};\n\nexport default useTool;\n","import { useState, useCallback } from 'react';\n\nconst useScore = ({ music: { duration }, time2Timers }) => {\n    const [containerEl, setContainerEl] = useState(null);\n    const [innerEl, setInnerEl] = useState(null);\n\n    const inflate = useCallback((e) => {\n        const { x, y, height, width } = innerEl.getBoundingClientRect();\n        const top = e.clientY - y;\n        const left = e.clientX - x;\n        const time = (1 - top / height) * duration;\n        const { key: startTime, value: { beat: startBeat, bpm } } = time2Timers.le(time);\n        const beat = startBeat + (time - startTime) / 60 * bpm;\n        const lane = left / width * 11 - 2.5;\n        const ratioTop = top / height;\n        return { top, left, time, beat, lane, ratioTop };\n    }, [duration, innerEl, time2Timers]);\n\n    const keepInView = useCallback((position) => {\n        const height = innerEl.getBoundingClientRect().height;\n        let viewTop = position - window.innerHeight;\n        if (viewTop < 0) viewTop = 0;\n        else if (position > height) viewTop = height - window.innerHeight;\n        if (containerEl) containerEl.scrollTop = viewTop;\n    }, [containerEl, innerEl]);\n\n    const deflate = useCallback(({ time, lane }) => {\n        const { x, y, width, height } = innerEl.getBoundingClientRect();\n        return {\n            x: x + (lane + 2.5) / 11 * width,\n            y: y + height * (1 - time / duration),\n        };\n    }, [duration, innerEl]);\n    \n    const params = {\n        containerEl, setContainerEl, innerEl, setInnerEl,\n        inflate, keepInView, deflate,\n    };\n\n    return params;\n};\n\nexport default useScore;\n","import { useState, useEffect } from \"react\"\n\nconst useResettableState = (initial) => {\n    const [value, setValue] = useState(initial);\n    useEffect(() => {\n        setValue(initial);\n    }, [initial]);\n    return [value, setValue];\n}\n\nexport default useResettableState;\n","import { useMemo, useState, useCallback } from 'react';\nimport createTree from 'functional-red-black-tree';\nimport { useAutoSave } from './storage';\nimport useResettableState from './useResettableState';\n\nconst initial = {\n    // initial values\n    follow: false,\n    division: 2,\n    scale: 600,\n    bpm: 120,\n\n    // other settings\n    progressOffset: 180,\n    scrollSpeed: 0.03,\n    thumbScrollSpeed: 0.027,\n    scaleSpeed: 0.0005,\n    minScale: 50,\n    maxScale: 2000,\n};\n\nfunction useChart({ music, score }) {\n    const initialTimers = useMemo(() => {\n        let res = createTree();\n        for (const { type, cmd, beat, bpm } of score) {\n            if (type !== 'System' || cmd !== 'BPM') continue;\n            res = res.insert(beat, { bpm });\n        }\n        return res;\n    }, [score]);\n    const initialNotes = useMemo(() => {\n        let res = createTree();\n        for (const { type, beat, lane, ...rest } of score) {\n            if (type !== 'Note') continue;\n            res = res.insert(beat, { ...rest, lane: lane - 1 });\n        }\n        return res;\n    }, [score]);\n    const [timers, setTimers] = useResettableState(initialTimers);\n    const [notes, setNotes] = useResettableState(initialNotes);\n    const [markers, setMarkers] = useState(createTree());\n    useAutoSave({ timers, notes });\n    \n    const ranges = useMemo(() => {\n        const res = [];\n        let lastTime = 0;\n        for (let it1 = timers.begin, it2 = timers.at(1); it1.hasNext; it1.next(), it2.next()) {\n            const { key: beat1, value: { bpm } } = it1, { key: beat2 } = it2;\n            const time1 = lastTime, time2 = lastTime + (beat2 - beat1) / bpm * 60;\n            res.push({ time1, time2, beat1, beat2, bpm });\n            lastTime = time2;\n        }\n        const { key: beat1, value: { bpm } } = timers.end;\n        res.push({\n            time1: lastTime, time2: music.duration,\n            beat1, beat2: (music.duration - lastTime) / 60 * bpm + beat1, bpm\n        });\n        return res;\n    }, [timers, music]);\n    const time2Timers = useMemo(() => {\n        let res = createTree();\n        for (const { time1: time, beat1: beat, bpm } of ranges) {\n            res = res.insert(time, { beat, bpm });\n        }\n        res = res.insert(ranges[ranges.length - 1].time2, { beat: ranges[ranges.length - 1].beat2 });\n        return res;\n    }, [ranges]);\n    const time2Notes = useMemo(() => {\n        let res = createTree();\n        for (const { beat1, beat2, time1, bpm } of ranges) {\n            // eslint-disable-next-line no-loop-func\n            notes.forEach((beat, note) => {\n                const time = (beat - beat1) / bpm * 60 + time1;\n                res = res.insert(time, { ...note, beat });\n            }, beat1, beat2);\n        }\n        return res;\n    }, [ranges, notes]);\n    const time2Markers = useMemo(() => {\n        let res = createTree();\n        for (const { beat1, beat2, time1, bpm } of ranges) {\n            // eslint-disable-next-line no-loop-func\n            markers.forEach((beat, marker) => {\n                const time = (beat - beat1) / bpm * 60 + time1;\n                res = res.insert(time, { ...marker, beat });\n            }, beat1, beat2);\n        }\n        return res;\n    }, [ranges, markers]);\n\n    const [division, setDivision] = useState(initial.division);\n    const [follow, setFollow] = useState(initial.follow);\n    const [scale, setScale] = useState(initial.scale);\n\n    const quantize = useCallback((time) => {\n        const { key: rangeStartTime, value: { bpm, beat: rangeStartBeat } } = time2Timers.le(time);\n        const { value: { beat: rangeEndBeat } } = time2Timers.gt(time);\n        let quantizedBeat = rangeStartBeat + Math.round(\n            (time - rangeStartTime) / 60 * bpm * division\n        ) / division;\n        // if quantized result exceeds the previous range, it falls on the beginning\n        // of the next range instead\n        if (quantizedBeat > rangeEndBeat) quantizedBeat = rangeEndBeat;\n        const quantizedTime = rangeStartTime + (quantizedBeat - rangeStartBeat) / bpm * 60;\n        const delta = Math.abs(quantizedTime - time) / 60 * bpm * division;\n        return { beat: quantizedBeat, time: quantizedTime, bpm, delta };\n    }, [division, time2Timers]);\n    const countNotes = useCallback((time) => {\n        const { valid, index } = time2Notes.le(time);\n        // an invalid iterator with index = size - 1 is returned if the\n        // key is smaller than the smallest key. index + 1 since we want to\n        // disolay the number of notes *including* this one.\n        return valid ? index + 1 : 0;\n    }, [time2Notes]);\n    const findNotePure = useCallback((notes, beat, lane) => {\n        for (const it = notes.ge(beat); it.valid && it.key === beat; it.next()) {\n            if (it.value.lane !== lane) continue;\n            return it;\n        }\n        return null;\n    }, []);\n    const findNote = useCallback((beat, lane) => findNotePure(notes, beat, lane), [findNotePure, notes]);\n    const forEachNote = useCallback((visit, filter) => {\n        time2Notes.forEach((time, note) => {\n            if (filter) {\n                for (const key in filter) {\n                    if (filter[key] !== note[key]) return;\n                }\n                visit(time, note);\n            }\n        });\n    }, [time2Notes]);\n    const forEachGroup = useCallback((visit) => {\n        for (let it = time2Notes.begin; it.valid;) {\n            const { key: time } = it;\n            const notes = [];\n            do {\n                notes.push(it.value);\n                it.next();\n            } while (it.key <= time && it.valid);\n            visit(time, notes);\n        }\n    }, [time2Notes]);\n    const scaleX = 8;\n    const matchNotePure = useCallback((notes, time2Timers, time, lane, threshold) => {\n        const { key: startTime, value: { beat: startBeat, bpm } } = time2Timers.le(time);\n        const beat = startBeat + (time - startTime) / 60 * bpm; \n        let minDist = threshold * threshold, minBeat, minLane = NaN;\n        notes.forEach((noteBeat, { lane: noteLane }) => {\n            const dist = Math.pow((noteLane - lane) / scaleX, 2) + Math.pow(noteBeat - beat, 2);\n            if (dist < minDist) {\n                minDist = dist;\n                minBeat = noteBeat;\n                minLane = noteLane;\n            }\n        }, beat - threshold, beat + threshold);\n        if (isNaN(minLane)) return null;\n        else return {\n            beat: minBeat,\n            lane: minLane,\n            time: startTime + (minBeat - startBeat) / bpm * 60,\n        };\n    }, []);\n    const matchNote = useCallback((time, lane, threshold) =>\n        matchNotePure(notes, time2Timers, time, lane, threshold),\n        [matchNotePure, notes, time2Timers]);\n\n    const [currentBPM, setCurrentBPM] = useState(initial.bpm);\n\n    const params = {\n        music, timers, setTimers, notes, setNotes, markers, setMarkers,\n        ranges, time2Timers, time2Notes, time2Markers,\n        ...initial, division, setDivision, follow, setFollow, scale, setScale, currentBPM, setCurrentBPM,\n        quantize, countNotes, findNotePure, findNote, forEachNote, forEachGroup, matchNotePure, matchNote,\n    };\n\n    return params;\n};\n\nexport default useChart;\n","// scroll speed normalizer from https://stackoverflow.com/a/30134826/3871776\n\n// Reasonable defaults\nvar PIXEL_STEP = 10;\nvar LINE_HEIGHT = 40;\nvar PAGE_HEIGHT = 800;\n\nfunction normalizeWheel(/*object*/ event) /*object*/ {\n    var sX = 0, sY = 0,       // spinX, spinY\n        pX = 0, pY = 0;       // pixelX, pixelY\n\n    // Legacy\n    if ('detail' in event) { sY = event.detail; }\n    if ('wheelDelta' in event) { sY = -event.wheelDelta / 120; }\n    if ('wheelDeltaY' in event) { sY = -event.wheelDeltaY / 120; }\n    if ('wheelDeltaX' in event) { sX = -event.wheelDeltaX / 120; }\n\n    // side scrolling on FF with DOMMouseScroll\n    if ('axis' in event && event.axis === event.HORIZONTAL_AXIS) {\n        sX = sY;\n        sY = 0;\n    }\n\n    pX = sX * PIXEL_STEP;\n    pY = sY * PIXEL_STEP;\n\n    if ('deltaY' in event) { pY = event.deltaY; }\n    if ('deltaX' in event) { pX = event.deltaX; }\n\n    if ((pX || pY) && event.deltaMode) {\n        if (event.deltaMode === 1) {          // delta in LINE units\n            pX *= LINE_HEIGHT;\n            pY *= LINE_HEIGHT;\n        } else {                             // delta in PAGE units\n            pX *= PAGE_HEIGHT;\n            pY *= PAGE_HEIGHT;\n        }\n    }\n\n    // Fall-back if spin cannot be determined\n    if (pX && !sX) { sX = (pX < 1) ? -1 : 1; }\n    if (pY && !sY) { sY = (pY < 1) ? -1 : 1; }\n\n    return {\n        spinX: sX,\n        spinY: sY,\n        pixelX: pX,\n        pixelY: pY\n    };\n}\n\nexport { normalizeWheel };\n","import React, { useCallback, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport { normalizeWheel } from '../utils';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        width: '11em',\n        fontSize: `${470 / 11}px`,\n        height: '100%',\n        backgroundColor: '#000000',\n        overflow: 'hidden',\n    },\n    inner: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        width: '100%',\n        height: 5000,\n    },\n});\n\nfunction Score({\n    music, scale, setScale, scaleSpeed, minScale, maxScale, scrollSpeed,\n    containerEl, setContainerEl, innerEl, setInnerEl, children\n}) {\n    const classes = useStyles();\n\n    // scale = pixels per second\n    const onWheel = useCallback((e) => {\n        if (!containerEl) return;\n        const { pixelY } = normalizeWheel(e.nativeEvent);\n        if (e.ctrlKey) { // scaling\n            const height = scale * music.duration;\n            // scaling keeps the cursor unmoved, that is, \n            const ratio = (e.clientY + containerEl.scrollTop) / height;\n            // scale changes on a proportional basis, a same scroll distance\n            // results in a same proportion of scale change.\n            let newScale = scale * (1 - pixelY * scaleSpeed);\n            if (newScale < minScale) newScale = minScale;\n            if (newScale > maxScale) newScale = maxScale;\n            const newHeight = newScale * music.duration;\n            let newScroll = ratio * newHeight - e.clientY;\n            // keep whole score in viewport\n            if (newScroll < 0) newScroll = 0;\n            if (newScroll + window.innerHeight > newHeight) newScroll = newHeight - window.innerHeight;\n            containerEl.scrollTop = newScroll;\n            setScale(newScale);\n        } else {\n            const height = scale * music.duration;\n            // scroll changes proportional to scale, a same scroll distance\n            // results in a same scroll change measured in *beats*. \n            let newScroll = containerEl.scrollTop + pixelY * scrollSpeed * Math.sqrt(scale);\n            // keep whole score in viewport\n            if (newScroll < 0) newScroll = 0;\n            if (newScroll + window.innerHeight > height) newScroll = height - window.innerHeight;\n            containerEl.scrollTop = newScroll;\n        }\n    }, [containerEl, scale, music.duration, scaleSpeed, minScale, maxScale, setScale, scrollSpeed]);\n    // prevent default ctrl+wheel zoom, for details about the { passive: false } option\n    // in addEventListener, see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener\n    useEffect(() => {\n        const prevent = (e) => {\n            if (!e.ctrlKey) return;\n            e.stopPropagation();\n            e.preventDefault();\n            return false;\n        };\n        window.addEventListener('wheel', prevent, { passive: false });\n        return () => window.removeEventListener('wheel', prevent);\n    }, []);\n\n    // jump to scroll bottom initially, use getBoundingClientRect() so that this\n    // will run only once, upon mounting (instead of every time scale changes).\n    useEffect(() => {\n        if (!innerEl || !containerEl) return;\n        const { height } = innerEl.getBoundingClientRect();\n        containerEl.scrollTop = height - window.innerHeight;\n    }, [containerEl, innerEl]);\n\n    const onContextMenu = useCallback((e) => {\n        e.preventDefault();\n        e.stopPropagation();\n    }, []);\n\n    return (\n        <div\n            ref={setContainerEl}\n            className={classes.root}\n            onWheel={onWheel}\n            onContextMenu={onContextMenu}>\n            <div\n                ref={setInnerEl}\n                style={{ height: music.duration * scale }}\n                className={classes.inner}>\n                {children}\n            </div>\n        </div>\n    );\n};\n\nexport default Score;\n","import React, { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport classNames from 'classnames';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        height: '100%',\n        width: `${7 / 11 * 100}%`,\n        left: `${2 / 11 * 100}%`,\n        opacity: 0.5,\n        '&$thumb': {\n            opacity: 0.3,\n        },\n    },\n    lanes: {\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        width: '100%',\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'space-between',\n    },\n    sideLane: {\n        width: 0,\n        borderRight: '5px solid #FFF',\n        marginRight: -2,\n        marginLeft: -2,\n    },\n    middleLane: {\n        width: 0,\n        borderRight: '1px solid #FFF',\n    },\n    bar: {\n        position: 'absolute',\n        left: 0,\n        width: '100%',\n        borderBottom: '1px dashed rgba(255, 255, 255, 0.6)',\n    },\n    major: {\n        borderBottom: '1px solid #FFF',\n    },\n    thumb: {},\n});\n\nfunction Bars({ music: { duration }, ranges, division, thumb = false }) {\n    const classes = useStyles();\n    const bars = useMemo(() => {\n        const bars = [];\n        for (const { beat1, beat2, bpm, time1 } of ranges) {\n            for (let beat = beat1; beat < beat2; beat += 1 / division) {\n                const deltaBeat = beat - beat1;\n                const time = time1 + deltaBeat / bpm * 60;\n                // use epsilon to avoid round off errors\n                const major = Math.abs(Math.round(deltaBeat) - deltaBeat) < 1e-5;\n                bars.push(<div\n                    key={time}\n                    className={classNames(classes.bar, { [classes.major]: major })}\n                    style={{ bottom: `${time / duration * 100}%` }}\n                />);\n            }\n        }\n        return bars;\n    }, [ranges, duration, division, classes]);\n    return (\n        <div className={classNames(classes.root, { [classes.thumb]: thumb })}>\n            <div className={classes.lanes}>\n                <div className={thumb ? classes.middleLane : classes.sideLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={classes.middleLane}/>\n                <div className={thumb ? classes.middleLane : classes.sideLane}/>\n            </div>\n            {bars}\n        </div>\n    );\n}\n\nexport default Bars;\n","import { makeStyles } from '@material-ui/styles';\nimport classNames from 'classnames';\nimport React, { useMemo } from 'react';\nimport focus from '../assets/focus.svg';\nimport cross from '../assets/cross.svg';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        height: '100%',\n        width: `${7 / 11 * 100}%`,\n        left: `${2 / 11 * 100}%`,\n    },\n    note: {\n        width: '1em',\n        height: '1em',\n        borderRadius: '50%',\n        position: 'absolute',\n        marginBottom: '-0.5em',\n        '&$focusable:hover $focus': {\n            visibility: 'initial',\n        },\n        '&$thumb': {\n            transform: 'scale(0.5)',\n        },\n        boxSizing: 'border-box',\n        '&$selected': {\n            border: '4px solid #5996FF',\n        },\n        '&$middle': {\n            border: 'none',\n        }\n    },\n    focusable: {\n        cursor: 'pointer',\n    },\n    focus: {\n        position: 'absolute',\n        width: '1.4em',\n        height: '1.4em',\n        left: '-0.2em',\n        top: '-0.2em',\n        pointerEvents: 'none',\n        visibility: 'hidden',\n        userSelect: 'none',\n    },\n    single: {\n        backgroundColor: '#FFF',\n    },\n    slide: {\n        backgroundColor: '#7ADEAE',\n    },\n    flick: {\n        backgroundColor: '#FFA0E8',\n        '&:after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            left: '50%',\n            top: '50%',\n            width: 0,\n            height: 0,\n            borderLeft: `${10 / 60}em solid transparent`,\n            borderRight: `${10 / 60}em solid transparent`,\n            borderBottom: `${16.739 / 60}em solid #FFF`,\n            borderTop: 'none',\n            marginLeft: `-${10 / 60}em`,\n            marginTop: `-${16.739 / 60 / 2}em`,\n        },\n        '&$thumb:after': {\n            visibility: 'hidden',\n        },\n    },\n    middle: {\n        '&:after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            left: 0,\n            right: 0,\n            bottom: '50%',\n            borderBottom: '3px solid #7ADEAE',\n            marginBottom: -1.5,\n        },\n        '&$middleSelected:after': {\n            borderBottom: '3px solid #5996FF',\n        },\n        '&$thumb:after': {\n            opacity: 0.6,\n        },\n    },\n    tapLine: {\n        position: 'absolute',\n        marginLeft: '1em',\n        marginRight: 0,\n        height: 0,\n        marginBottom: -1.5,\n        borderBottom: '3px solid #FFF',\n    },\n    snake: {\n        position: 'absolute',\n        left: 0,\n        right: 0,\n        display: 'flex',\n    },\n    thumb: {},\n    selected: {\n        position: 'absolute',\n        height: '100%',\n        left: 0,\n        top: 0,\n        pointerEvents: 'none',\n        userSelect: 'none',\n        zIndex: 2,\n    },\n    middleSelected: {},\n});\n\nfunction Note({ time, duration, lane, note: type, flick, start, end, code, thumb, selected }) {\n    const classes = useStyles();\n\n    const single = type === 'Single';\n    const slide = type === 'Slide';\n    const full = start || end;\n    const focusable = !thumb\n        && (code.startsWith('placement/')\n        || code.startsWith('modification/')\n        || code === 'select');\n    const middle = slide && !full;\n    const selecting = code === 'select';\n\n    return (\n        <div\n            className={classNames(classes.note, {\n                [classes.single]: single && !flick,\n                [classes.slide]: slide && full && !flick,\n                [classes.flick]: flick,\n                [classes.middle]: middle,\n                [classes.focusable]: focusable,\n                [classes.thumb]: thumb,\n                [classes.middleSelected]: middle && selected && selecting,\n            })}\n            style={{\n                bottom: `${time / duration * 100}%`,\n                left: `${lane / 7 * 100}%`,\n            }}>\n            <img\n                className={classes.focus}\n                alt=\"focus\"\n                src={focus}/>\n            {!thumb && selected && !middle && selecting && <img\n                className={classes.selected}\n                alt=\"selected\"\n                src={cross}/>}\n        </div>\n    );\n}\n\nfunction Snake({ x0, x1, y0, y1, thumb }) {\n    const classes = useStyles();\n    return (\n        <div\n            className={classes.snake}\n            style={{\n                bottom: `${y0 * 100}%`,\n                top: `${(1 - y1) * 100}%`,\n            }}>\n            <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 7 1\" preserveAspectRatio=\"none\">\n                <polygon\n                    fill=\"rgba(122, 222, 174, 0.4)\"\n                    strokeWidth=\"0\"\n                    points={`${x0},1 ${x0 + 1},1 ${x1 + 1},0 ${x1},0`}/>\n            </svg>\n        </div>\n    );\n}\n\nfunction Notes({\n    time2Notes, music: { duration }, notes, setNotes,\n    findNote, forEachNote, forEachGroup, code, thumb = false,\n}) {\n    const classes = useStyles();\n\n    const snakes = useMemo(() => {\n        const res = [];\n        if (thumb) return res;\n        ['A', 'B'].forEach((pos) => {\n            let lastY = 0, lastLane = -1;\n            forEachNote((time, { lane, end }) => {\n                if (lastLane !== -1) {\n                    const y1 = time / duration;\n                    res.push(<Snake\n                        key={`snake-${lastY}-${y1}-${pos}`}\n                        x0={lastLane} x1={lane}\n                        y0={lastY} y1={y1}/>);\n                }\n                lastLane = end ? -1 : lane;\n                lastY = time / duration;\n            }, { pos, note: 'Slide' });\n        });\n        return res;\n    }, [duration, forEachNote, thumb]);\n\n    const tapLines = useMemo(() => {\n        const res = [];\n        if (thumb) return res;\n        forEachGroup((time, notes) => {\n            let minLane = 8, maxLane = -1;\n            for (const { lane, note: type, start, end } of notes) {\n                // Synchronus tap line appears two notes possess the same beat,\n                // but middle slide notes are not counted\n                if (type !== 'Slide' || start || end) {\n                    minLane = Math.min(minLane, lane);\n                    maxLane = Math.max(maxLane, lane);\n                }\n            }\n            if (minLane < maxLane - 1) { // at least two notes, distance >= 2, display sync tap line\n                res.push(<div\n                    key={`tap-line-${time}`}\n                    className={classes.tapLine}\n                    style={{\n                        bottom: `${time / duration * 100}%`,\n                        left: `${minLane / 7 * 100}%`,\n                        right: `${(7 - maxLane) / 7 * 100}%`,\n                    }}\n                />)\n            }\n        });\n        return res;\n    }, [classes, duration, forEachGroup, thumb]);\n\n    const noteEls = useMemo(() => {\n        const res = [];\n        time2Notes.forEach((time, note) => {\n            res.push(<Note\n                key={`note-${note.beat}-${note.lane}`}\n                time={time}\n                duration={duration}\n                notes={notes}\n                setNotes={setNotes}\n                findNote={findNote}\n                code={code}\n                thumb={thumb}\n                {...note}/>);\n        });\n        return res;\n    }, [code, duration, findNote, notes, setNotes, time2Notes, thumb]);\n\n    const children = useMemo(() => [...snakes, ...tapLines, ...noteEls], [snakes, tapLines, noteEls]);\n    \n    return (\n        <div className={classes.root}>\n            {children}\n        </div>\n    );\n}\n\nexport default Notes;\n","import { useEffect, useMemo, useCallback } from 'react';\n\nconst interpolateInterval = 15;\n\nconst useDrag = ({ onDragStart, onDrag, onDragEnd, el }) => {\n    const states = useMemo(() => ({\n        left: false, right: false, dragging: false, shift: false,\n        lestX: 0, lastY: 0, startX: 0, startY: 0,\n    }), []);\n\n    const onMouseDown = useCallback((e) => {\n        if (e.button === 0) states.left = true;\n        if (e.button === 2) states.right = true;\n        states.shift = e.shiftKey;\n        states.lastX = e.clientX;\n        states.lastY = e.clientY;\n        states.startX = e.clientX;\n        states.startY = e.clientY;\n        if (!states.dragging) {\n            states.dragging = true;\n            if (onDragStart) {\n                const ret = onDragStart(e, states);\n                // disable event, no prevent default, no stop propagation.\n                if (ret === false) {\n                    states.left = states.right = states.dragging = false;\n                    return;\n                }\n            }\n        }\n        e.preventDefault();\n        e.stopPropagation();\n    }, [onDragStart, states]);\n\n    const onMouseMove = useCallback((e) => {\n        // due to browser mechanics, the mousemove event itself\n        // is throttled, so if the mouse moves too fase, two subsequent mousemove\n        // events will have a very large gap, and some notes that are located\n        // on the path of the mouse would be lost.\n        // the solution is to interpolate manually, if two mousemove events come\n        // with a big gap, the path is split into many segments, and fake events\n        // are added so that the path looks smooth to onDrag.\n        states.shift = e.shiftKey;\n        if (states.dragging) {\n            // here, the end point is always given to onDrag\n            let steps = Math.round(Math.abs(e.clientY - states.lastY) / interpolateInterval);\n            if (steps === 0) steps = 1;\n            for (let i = 1; i <= steps; ++i) {\n                const t = i / steps;\n                const clientX = states.lastX + (e.clientX - states.lastX) * t;\n                const clientY = states.lastY + (e.clientY - states.lastY) * t;\n                if (onDrag) onDrag({ clientX, clientY }, states);\n            }\n            states.lastX = e.clientX;\n            states.lastY = e.clientY;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n    }, [onDrag, states]);\n\n    const onMouseUp = useCallback((e) => {\n        if (states.dragging) {\n            if (onDragEnd) onDragEnd(e, states);\n            states.dragging = false;\n        }\n        // shift = e.shiftKey;\n        if (e.button === 0) states.left = false;\n        if (e.button === 2) states.right = false;\n        e.preventDefault();\n        e.stopPropagation();\n    }, [onDragEnd, states]);\n\n    useEffect(() => {\n        if (!el) return;\n        el.addEventListener('mousedown', onMouseDown);\n        el.addEventListener('mousemove', onMouseMove);\n        el.addEventListener('mouseup', onMouseUp);\n        return () => {\n            el.removeEventListener('mousedown', onMouseDown);\n            el.removeEventListener('mousemove', onMouseMove);\n            el.removeEventListener('mouseup', onMouseUp);\n        };\n    }, [el, onMouseDown, onMouseMove, onMouseUp]);\n};\n\nexport default useDrag;\n","import React, { useCallback, useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport useDrag from '../tools/useDrag';\nimport { normalizeWheel } from '../utils';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'relative',\n        backgroundColor: '#000000',\n        width: '11em',\n        fontSize: `${78 / 11}px`,\n        right: 0,\n        top: 0,\n        height: '100%',\n        overflow: 'hidden',\n    },\n});\n\nfunction Thumb({ children, scale, music: { duration }, containerEl, innerEl, thumbScrollSpeed }) {\n    const classes = useStyles();\n\n    const [thumbEl, setThumbEl] = useState(null);\n    const updateScroll = useCallback((e, { left }) => {\n        if (!containerEl || !innerEl) return;\n        if (!left) return;\n        const position = e.clientY / window.innerHeight * duration;\n        const viewSize = window.innerHeight / scale; // in seconds\n        const { height } = innerEl.getBoundingClientRect();\n        let top = (position - viewSize / 2) / duration * height; // in px\n        if (top < 0) top = 0;\n        if (top + window.innerHeight > height) top = height - window.innerHeight;\n        containerEl.scrollTop = top;\n    }, [containerEl, duration, innerEl, scale]);\n    useDrag({ onDrag: updateScroll, onDragEnd: updateScroll, el: thumbEl });\n\n    // scale = pixels per second\n    const onWheel = useCallback((e) => {\n        if (!containerEl || !innerEl) return;\n        const { pixelY } = normalizeWheel(e.nativeEvent);\n        const { height } = innerEl.getBoundingClientRect();\n        const viewTop = containerEl.scrollTop / height * window.innerHeight;\n        const viewHeight = window.innerHeight / scale;\n        let newTop = viewTop + pixelY * thumbScrollSpeed;\n        if (newTop < 0) newTop = 0;\n        if (newTop + viewHeight > window.innerHeight) newTop = window.innerHeight - viewHeight;\n        const newScroll = newTop / window.innerHeight * height;\n        containerEl.scrollTop = newScroll;\n    }, [containerEl, innerEl, scale, thumbScrollSpeed]);\n\n    return (\n        <div className={classes.root} ref={setThumbEl} onWheel={onWheel}>\n            {children}\n        </div>\n    );\n};\n\nexport default Thumb;\n","import { useEffect } from \"react\";\n\nconst useFrame = (fn) => {\n    useEffect(() => {\n        let valid = true;\n        const onFrameWrapped = () => {\n            if (fn) fn();\n            if (valid) requestAnimationFrame(onFrameWrapped);\n        };\n        requestAnimationFrame(onFrameWrapped);\n        return () => { valid = false; };\n    }, [fn]);\n}\n\nexport default useFrame;\n","import React, { useCallback, useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport useFrame from '../tools/useFrame';\n\nconst useStyles = makeStyles({\n    stencil: {\n        position: 'absolute',\n        left: 0,\n        width: '100%',\n        backgroundColor: 'rgba(0, 0, 0, 0.65)',\n        pointerEvents: 'none',\n    },\n});\n\nfunction Stencil({ innerEl, containerEl }) {\n    const classes = useStyles();\n\n    const [upperEl, setUpperEl] = useState(null);\n    const [lowerEl, setLowerEl] = useState(null);\n    const updateStencil = useCallback(() => {\n        if (!innerEl) return;\n        const height = innerEl.getBoundingClientRect().height;\n        const top = containerEl.scrollTop / height;\n        const bottom = (containerEl.scrollTop + window.innerHeight) / height;\n        if (upperEl) upperEl.style.bottom = `${(1 - top) * 100}%`;\n        if (lowerEl) lowerEl.style.top = `${bottom * 100}%`;\n    }, [innerEl, containerEl, upperEl, lowerEl]);\n    useFrame(updateStencil);\n    \n    return <>\n        <div ref={setUpperEl} className={classes.stencil} style={{ top: 0 }}/>\n        <div ref={setLowerEl} className={classes.stencil} style={{ bottom: 0 }}/>\n    </>;\n}\n\nexport default Stencil;\n","import React, { useMemo, useCallback, useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport useFrame from '../tools/useFrame';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        height: '100%',\n        left: `${2 / 11 * 100}%`,\n        right: `${2 / 11 * 100}%`,\n    },\n    timer: {\n        position: 'absolute',\n        left: 0,\n        right: 0,\n        height: '0.6em',\n        marginBottom: '-0.3em',\n        '&:after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            left: 0,\n            right: 0,\n            bottom: '50%',\n            borderBottom: '3px solid #FFCD18',\n            marginBottom: -1.5,\n            pointerEvents: 'none',\n        },\n    },\n    bpm: {\n        position: 'absolute',\n        left: '100%',\n        top: '50%',\n        marginTop: '-0.5em',\n        paddingLeft: '0.25em',\n        fontSize: '0.6em',\n        lineHeight: 1,\n        color: '#FFCD18',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n        willChange: 'opacity',\n    },\n    lastBPM: {\n        willChange: 'opacity',\n        position: 'fixed',\n        left: `calc(25vw + ${9 / 0.6}em)`,\n        bottom: 0,\n        marginLeft: '0.25em',\n        paddingBottom: '0.6em',\n        fontSize: '0.6em',\n        lineHeight: 1,\n        color: '#FFCD18',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n        '&:after': {\n            content: '\\'\\'',\n            position: 'absolute',\n            left: '50%',\n            bottom: '0.25em',\n            width: 0,\n            height: 0,\n            marginLeft: '-0.2em',\n            borderTop: '0.2em solid #FFCD18',\n            borderLeft: '0.2em solid transparent',\n            borderRight: '0.2em solid transparent',\n        },\n    },\n});\n\nfunction Timer({ time, bpm, duration, observer }) {\n    const classes = useStyles();\n    const [el, setEl] = useState(null);\n    useEffect(() => {\n        if (!el) return;\n        observer.observe(el);\n        return () => observer.unobserve(el);\n    }, [el, observer]);\n    return (\n        <div\n            ref={setEl}\n            className={classes.timer}\n            style={{ bottom: `${time / duration * 100}%` }}>\n            <div className={classes.bpm}>{bpm}</div>\n        </div>\n    );\n}\n\nfunction Timers({ time2Timers, music: { duration }, containerEl, innerEl }) {\n    const classes = useStyles();\n\n    const onIntersect = useCallback((entries) => {\n        for (const { boundingClientRect: { top, bottom }, target } of entries) {\n            target.style.opacity = (top + bottom) / 2 < window.innerHeight ? 1 : 0;\n        }\n    }, []);\n    const observer = useMemo(\n        () => new IntersectionObserver(onIntersect, { threshold: 0.5 }),\n        [onIntersect]);\n    useEffect(() => {\n        if (!observer) return;\n        return () => observer.disconnect();\n    }, [observer]);\n    const timerEls = useMemo(() => {\n        const res = [];\n        time2Timers.forEach((time, { beat, bpm }) => {\n            res.push((\n                <Timer key={beat} time={time} bpm={bpm} duration={duration} observer={observer}/>\n            ));\n        });\n        return res;\n    }, [time2Timers, duration, observer]);\n\n    const [lastBPMEl, setLastBPMEl] = useState(null);\n    const updateTimerEls = useCallback(() => {\n        if (!containerEl || !innerEl || !lastBPMEl) return;\n        const { height, width } = innerEl.getBoundingClientRect();\n        // on music change, duration will become 0 suddenly, before React could even\n        // 'react' on the change, whicl will make bottomTime -Infinity, crashing the\n        // application bu timer2Timers.le(bottomTime) returning nothing.\n        const bottomTime = Math.max((1 - (containerEl.scrollTop + window.innerHeight) / height) * duration, 0);\n        const em = width / 11;\n        const threshold = 1.25;\n        const { key: nextTime, valid } = time2Timers.gt(bottomTime);\n        if (valid && (nextTime - bottomTime) < em * threshold / height * duration) {\n            lastBPMEl.style.opacity = 0;\n        } else {\n            lastBPMEl.style.opacity = 1;\n            const { value: { bpm } } = time2Timers.le(bottomTime);\n            lastBPMEl.innerHTML = `${bpm}`;\n        }\n    }, [containerEl, duration, innerEl, lastBPMEl, time2Timers]);\n    useFrame(updateTimerEls);\n\n    return (\n        <div className={classes.root}>\n            {timerEls}\n            <div className={classes.lastBPM} ref={setLastBPMEl}/>\n        </div>\n    );\n}\n\nexport default Timers;\n","import React, { useMemo } from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        height: '100%',\n        left: `${2 / 11 * 100}%`,\n        right: `${2 / 11 * 100}%`,\n    },\n    timer: {\n        position: 'absolute',\n        left: 0,\n        right: 0,\n        height: 0,\n        borderBottom: '1px solid #FFCD18',\n        marginBottom: -0.5,\n    },\n});\n\nfunction Timer({ time,  duration }) {\n    const classes = useStyles();\n    return (\n        <div\n            className={classes.timer}\n            style={{ bottom: `${time / duration * 100}%` }}>\n        </div>\n    );\n}\n\nfunction ThumbTimers({ time2Timers, music: { duration } }) {\n    const classes = useStyles();\n\n    const timerEls = useMemo(() => {\n        const res = [];\n        time2Timers.forEach((time, { beat }) => {\n            res.push((\n                <Timer key={beat} time={time} duration={duration}/>\n            ));\n        });\n        return res;\n    }, [time2Timers, duration]);\n\n    return (\n        <div className={classes.root}>\n            {timerEls}\n        </div>\n    );\n}\n\nexport default ThumbTimers;\n","import React, { useCallback, useEffect } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\n\nfunction Player({ music, code, setCode }) {\n    const onSpace = useCallback((_, event) => {\n        if (music.paused) music.play();\n        else music.pause();\n        event.stopPropagation();\n        event.preventDefault();\n    }, [music]);\n    const setMyCode = useCallback(() => setCode('player'), [setCode]);\n    useEffect(() => {\n        if (code !== 'player') music.pause();\n    }, [code, music]);\n    return <>\n        <KeyboardEventHandler handleKeys={['r']} onKeyEvent={setMyCode}/>\n        <KeyboardEventHandler isDisabled={code !== 'player'} handleKeys={['space']} onKeyEvent={onSpace}/>\n    </>;\n}\n\nexport default Player;","import React, { useCallback, useMemo, useRef } from 'react';\nimport { Howl } from 'howler';\nimport flickFX from '../assets/flick.mp3';\nimport tapFX from '../assets/tap.mp3';\nimport useFrame from './useFrame';\n\nfunction SoundFX({ music, time2Notes }) {\n    const tap = useMemo(() => new Howl({ src: [tapFX] }), []);\n    const flick = useMemo(() => new Howl({ src: [flickFX] }), []);\n\n    // to bypass the React render procedure and elimanate delay playing sound,\n    // we check for new sound events every frame, that is, sound events that happened/\n    // after last frame and before this frame.\n    const lastTimeRef = useRef(0);\n    const onFrame = useCallback(() => {\n        if (music.paused) return;\n        let hasTap = false, hasFlick = false;\n        time2Notes.forEach((_, { flick }) => {\n            // both sound effects are played only once in one frame\n            if (flick) hasFlick = true;\n            else hasTap = true;\n        }, lastTimeRef.current, music.currentTime);\n        lastTimeRef.current = music.currentTime;\n        if (hasTap) tap.play();\n        if (hasFlick) flick.play();\n    }, [flick, music, tap, time2Notes]);\n    useFrame(onFrame);\n\n    return <div/>;\n};\n\nexport default SoundFX;\n","import React, { useCallback, useEffect, useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport useEvent from './useEvent';\nimport useFrame from './useFrame';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        left: 0,\n        width: '100%',\n        height: 0,\n        borderBottom: '3px solid #ff4e67',\n        marginTop: -1.5,\n    },\n});\n\nfunction Progress({\n    music, innerEl, follow, progressOffset, code, keepInView, inflate,\n}) {\n    const classes = useStyles();\n\n    const [progressEl, setProgressEl] = useState(null);\n    const updateProgress = useCallback((noscroll = false) => {\n        if (music.paused) return;\n        // use getBoundingClientRect so that the dimensions do not rely on scale\n        const height = innerEl.getBoundingClientRect().height;\n        const progress = music.currentTime / music.duration;\n        const progressPosition = (1 - progress) * height;\n    \n        if (follow && !noscroll) keepInView(progressPosition + progressOffset);\n        // percentage keeps the progress position unchanged upon scaling\n        const progressRatio = progressPosition / height;\n        if (progressEl) progressEl.style.top = `${progressRatio * 100}%`;\n    }, [progressEl, innerEl, music, follow, keepInView, progressOffset]);\n    useFrame(updateProgress);\n    \n    const seekProgress = useCallback((e) => {\n        if (code !== 'player') return;\n        const { time } = inflate(e);\n        music.currentTime = time;\n        if (music.paused) music.play();\n        updateProgress(true);\n    }, [code, inflate, music, updateProgress]);\n    useEvent(innerEl, 'click', seekProgress);\n    \n    useEffect(updateProgress, [updateProgress, code]);\n    return code === 'player' && (\n        <div ref={setProgressEl} className={classes.root}/>\n    );\n}\n\nexport default Progress;\n","import React, { useCallback, useState } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport useEvent from './useEvent';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        left: `${2 / 11 * 100}%`,\n        right: `${2 / 11 * 100}%`,\n        height: 0,\n        borderBottom: '3px solid #5996FF',\n        marginTop: -1.5,\n        pointerEvents: 'none',\n    },\n    notesCounter: {\n        position: 'absolute',\n        right: '100%',\n        top: 0,\n        marginTop: '-0.5em',\n        paddingRight: '0.25em',\n        fontSize: '0.6em',\n        lineHeight: 1,\n        color: '#5996FF',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n    },\n});\n\nfunction PlayerCaret({ inflate, innerEl, countNotes, code }) {\n    const classes = useStyles();\n\n    const [caretEl, setCaretEl] = useState(null);\n    const [notesCounterEl, setNotesCounterEl] = useState(null);\n    const updateCaret = useCallback((e) => {\n        const { ratioTop, time } = inflate(e);\n        if (caretEl) caretEl.style.top = `${ratioTop * 100}%`;\n        if (notesCounterEl) notesCounterEl.innerHTML = `${countNotes(time)}`;\n    }, [caretEl, notesCounterEl, inflate, countNotes]);\n    useEvent(innerEl, 'mousemove', updateCaret);\n\n    return code === 'player' && (\n        <div ref={setCaretEl} className={classes.root}>\n            <div ref={setNotesCounterEl} className={classes.notesCounter}/>\n        </div>\n    );\n}\n\nexport default PlayerCaret;\n","import React, { useCallback, useMemo } from 'react';\nimport { makeStyles } from '@material-ui/styles';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport marker from '../assets/marker.svg';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        height: '100%',\n        left: `${9 / 11 * 100}%`,\n        width: `${2 / 11 * 100}%`,\n    },\n    marker: {\n        position: 'absolute',\n        left: `${1 / 6}em`,\n        height: '0.53em',\n        marginBottom: `-${0.53 / 2}em`,\n        cursor: 'pointer',\n        transition: 'transform 80ms cubic-bezier(0.4, 0, 0.2, 1)',\n        '&:hover': {\n            transform: 'translateX(15%)',\n        },\n    },\n});\n\nfunction Markers({ time2Markers, markers, setMarkers, music, quantize, code }) {\n    const classes = useStyles();\n\n    const onContextMenu = useCallback((event) => {\n        const beat = event.target.getAttribute('data-beat');\n        setMarkers(markers.remove(beat));\n    }, [markers, setMarkers]);\n    const onClick = useCallback((event) => {\n        const time = event.target.getAttribute('data-time');\n        music.currentTime = time;\n        event.preventDefault();\n        event.stopPropagation();\n    }, [music]);\n    const markerEls = useMemo(() => {\n        const res = [];\n        time2Markers.forEach((time, { beat }) => {\n            res.push((\n                <img\n                    key={beat}\n                    className={classes.marker}\n                    style={{ bottom: `${time / music.duration * 100}%` }}\n                    src={marker}\n                    alt=\"marker\"\n                    data-beat={beat}\n                    data-time={time}\n                    onContextMenu={onContextMenu}\n                    onClick={onClick}/>\n            ));\n        });\n        return res;\n    }, [time2Markers, classes, music, onContextMenu, onClick]);\n\n    const onMarker = useCallback(() => {\n        const { beat } = quantize(music.currentTime);\n        // markers are unique in time, so one at a time\n        if (!markers.find(beat).valid) setMarkers(markers.insert(beat, {}));\n    }, [markers, music, quantize, setMarkers]);\n    \n    return <>\n        <KeyboardEventHandler isDisabled={code !== 'player'} handleKeys={['e']} onKeyEvent={onMarker}/>\n        <div className={classes.root}>\n            {markerEls}\n        </div>\n    </>;\n}\n\nexport default Markers;\n","import { useCallback, useEffect, useRef } from 'react';\nimport useDrag from './useDrag';\n\nconst usePen = ({\n    notes, setNotes, inflate, code, findNotePure, matchNotePure, time2Timers, quantize, innerEl,\n}, {\n    prefix, useRemove = true, type, onClick, quantizeThreshold = 0.25, snapThreshold = 0.1,\n}) => {\n    // notesRef serves as a cache to notes, the useEffect hook below keeps them\n    // the same every React render, and if several modifications are to be made\n    // to the notes object in the same React frame, notesRef.current will record\n    // these modification and keep the UI responsive. For more details, see\n    // comments to overriddenSetNotes beneath.\n    // the other purpose of notesRef is to eliminate the need to re-memo onDragStart,\n    // onDrag and onDragEnd every time notes changes. Otherwise, each new note will\n    // result in re-execution of the useEffect hook registering mouse listeners,\n    // destroying any internal state (like dragging) we kept in that closure.\n    const notesRef = useRef(notes);\n    useEffect(() => { notesRef.current = notes; }, [notes]);\n    const codeRef = useRef(code);\n    useEffect(() => { codeRef.current = code; }, [code]);\n\n    const onDragStart = useCallback(() => {\n        if (!code.startsWith(prefix)) return false;\n    }, [code, prefix]);\n    const onDrag = useCallback((e, { shift, left, right }) => {\n        const notes = notesRef.current;\n        // when dragging, the mousemove event might be fired multiple times in one\n        // React render, which invokes onDrag and placeNote and setNotes multiple times,\n        // each time adding a new note. However, changes in notes are not commited until\n        // the next React render, which calls the previous useEffect hook and updates\n        // notesRef.current. So, in this case, the notes object passed into placeNote\n        // will remain unchanged, and the new notes object passed into setNotes will be\n        // the notes at the beginning of this React render plus one note, and some notes\n        // will be lost.\n        // the solution is to set notesRef.current each time a new note is added, as a\n        // cache to notes, and allow subsequent onDrag calls to see the new note fast\n        // enough, thus the note loss is eliminated. Meanwhile, setNotes is still called,\n        // and the global notes state will be updated in the next React render, which\n        // allows ALL the new notes to be displayed.\n        const overriddenSetNotes = (newNotes) => {\n            setNotes(newNotes);\n            notesRef.current = newNotes;\n        };\n        if (!shift) return;\n        if (left) {\n            switch (type) {\n                case 'quantize': {\n                    const { time, lane } = inflate(e);\n                    const { beat, delta } = quantize(time);\n                    if (delta > quantizeThreshold) return;\n                    const quantizedLane = Math.round(lane);\n                    if (quantizedLane < 0 || quantizedLane >= 7) return;\n                    onClick(code, notes, findNotePure, overriddenSetNotes, beat, quantizedLane, false);\n                    break;\n                }\n                case 'snap': {\n                    const { time, lane } = inflate(e);\n                    const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n                    if (!matched) return;\n                    const { beat, lane: matchedLane } = matched;\n                    onClick(code, notes, findNotePure, overriddenSetNotes, beat, matchedLane, false);\n                    break;\n                }\n                default: break;\n            }\n        }\n        if (useRemove && right) {\n            const { time, lane } = inflate(e);\n            const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n            if (!matched) return;\n            const { beat, lane: matchedLane } = matched;\n            const it = findNotePure(notes, beat, matchedLane);\n            if (it) overriddenSetNotes(it.remove());\n        }\n    }, [\n        code, time2Timers, findNotePure, quantize, inflate, setNotes, matchNotePure,\n        type, useRemove, onClick, quantizeThreshold, snapThreshold,\n    ]);\n    const onDragEnd = useCallback((e, { shift, left, right }) => {\n        const notes = notesRef.current;\n        if (shift) return;\n        const { time, lane } = inflate(e);\n        if (left) {\n            switch (type) {\n                case 'quantize': {\n                    const { time, lane } = inflate(e);\n                    const { beat, delta } = quantize(time);\n                    if (delta > quantizeThreshold) return;\n                    const quantizedLane = Math.round(lane);\n                    if (quantizedLane < 0 || quantizedLane >= 7) return;\n                    onClick(code, notes, findNotePure, setNotes, beat, quantizedLane, true);\n                    break;\n                }\n                case 'snap': {\n                    const { time, lane } = inflate(e);\n                    const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n                    if (!matched) return;\n                    const { beat, lane: matchedLane } = matched;\n                    onClick(code, notes, findNotePure, setNotes, beat, matchedLane, true);\n                    break;\n                }\n                default: break;\n            }\n        }\n        if (useRemove && right) {\n            const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n            if (!matched) return;\n            const { beat, lane: matchedLane } = matched;\n            const it = findNotePure(notes, beat, matchedLane);\n            if (it) setNotes(it.remove());\n        }\n    }, [\n        code, time2Timers, findNotePure, inflate, matchNotePure, quantize, setNotes,\n        type, useRemove, onClick, quantizeThreshold, snapThreshold,\n    ]);\n\n    useDrag({ onDragStart, onDrag, onDragEnd, el: innerEl });\n};\n\nexport default usePen;\n","import React, { useCallback } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport usePen from './usePen';\n\nconst placeNote = (code, notes, findNotePure, setNotes, beat, lane, singleClick) => {\n    switch (code) {\n        case 'placement/single': {\n            // if a note already exists with the same note and line, abandon placement\n            if (findNotePure(notes, beat, lane)) break;\n            setNotes(notes.insert(beat, { note: 'Single', lane }));\n            break;\n        }\n        case 'placement/slide-a': case 'placement/slide-b': {\n            const pos = code.substring(code.length - 1).toUpperCase(); // A or B\n            const it = findNotePure(notes, beat, lane);\n            if (!it) {\n                // default to true so if no such notes are found, a head is created\n                let foundTail = true;\n                // search in reverse order and try to find the last slide note\n                // with same pos\n                for (const it2 = notes.lt(beat); it2.valid; it2.prev()) {\n                    const { value: { note: type, pos: notePos, end } } = it2;\n                    if (type !== 'Slide' || notePos !== pos) continue;\n                    if (!end) foundTail = false;\n                    break;\n                }\n                // if last slide with same pos was not tail, then the last snake\n                // has not terminated, and a middle slide note was inserted, otherwise\n                // a head note was inserted to create a new snake.\n                setNotes(notes.insert(beat, {\n                    lane, pos,\n                    note: 'Slide',\n                    flick: false,\n                    start: foundTail,\n                    end: false, // new note is never end\n                }));\n            } else if (singleClick) {\n                const { value: { note: type, pos: notePos, end, start } } = it;\n                // overwrite same type only\n                if (type !== 'Slide' || notePos !== pos) break;\n                setNotes(it.update({\n                    lane, pos,\n                    note: 'Slide',\n                    flick: false, // new note is never flick\n                    start: false, // new note is never head\n                    end: !(end || start), // if note was head or tail, convert to middle\n                }));\n            }\n            break;\n        }\n        default: break;\n    }\n};\n\nfunction Placement(props) {\n    const { setCode } = props;\n    const setSingle = useCallback(() => setCode('placement/single'), [setCode]);\n    const setSlideA = useCallback(() => setCode('placement/slide-a'), [setCode]);\n    const setSlideB = useCallback(() => setCode('placement/slide-b'), [setCode]);\n    \n    usePen(props, { prefix: 'placement/', type: 'quantize', onClick: placeNote });\n\n    return <>\n        <KeyboardEventHandler handleKeys={['f']} onKeyEvent={setSingle}/>\n        <KeyboardEventHandler handleKeys={['s']} onKeyEvent={setSlideA}/>\n        <KeyboardEventHandler handleKeys={['d']} onKeyEvent={setSlideB}/>\n    </>;\n}\n\nexport default Placement;\n","import React, { useCallback } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\n\nfunction Divisions({ setDivision }) {\n    const setDivision1 = useCallback(() => setDivision(1), [setDivision]);\n    const setDivision2 = useCallback(() => setDivision(2), [setDivision]);\n    const setDivision3 = useCallback(() => setDivision(3), [setDivision]);\n    const setDivision4 = useCallback(() => setDivision(4), [setDivision]);\n    const setDivision6 = useCallback(() => setDivision(6), [setDivision]);\n    const setDivision8 = useCallback(() => setDivision(8), [setDivision]);\n    return <>\n        <KeyboardEventHandler handleKeys={['1']} onKeyEvent={setDivision1}/>\n        <KeyboardEventHandler handleKeys={['2']} onKeyEvent={setDivision2}/>\n        <KeyboardEventHandler handleKeys={['3']} onKeyEvent={setDivision3}/>\n        <KeyboardEventHandler handleKeys={['4']} onKeyEvent={setDivision4}/>\n        <KeyboardEventHandler handleKeys={['6']} onKeyEvent={setDivision6}/>\n        <KeyboardEventHandler handleKeys={['8']} onKeyEvent={setDivision8}/>\n    </>;\n}\n\nexport default Divisions;\n","import { makeStyles } from '@material-ui/styles';\nimport React, { useCallback, useState } from 'react';\nimport useEvent from './useEvent';\n\nconst useStyles = makeStyles({\n    root: {\n        position: 'absolute',\n        left: `${2 / 11 * 100}%`,\n        right: `${2 / 11 * 100}%`,\n        height: 0,\n        borderBottom: '3px solid #5996FF',\n        marginBottom: -1.5,\n        pointerEvents: 'none',\n    },\n    notesCounter: {\n        position: 'absolute',\n        right: '100%',\n        top: 0,\n        marginTop: '-0.5em',\n        paddingRight: '0.25em',\n        fontSize: '0.6em',\n        lineHeight: 1,\n        color: '#5996FF',\n        fontFamily: 'D-DIN',\n        fontWeight: 'normal',\n    },\n});\n\nfunction PlacementCaret({ music: { duration }, innerEl, quantize, inflate, code }) {\n    const classes = useStyles();\n\n    const [caretEl, setCaretEl] = useState(null);\n    const [notesCounterEl, setNotesCounterEl] = useState(null);\n    const updateCaret = useCallback((e) => {\n        const { time } = inflate(e);\n        const { time: quantizedTime, beat } = quantize(time);\n        if (caretEl) caretEl.style.bottom = `${quantizedTime / duration * 100}%`;\n        if (notesCounterEl) notesCounterEl.innerHTML = `${beat.toFixed(2)}'`;\n    }, [inflate, quantize, caretEl, duration, notesCounterEl]);\n    useEvent(innerEl, 'mousemove', updateCaret);\n\n    return (code.startsWith('placement/') || code.startsWith('modification/') || code === 'timer') && (\n        <div ref={setCaretEl} className={classes.root}>\n            <div ref={setNotesCounterEl} className={classes.notesCounter}/>\n        </div>\n    );\n}\n\nexport default PlacementCaret;\n","import React, { useCallback } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport usePen from './usePen';\n\nconst modifyNote = (code, notes, findNotePure, setNotes, beat, lane) => {\n    switch (code) {\n        case 'modification/flick': {\n            const it = findNotePure(notes, beat, lane);\n            if (!it) break;\n            const { value: note, value: { flick, note: type, end } } = it;\n            if (type === 'Slide' && !end) break; // cannot switch flick state\n            setNotes(it.update({ ...note, flick: !flick }));\n            break;\n        }\n        default: break;\n    }\n};\n\nfunction Modification(props) {\n    const { setCode } = props;\n    usePen(props, { prefix: 'modification/', type: 'snap', onClick: modifyNote });\n\n    const setFlick = useCallback(() => setCode('modification/flick'), [setCode]);\n    return <>\n        <KeyboardEventHandler handleKeys={['w']} onKeyEvent={setFlick}/>\n    </>;\n}\n\nexport default Modification;\n","import React, { useCallback } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport useEvent from './useEvent';\n\nfunction PlaceTimer({ code, innerEl, setCode, inflate, quantize, timers, setTimers, currentBPM }) {\n    const setMyCode = useCallback(() => setCode('timer'), [setCode]);\n\n    const onClick = useCallback((e) => {\n        if (code !== 'timer') return;\n        const { time } = inflate(e);\n        const { beat } = quantize(time);\n        const it = timers.find(beat);\n        if (it.valid) setTimers(it.update({ bpm: currentBPM }));\n        else setTimers(timers.insert(beat, { bpm: currentBPM }));\n    }, [code, currentBPM, inflate, quantize, setTimers, timers]);\n    useEvent(innerEl, 'click', onClick);\n    const onContextMenu = useCallback((e) => {\n        if (code !== 'timer') return;\n        const { time } = inflate(e);\n        const { beat } = quantize(time);\n        const it = timers.find(beat);\n        if (it.valid) setTimers(it.remove());\n    }, [code, inflate, quantize, setTimers, timers]);\n    useEvent(innerEl, 'contextmenu', onContextMenu);\n    \n    return (\n        <KeyboardEventHandler handleKeys={['a']} onKeyEvent={setMyCode}/>\n    );\n}\n\nexport default PlaceTimer;\n","import React, { useCallback, useState } from 'react';\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\nimport { makeStyles } from '@material-ui/styles';\nimport createTree from 'functional-red-black-tree';\nimport useDrag from './useDrag';\n\nconst useStyles = makeStyles({\n    dragArea: {\n        position: 'fixed',\n        backgroundColor: 'rgba(89, 150, 255, 0.4)',\n        border: '1px solid #5996FF',\n        visibility: 'hidden',\n    },\n    dragLine: {\n        position: 'fixed',\n        pointerEvents: 'none',\n        left: 0,\n        top: 0,\n        right: 0,\n        bottom: 0,\n    },\n});\n\nconst clickThreshold = 10;\nconst snapThreshold = 0.1;\n\nfunction Select({\n    code, inflate, setCode, notes, setNotes, time2Timers, matchNotePure, findNotePure,\n    innerEl, quantize, deflate,\n}) {\n    const classes = useStyles();\n    const setSelect = useCallback(() => setCode('select'), [setCode]);\n\n    const onDragStart = useCallback((e, state) => {\n        if (code !== 'select') return false;\n        state.click = true;\n        const { time, lane } = inflate(e);\n        // if drag starts on a note, we assume that the user wants to move\n        // select notes (relative to the note where the dragging begins).\n        const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n        if (matched) {\n            // save state to moving\n            state.move = true;\n            const { time: matchedTime, lane: matchedLane, beat } = matched;\n            const { x, y } = deflate({ time: matchedTime, lane: matchedLane });\n            // in this case, startX and startY is set to the beat and lane\n            // of the current note, which would be exactly on the grid\n            state.startX = x;\n            state.startY = y;\n            state.startIndex = findNotePure(notes, beat, matchedLane).index;\n        } else state.move = false;\n    }, [code, deflate, findNotePure, inflate, matchNotePure, notes, time2Timers]);\n    const [dragArea, setDragArea] = useState(null);\n    const [dragLine, setDragLine] = useState(null);\n    const onDrag = useCallback((e, state) => {\n        const { startX, startY } = state;\n        // if the mouse did not go over clickThreshold pixels, we assume that\n        // the user wanted to make a simple click. state.click is used to track\n        // whether this threshold was exceeded during the dragging process\n        const dist = Math.sqrt(Math.pow(e.clientX - startX, 2) + Math.pow(e.clientY - startY, 2));\n        if (dist > clickThreshold) state.click = false;\n        if (dragArea) {\n            // dragArea tracks the rectangle between the starting point and the\n            // current point, like when you drag on the Windows desktop.\n            // the drag area is visible only when the user is selecting instead\n            // of moving\n            dragArea.style.visibility = !state.move ? 'unset' : 'hidden';\n            // width and height cannot be negative\n            const x1 = Math.min(e.clientX, startX), x2 = Math.max(e.clientX, startX);\n            const y1 = Math.min(e.clientY, startY), y2 = Math.max(e.clientY, startY);\n            dragArea.style.left = `${x1}px`;\n            dragArea.style.top = `${y1}px`;\n            dragArea.style.width = `${x2 - x1}px`;\n            dragArea.style.height = `${y2 - y1}px`;\n        }\n        if (dragLine) {\n            // dragLine is the line between the starting point (which is ALWAYS\n            // on the grid) and the current point, where the end point of the line\n            // is quantized to the grid.\n            const { time, lane } = inflate(e);\n            const { time: quantizedTime } = quantize(time);\n            let quantizedLane = Math.round(lane);\n            if (quantizedLane < 0) quantizedLane = 0;\n            if (quantizedLane > 6) quantizedLane = 6;\n            // find the position of the end point\n            const { x, y } = deflate({ time: quantizedTime, lane: quantizedLane });\n            // the drag area is visible only when the user is moving instead\n            // of selecting\n            dragLine.style.visibility = state.move ? 'unset' : 'hidden';\n            // the dragLine element is an SVG <line> element, where viewport is the\n            // whole screen.\n            const x1 = state.shift ? startX : x, x2 = startX;\n            const y1 = y, y2 = startY;\n            dragLine.setAttribute('x1', `${x1}`);\n            dragLine.setAttribute('x2', `${x2}`);\n            dragLine.setAttribute('y1', `${y1}`);\n            dragLine.setAttribute('y2', `${y2}`);\n        }\n    }, [deflate, dragArea, dragLine, inflate, quantize]);\n    const clearSelectionPure = useCallback((notes) => {\n        for (let it = notes.begin; it.valid; it.next()) {\n            const { index, value: { selected = false }, value: note } = it;\n            if (selected) {\n                notes = it.update({ ...note, selected: false });\n                // since notes is functional, the previous iterator will not\n                // be working after the update, so we must find the iterator\n                // pointing to the same element, but in the new tree.\n                it = notes.at(index); // new notes\n            }\n        }\n        return notes;\n    }, []);\n    const toggleNotesPure = useCallback((notes, startBeat, endBeat, startLane, endLane) => {\n        for (let it = notes.ge(startBeat); it.valid && it.key < endBeat; it.next()) {\n            const { index, value: note, value: { lane, selected } } = it;\n            if (lane >= startLane && lane < endLane) {\n                notes = it.update({ ...note, selected: !selected });\n                // see above\n                it = notes.at(index); // new notes\n            }\n        }\n        return notes;\n    }, []);\n    const onDragEnd = useCallback((e, { right, startX, startY, shift, click, move, startIndex }) => {\n        const { time, beat, lane } = inflate(e);\n        // if right button is pressed, under all circumstances, no matter\n        // whether click or move is true, we delete all the selected notes.\n        // if the last note is not selected, we clear the current selection\n        // and select that note, just as in moves.\n        // A right drag would not be meaningful, the behavior is undefined.\n        if (right) {\n            const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n            if (matched) {\n                let tmpSource = notes;\n                const { index, value: { selected } } = findNotePure(tmpSource, matched.beat, matched.lane);\n                if (!selected) {\n                    tmpSource = clearSelectionPure(tmpSource);\n                    const newIt = tmpSource.at(index);\n                    tmpSource = newIt.update({ ...newIt.value, selected: true });\n                }\n                let tmpNotes = createTree();\n                for (let it = tmpSource.begin; it.valid; it.next()) {\n                    const { key: noteBeat, value: note, value: { selected } } = it;\n                    if (!selected) tmpNotes = tmpNotes.insert(noteBeat, note);\n                }\n                setNotes(tmpNotes);\n            }\n        } else if (click) {\n            // if drag distance is too short that it's considered a click,\n            // we treat it as if the user is selecting a single note\n            let tmpNotes = notes;\n            // if shift was pressed, toggle selection, otherwise replace selection,\n            // hence we have to first clear the current selection\n            if (!shift) tmpNotes = clearSelectionPure(tmpNotes);\n            // if the user clicks on a note, select the note, otherwise clear\n            // selection (as if the user is selecting nothing).\n            const matched = matchNotePure(notes, time2Timers, time, lane, snapThreshold);\n            if (matched) {\n                // toggle selection of the matched note\n                const { beat, lane: matchedLane } = matched;\n                const it = findNotePure(tmpNotes, beat, matchedLane);\n                tmpNotes = it.update({ ...it.value, selected: !it.value.selected });\n            }\n            setNotes(tmpNotes);\n        } else if (move) {\n            // if user is moving notes, we quantize the end point and find the\n            // delta of lanes and beats\n            const { time, lane } = inflate(e);\n            const { beat: quantizedBeat } = quantize(time);\n            let quantizedLane = Math.round(lane);\n            if (quantizedLane < 0) quantizedLane = 0;\n            if (quantizedLane > 6) quantizedLane = 6;\n\n            // update notes\n            // here we simply insert every note into the new tree, moving it if\n            // it's selected. Since a duplicate check (O(logn) for RBTs) precedes\n            // every insertion, the total time complexity would be (O(nlogn)), which\n            // is a fairly high cost and leaves space for optimization.\n            // TODO: optimize this\n            let tmpNotes = createTree();\n\n            // user experience adapted from Adobe Illustrator\n            // if the user starts to move from an unselected note, we first clears\n            // the current selection and selects the starting note, then move it\n            // (as the single selected note). On the contrary, if the starting note\n            // is selected, we simply move the whole selection. This allows the user\n            // to move a note (and select it in the same time) without having to \n            // select anything in advance.\n            // Note that this operation cannot be done when the drag begins, since\n            // it's not yet determined whether the drag will end up as a click, in\n            // which case we should NOT clear the current selection.\n            let tmpSource = notes;\n            // here, we do not simply inflate the starting point to get the starting\n            // beat and lane, since round-off errors will created unexpected results.\n            // instead, we use the index saved when the dragging begins to obtain\n            // the starting note, and use its beat and lane instead.\n            const { key: startBeat, value: { selected, lane: startLane } } = tmpSource.at(startIndex);\n            if (!selected) {\n                tmpSource = clearSelectionPure(tmpSource);\n                const newIt = tmpSource.at(startIndex);\n                tmpSource = newIt.update({ ...newIt.value, selected: true });\n            }\n\n            const deltaBeat = quantizedBeat - startBeat;\n            // if shift was pressed, do not move lanes.\n            const deltaLane = shift ? 0 : quantizedLane - startLane;\n\n            const insert = (beat, note) => {\n                const { lane } = note;\n                // no duplicates. This means that when the move places two notes at\n                // the same position, one of them will be ignored and there's NO\n                // guarentee which one this is.\n                if (!findNotePure(tmpNotes, beat, lane)) tmpNotes = tmpNotes.insert(beat, note);\n            };\n            // traverse through notes, if it's selected, insert it into tmpNotes\n            // after moving, otherwise simply copy it.\n            for (let it = tmpSource.begin; it.valid; it.next()) {\n                const { key: noteBeat, value: note, value: { selected, lane: noteLane } } = it;\n                if (!selected) insert(noteBeat, note);\n                else {\n                    const newBeat = noteBeat + deltaBeat;\n                    // new beat should be non-negative\n                    if (newBeat < 0) continue;\n                    // new lane cannot exceed the [0, 6] range, note that this might\n                    // cause the shape of the selection to change after moving, some\n                    // notes might even disappear, pressing shift will solve the problem.\n                    let newLane = noteLane + deltaLane;\n                    if (newLane < 0) newLane = 0;\n                    if (newLane > 6) newLane = 6;\n                    insert(newBeat, { ...note, lane: newLane });\n                }\n            }\n            setNotes(tmpNotes);\n        } else {\n            // if the user is selecting all notes in the rectangle, we traverse\n            // through all the notes inside the beat range and toggle the selection\n            // status.\n            let tmpNotes = notes;\n            // if shift was pressed, toggle selection, otherwise replace selection,\n            // hence we have to first clear the current selection\n            if (!shift) tmpNotes = clearSelectionPure(tmpNotes);\n            const { beat: beat1, lane: lane1 } = inflate({ clientX: startX, clientY: startY });\n            const beat2 = beat, lane2 = lane;\n            // STAR BEAT ~星の鼓動~\n            const startBeat = Math.min(beat1, beat2), endBeat = Math.max(beat1, beat2);\n            const startLane = Math.min(lane1, lane2), endLane = Math.max(lane1, lane2);\n            tmpNotes = toggleNotesPure(tmpNotes, startBeat, endBeat, startLane, endLane);\n            setNotes(tmpNotes);\n        }\n        // hide drag area and drag line\n        if (dragArea) dragArea.style.visibility = 'hidden';\n        if (dragLine) dragLine.style.visibility = 'hidden';\n    }, [clearSelectionPure, dragArea, dragLine, findNotePure, inflate, matchNotePure, notes, quantize, setNotes, time2Timers, toggleNotesPure]);\n    useDrag({ onDragStart, onDrag, onDragEnd, el: innerEl });\n    \n    return <>\n        <KeyboardEventHandler handleKeys={['v']} onKeyEvent={setSelect}/>\n        <div className={classes.dragArea} ref={setDragArea}/>\n        <div className={classes.dragLine}>\n            <svg width=\"100%\" height=\"100%\">\n                <line stroke=\"#5996FF\" strokeWidth=\"2\" x1=\"100\" x2=\"200\" y1=\"100\" y2=\"200\" ref={setDragLine} style={{ visibility: 'hidden' }}/>\n            </svg>\n        </div>\n    </>;\n}\n\nexport default Select;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nimport Controls from '../ui/Controls';\n\nimport useTool from './useTool';\nimport useScore from './useScore';\nimport useChart from './useChart';\n\nimport Score from './Score';\nimport Bars from './Bars';\nimport Notes from './Notes';\nimport Thumb from './Thumb';\nimport Stencil from './Stencil';\nimport Timers from './Timers';\nimport ThumbTimers from './ThumbTimers';\n\nimport Player from '../tools/Player';\nimport SoundFX from '../tools/SoundFX';\nimport Progress from '../tools/Progress';\nimport PlayerCaret from '../tools/PlayerCaret';\nimport Markers from '../tools/Markers';\nimport Placement from '../tools/Placement';\nimport Divisions from '../tools/Divisions';\nimport PlacementCaret from '../tools/PlacementCaret';\nimport Modification from '../tools/Modification';\nimport PlaceTimer from '../tools/PlaceTimer';\nimport Select from '../tools/Select';\n\nconst useStyles = makeStyles({\n    middle: {\n        position: 'absolute',\n        left: '25%',\n        top: 0,\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'start',\n        alignItems: 'stretch',\n    },\n    right: {\n        position: 'absolute',\n        right: 0,\n        height: '100%',\n        top: 0,\n    },\n});\n\nfunction Chart({ music, score }) {\n    const classes = useStyles();\n\n    const chartParams = useChart({ music, score });\n    const scoreParams = useScore(chartParams);\n    const toolParams = useTool();\n    const params = { music, ...chartParams, ...scoreParams, ...toolParams };\n\n    return <>\n        <div className={classes.middle}>\n            <Score {...params}>\n                <Bars {...params}/>\n                <Timers {...params}/>\n\n                <PlacementCaret {...params}/>\n                <Placement {...params}/>\n\n                <Notes {...params}/>\n\n                <PlayerCaret {...params}/>\n                <Progress {...params}/>\n                <Player {...params}/>\n                <SoundFX {...params}/>\n                <Markers {...params}/>\n\n                <Divisions {...params}/>\n                <Modification  {...params}/>\n                <PlaceTimer {...params}/>\n                <Select {...params}/>\n            </Score>\n            <Controls music={music} {...params}/>\n        </div>\n        <div className={classes.right}>\n            <Thumb {...params}>\n                <Bars {...params} division={1 / 4} thumb={true}/>\n                <ThumbTimers {...params}/>\n                <Notes {...params} thumb={true}/>\n                <Stencil {...params}/>\n            </Thumb>\n        </div>\n    </>;\n};\n\nexport default Chart;\n","import React from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nconst useStyles = makeStyles({\n    middle: {\n        position: 'absolute',\n        left: '25%',\n        top: 0,\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'center',\n        alignItems: 'center',\n        width: 470,\n        fontSize: 28,\n        fontWeight: 'bold',\n        backgroundColor: '#000',\n        color: '#FFF',\n    },\n    right: {\n        position: 'absolute',\n        right: 0,\n        height: '100%',\n        top: 0,\n        width: '11em',\n        fontSize: `${78 / 11}px`,\n        backgroundColor: '#000',\n    },\n});\n\nfunction Loading({ children }) {\n    const classes = useStyles();\n    return <>\n        <div className={classes.middle}>\n            {children}\n        </div>\n        <div className={classes.right}/>\n    </>;\n};\n\nexport default Loading;\n","import React, { useState, useMemo, useEffect, useCallback } from 'react';\nimport { makeStyles } from '@material-ui/styles';\n\nimport Menus from './ui/Menus';\nimport { load } from './chart/storage';\nimport useEvent from './tools/useEvent';\nimport Chart from './chart/Chart';\nimport Loading from './Loading';\n\nconst useStyles = makeStyles({\n  root: {\n    width: '100%',\n    height: '100%',\n  },\n  left: {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n  },\n  middle: {\n    position: 'absolute',\n    left: '25%',\n    top: 0,\n    height: '100%',\n  },\n});\n\nfunction App() {\n  const classes = useStyles();\n\n  const initialScore = useMemo(() => load(), []);\n  const [score, setScore] = useState(initialScore);\n\n  const [musicURL, setMusicURL] = useState(localStorage.getItem('music'));\n  useEffect(() => {\n    if (musicURL) localStorage.setItem('music', musicURL);\n  }, [musicURL]);\n\n  const music = useMemo(() => new Audio(), []);\n  useEffect(() => {\n    music.src = musicURL;\n    music.load();\n  }, [music, musicURL]);\n  const [musicLoaded, setMusicLoaded] = useState(false);\n  const onDurationChange = useCallback(() => setMusicLoaded(music.duration > 0), [music]);\n  useEvent(music, 'durationchange', onDurationChange);\n  const onEmptied = useCallback(() => setMusicLoaded(false), []);\n  useEvent(music, 'emptied', onEmptied);\n\n  const params = { score, setScore, musicURL, setMusicURL, music, musicLoaded };\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.left}>\n        <Menus {...params}/>\n      </div>\n      {musicLoaded ? (\n        <Chart {...params}/>\n      ) : (\n        <Loading>\n          {musicURL === null ? '请先选择歌曲' : '加载中，请稍候'}\n        </Loading>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}