(this.webpackJsonpbetterdori=this.webpackJsonpbetterdori||[]).push([[0],Array(21).concat([function(e,t,n){e.exports=n.p+"static/media/cancel.f8a7f639.svg"},function(e,t,n){e.exports=n.p+"static/media/submit.4360bbde.svg"},function(e,t,n){e.exports=n.p+"static/media/settings.348c169b.svg"},function(e,t,n){e.exports=n.p+"static/media/hamburger.833119f1.svg"},function(e,t,n){e.exports=n.p+"static/media/delete.5075b33e.svg"},function(e,t,n){e.exports=n.p+"static/media/album.5f063155.svg"},function(e,t,n){e.exports=n.p+"static/media/export.2a28091b.svg"},function(e,t,n){e.exports=n.p+"static/media/import.f76106f8.svg"},function(e,t,n){e.exports=n.p+"static/media/select.c1d3a7c6.svg"},function(e,t,n){e.exports=n.p+"static/media/single.710e706e.svg"},function(e,t,n){e.exports=n.p+"static/media/slide-1.9c55945b.svg"},function(e,t,n){e.exports=n.p+"static/media/slide-2.e739354f.svg"},function(e,t,n){e.exports=n.p+"static/media/flick.7b4a2e40.svg"},function(e,t,n){e.exports=n.p+"static/media/timer.593d700f.svg"},function(e,t,n){e.exports=n.p+"static/media/player.07060722.svg"},function(e,t,n){e.exports=n.p+"static/media/pause.9cf9cdb6.svg"},function(e,t,n){e.exports=n.p+"static/media/play.aa3ead50.svg"},function(e,t,n){e.exports=n.p+"static/media/x05.535eb49c.svg"},function(e,t,n){e.exports=n.p+"static/media/x10.bedeac54.svg"},function(e,t,n){e.exports=n.p+"static/media/x15.b4cf543a.svg"},function(e,t,n){e.exports=n.p+"static/media/x20.f8430c66.svg"},function(e,t,n){e.exports=n.p+"static/media/follow.f06e8e66.svg"},function(e,t,n){e.exports=n.p+"static/media/bars.04bc19f8.svg"},function(e,t,n){e.exports=n.p+"static/media/d1.d440bb37.svg"},function(e,t,n){e.exports=n.p+"static/media/d2.70994b05.svg"},function(e,t,n){e.exports=n.p+"static/media/d3.bed3323c.svg"},function(e,t,n){e.exports=n.p+"static/media/d4.9e36ff58.svg"},function(e,t,n){e.exports=n.p+"static/media/d6.0d8fa81a.svg"},function(e,t,n){e.exports=n.p+"static/media/d8.c7296f0f.svg"},function(e,t,n){e.exports=n.p+"static/media/focus.b3b0efea.svg"},function(e,t,n){e.exports=n.p+"static/media/cross.53b51969.svg"},function(e,t,n){e.exports=n.p+"static/media/flick.190f0e5d.mp3"},function(e,t,n){e.exports=n.p+"static/media/tap.343a1b11.mp3"},function(e,t,n){e.exports=n.p+"static/media/marker.0fccf3e6.svg"},,function(e,t,n){e.exports=n(66)},,,,,function(e,t,n){},,,,,function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(16),o=n.n(i),c=(n(61),n(1)),l=n(74),s=n(4),u=n.n(s),m=n(6),d=n(9),f=Object(l.a)({root:{position:"relative",display:"flex",flexDirection:"column",justifyContent:"flex-start",width:"2em"}});var b=function(e){var t=e.children,n=f();return r.a.createElement("div",{className:n.root},t)},v=n(3),p=n(10),h=n(12),g=n.n(h),E=Object(l.a)({root:{width:"2em",height:"2em",cursor:"pointer",userSelect:"none",position:"relative","&:after":{content:"''",position:"absolute",pointerEvents:"none",left:0,top:0,right:0,bottom:0,border:"0px solid black"},"&:hover:after":{borderWidth:5},display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},selected:{backgroundColor:"rgba(0, 0, 0, 0.06)"},icon:{pointerEvents:"none",height:"2em"},alt:{position:"absolute",left:"100%",top:"".concat(100/3,"%"),height:"".concat(100/3,"%"),width:"".concat(100/3,"%"),display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:"#000",color:"#FFF",fontFamily:"D-DIN",fontWeight:"normal",fontSize:"0.6em","& div":{marginBottom:0}}});var j=function(e){var t=e.selected,n=e.onClick,i=e.alt,o=e.icon,l=e.children,s=Object(p.a)(e,["selected","onClick","alt","icon","children"]),u=E(s),m=Object(a.useState)(!1),d=Object(c.a)(m,2),f=d[0],b=d[1];return Object(a.useEffect)((function(){var e=function(e){"Control"===e.key&&b(!0)},t=function(e){"Control"===e.key&&b(!1)};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),function(){window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}}),[]),r.a.createElement("div",{className:g()(u.root,Object(v.a)({},u.selected,t)),onClick:n},o&&r.a.createElement("img",{src:o,alt:"",className:u.icon}),l,f&&i&&r.a.createElement("div",{className:u.alt},r.a.createElement("div",null,i)))},O=n(8),y=[{type:"System",cmd:"BPM",beat:0,bpm:120}],k=function(e){localStorage.setItem("score",JSON.stringify(e))},C=function(){var e=null,t=null,n=function(e,t){var n=[];return e.forEach((function(e,t){var a=t.bpm;n.push({type:"System",cmd:"BPM",beat:e,bpm:a})})),t.forEach((function(e,t){var a=t.lane,r=Object(p.a)(t,["lane"]);n.push(Object(O.a)({type:"Note",beat:e},r,{lane:a+1}))})),n.sort((function(e,t){return e.beat-t.beat})),n};return{submit:function(a,r){e=a,t=r,setTimeout((function(){e===a&&t===r&&(k(n(a,r)),console.log("Score saved!"))}),5e3)},save:function(){k(n(e,t))}}},x=n(75),w=n(20),S=n(21),N=n.n(S),F=n(22),M=n.n(F),D=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(null),o=Object(c.a)(i,2),l=o[0],s=o[1],u=Object(a.useState)(null),m=Object(c.a)(u,2),d=m[0],f=m[1],b=Object(a.useCallback)((function(){return r(!0),new Promise((function(e,t){s((function(){return e})),f((function(){return t}))})).finally((function(){r(!1),s(null),f(null)}))}),[]);return Object(a.useMemo)((function(){return{opened:n,resolve:l,reject:d,open:b}}),[b,n,d,l])},L=Object(l.a)({overlay:{position:"fixed",left:0,top:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:5},sheetContainer:{position:"fixed",left:0,top:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:6,pointerEvents:"none"},sheet:{backgroundColor:"#FFF",padding:"1em",pointerEvents:"auto"},horizontal:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:-10,marginBottom:-10},cell:{marginTop:10,marginBottom:10,display:"block"},title:{fontWeight:"bold",fontSize:"".concat(40/60,"em"),lineHeight:"".concat(1.25,"em"),width:"".concat(12,"em")},input:{outline:"none",border:"none",backgroundColor:"#000",color:"#FFF",fontSize:"".concat(34/60,"em"),lineHeight:"".concat(50/34,"em"),height:"".concat(50/34,"em"),fontFamily:"D-DIN",fontWeight:"normal",paddingLeft:"".concat(10/34,"em"),width:"".concat(320/34,"em")},text:{fontSize:"".concat(32/60,"em"),lineHeight:"".concat(50/32,"em"),height:"".concat(50/32,"em"),fontWeight:"normal",paddingRight:"".concat(1.875,"em")},button:{width:"".concat(2,"em"),height:"".concat(50/60,"em"),backgroundColor:"rgba(0, 0, 0, 0.06)",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",cursor:"pointer",position:"relative","&:hover::after":{content:"''",position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.14)"},border:"none",outline:"none",fontSize:"inherit"},icon:{height:"100%"}}),B=Object(a.createContext)(null);function T(e){var t=e.dialog,n=e.children,i=L(),o=Object(a.useCallback)((function(){t.reject&&t.reject()}),[t]),c=Object(w.a)(),l=Object(a.useMemo)((function(){return Object(O.a)({},t,{form:c})}),[t,c]);return r.a.createElement("form",{onSubmit:c.handleSubmit(t.resolve)},r.a.createElement(B.Provider,{value:l},r.a.createElement(x.a,{in:t.opened,timeout:120,classNames:"fade",mountOnEnter:!0,unmountOnExit:!0},r.a.createElement("div",{className:i.overlay,onClick:o})),n))}function R(e){var t=e.children,n=L(),i=Object(a.useContext)(B).opened;return r.a.createElement(x.a,{in:i,timeout:120,classNames:"scale",mountOnEnter:!0,unmountOnExit:!0},r.a.createElement("div",{className:n.sheetContainer},r.a.createElement("div",{className:n.sheet},t)))}function z(e){var t=e.children,n=L();return r.a.createElement("div",{className:n.horizontal},t)}function H(e){var t=e.el,n=void 0===t?"div":t,a=e.children,i=e.classes,o=e.innerRef,c=Object(p.a)(e,["el","children","classes","innerRef"]),l=L({classes:i});return r.a.createElement(n,Object.assign({className:l.cell,ref:o},c),a)}function K(e){var t=e.children,n=L();return r.a.createElement(H,{classes:{cell:n.title}},t)}function Y(e){var t=e.classes,n=Object(p.a)(e,["classes"]),i=L({classes:t}),o=Object(a.useContext)(B).form.register;return console.log(i.input),r.a.createElement(H,Object.assign({el:"input",classes:{cell:i.input},innerRef:o},n))}function I(e){var t=e.children,n=L();return r.a.createElement(H,{classes:{cell:n.text}},t)}function X(e){var t=L(),n=Object(a.useContext)(B).reject;return r.a.createElement(H,Object.assign({classes:{cell:t.button},onClick:n},e),r.a.createElement("img",{className:t.icon,alt:"Cancel",src:N.a}))}function P(e){var t=L();return r.a.createElement(H,Object.assign({el:"button",type:"submit",classes:{cell:t.button}},e),r.a.createElement("img",{className:t.icon,alt:"Submit",src:M.a}))}var W=n(23),A=n.n(W),q=n(24),$=n.n(q),U=n(25),J=n.n(U),V=n(26),G=n.n(V),Z=n(27),_=n.n(Z),Q=n(28),ee=n.n(Q),te=Object(l.a)({root:{position:"relative",fontSize:40},bpm:{fontSize:"0.8em",lineHeight:1,color:"#000",fontFamily:"D-DIN",fontWeight:"normal"},url:{width:"".concat(560/34,"em"),marginRight:"".concat(80/34,"em")}});var ne=function(e){var t=e.setScore,n=e.musicURL,i=e.setMusicURL,o=te(),c=D(),l=Object(a.useCallback)(Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.open();case 3:t(Object(m.a)(y)),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])}))),[c,t]),s=D(),f=Object(a.useCallback)(Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.open();case 3:t=e.sent,n=t.url,i(n),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])}))),[s,i]);return r.a.createElement("div",{className:o.root},r.a.createElement(b,null,r.a.createElement(j,{icon:$.a}),r.a.createElement(j,{icon:J.a,onClick:l}),r.a.createElement(T,{dialog:c},r.a.createElement(R,null,r.a.createElement(z,null,r.a.createElement("div",null,r.a.createElement(K,null,"\u5220\u9664\u8c31\u9762"),r.a.createElement(I,null,"\u786e\u8ba4\u5220\u9664\u8c31\u9762\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u6062\u590d\u3002")),r.a.createElement("div",null,r.a.createElement(X,null),r.a.createElement(P,null))))),r.a.createElement(j,{icon:G.a,onClick:f}),r.a.createElement(T,{dialog:s},r.a.createElement(R,null,r.a.createElement(z,null,r.a.createElement("div",null,r.a.createElement(K,null,"\u97f3\u9891\u5730\u5740"),r.a.createElement(Y,{name:"url",defaultValue:n,classes:{input:o.url}})),r.a.createElement("div",null,r.a.createElement(X,null),r.a.createElement(P,null))))),r.a.createElement(j,{icon:_.a}),r.a.createElement(j,{icon:ee.a}),r.a.createElement(j,{icon:A.a})))},ae=function(e,t,n){Object(a.useEffect)((function(){if(e){var a=function(e){n&&n(e)};return e.addEventListener(t,a),function(){return e.removeEventListener(t,a)}}}),[e,n,t])},re=Object(l.a)({root:{position:"relative"},container:{position:"absolute",left:"100%",top:0,backgroundColor:"rgba(0, 0, 0, 0.06)"}});var ie=function(e){var t=e.code,n=e.setCode,i=e.matchCode,o=e.children,c=e.index,l=Object(p.a)(e,["code","setCode","matchCode","children","index"]),s=re(),u=Object(a.useCallback)((function(){return n(i)}),[i,n]),m=t===i,d=a.Children.count(o),f=Math.min(d-1,c);return r.a.createElement("div",{className:s.root},r.a.createElement(j,Object.assign({onClick:u,selected:m},l)),m&&r.a.createElement("div",{className:s.container,style:{top:"".concat(-2*f,"em")}},r.a.createElement(b,null,o)))};var oe=function(e){var t=e.state,n=e.setState,i=e.states,o=e.icons,c=Object(p.a)(e,["state","setState","states","icons"]),l=i.indexOf(t),s=Object(a.useCallback)((function(){var e=i[(l+1)%i.length];n(e)}),[l,n,i]);return r.a.createElement(j,Object.assign({onClick:s,selected:!1,icon:o[l]},c))},ce=Object(l.a)({nonactive:{opacity:.35}});var le=function(e){var t=e.state,n=e.setState,i=e.icon,o=ce(),c=Object(a.useCallback)((function(){return n((function(e){return!e}))}),[n]);return r.a.createElement(j,{onClick:c,selected:!1,icon:i,classes:{icon:g()(Object(v.a)({},o.nonactive,!t))}})},se=n(29),ue=n.n(se),me=n(30),de=n.n(me),fe=n(31),be=n.n(fe),ve=n(32),pe=n.n(ve),he=n(33),ge=n.n(he),Ee=n(34),je=n.n(Ee),Oe=n(35),ye=n.n(Oe),ke=n(36),Ce=n.n(ke),xe=n(37),we=n.n(xe),Se=n(38),Ne=n.n(Se),Fe=n(39),Me=n.n(Fe),De=n(40),Le=n.n(De),Be=n(41),Te=n.n(Be),Re=n(42),ze=n.n(Re),He=n(43),Ke=n.n(He),Ye=n(44),Ie=n.n(Ye),Xe=n(45),Pe=n.n(Xe),We=n(46),Ae=n.n(We),qe=n(47),$e=n.n(qe),Ue=n(48),Je=n.n(Ue),Ve=n(49),Ge=n.n(Ve),Ze=Object(l.a)({root:{position:"relative",fontSize:40},bpm:{fontSize:"0.8em",lineHeight:1,color:"#000",fontFamily:"D-DIN",fontWeight:"normal"}});var _e=function(e){var t=e.music,n=e.follow,i=e.setFollow,o=e.setDivision,l=e.code,s=e.setCode,m=e.currentBPM,f=e.setCurrentBPM,v=Ze(),p=Object(a.useState)(t.paused),h=Object(c.a)(p,2),g=h[0],E=h[1],O=Object(a.useCallback)((function(e){e?t.pause():t.play()}),[t]);Object(a.useEffect)((function(){var e=function(){return E(t.paused)};return t.addEventListener("play",e),t.addEventListener("pause",e),function(){t.removeEventListener("play",e),t.removeEventListener("pause",e)}}),[t]);var y=Object(a.useState)(t.playbackRate),k=Object(c.a)(y,2),C=k[0],x=k[1],w=Object(a.useCallback)((function(e){t.playbackRate=e}),[t]);Object(a.useEffect)((function(){var e=function(){return x(t.playbackRate)};return t.addEventListener("ratechange",e),function(){return t.removeEventListener("ratechange",e)}}));var S=Object(a.useCallback)((function(){return o(1)}),[o]),N=Object(a.useCallback)((function(){return o(2)}),[o]),F=Object(a.useCallback)((function(){return o(3)}),[o]),M=Object(a.useCallback)((function(){return o(4)}),[o]),L=Object(a.useCallback)((function(){return o(6)}),[o]),B=Object(a.useCallback)((function(){return o(8)}),[o]),H=D(),I=Object(a.useCallback)(Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.open();case 3:t=e.sent,n=t.bpm,f(n),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])}))),[H,f]);return r.a.createElement("div",{className:v.root},r.a.createElement(b,null,r.a.createElement(ie,{code:l,setCode:s,alt:"E",index:0,matchCode:"select",icon:ue.a}),r.a.createElement(ie,{code:l,setCode:s,alt:"F",index:2,matchCode:"placement/single",icon:de.a}),r.a.createElement(ie,{code:l,setCode:s,alt:"S",index:3,matchCode:"placement/slide-a",icon:be.a}),r.a.createElement(ie,{code:l,setCode:s,alt:"D",index:4,matchCode:"placement/slide-b",icon:pe.a}),r.a.createElement(ie,{code:l,setCode:s,alt:"W",index:5,matchCode:"modification/flick",icon:ge.a}),r.a.createElement(ie,{code:l,setCode:s,alt:"A",index:6,matchCode:"timer",icon:je.a},r.a.createElement(j,{onClick:I},r.a.createElement("div",{className:v.bpm},m))),r.a.createElement(T,{dialog:H},r.a.createElement(R,null,r.a.createElement(z,null,r.a.createElement("div",null,r.a.createElement(K,null,"\u8282\u594f\u6570\u503c"),r.a.createElement(Y,{name:"bpm",defaultValue:m})),r.a.createElement("div",null,r.a.createElement(X,null),r.a.createElement(P,null))))),r.a.createElement(ie,{code:l,setCode:s,index:7,matchCode:"bars",icon:Ke.a},r.a.createElement(j,{alt:"1",onClick:S,icon:Ie.a}),r.a.createElement(j,{alt:"2",onClick:N,icon:Pe.a}),r.a.createElement(j,{alt:"3",onClick:F,icon:Ae.a}),r.a.createElement(j,{alt:"4",onClick:M,icon:$e.a}),r.a.createElement(j,{alt:"6",onClick:L,icon:Je.a}),r.a.createElement(j,{alt:"8",onClick:B,icon:Ge.a})),r.a.createElement(ie,{code:l,setCode:s,alt:"R",index:8,matchCode:"player",icon:ye.a},r.a.createElement(oe,{state:g,setState:O,states:[!1,!0],icons:[Ce.a,we.a]}),r.a.createElement(oe,{state:C,setState:w,states:[.5,1,1.5,2],icons:[Ne.a,Me.a,Le.a,Te.a]}),r.a.createElement(le,{state:n,setState:i,icon:ze.a}))))},Qe=function(){var e=Object(a.useState)("select"),t=Object(c.a)(e,2);return{code:t[0],setCode:t[1]}},et=function(e){var t=e.music.duration,n=e.time2Timers,r=Object(a.useState)(null),i=Object(c.a)(r,2),o=i[0],l=i[1],s=Object(a.useState)(null),u=Object(c.a)(s,2),m=u[0],d=u[1],f=Object(a.useCallback)((function(e){var a=m.getBoundingClientRect(),r=a.x,i=a.y,o=a.height,c=a.width,l=e.clientY-i,s=e.clientX-r,u=(1-l/o)*t,d=n.le(u),f=d.key,b=d.value;return{top:l,left:s,time:u,beat:b.beat+(u-f)/60*b.bpm,lane:s/c*11-2.5,ratioTop:l/o}}),[t,m,n]),b=Object(a.useCallback)((function(e){var t=m.getBoundingClientRect().height,n=e-window.innerHeight;n<0?n=0:e>t&&(n=t-window.innerHeight),o&&(o.scrollTop=n)}),[o,m]),v=Object(a.useCallback)((function(e){var n=e.time,a=e.lane,r=m.getBoundingClientRect(),i=r.x,o=r.y;return{x:i+(a+2.5)/11*r.width,y:o+r.height*(1-n/t)}}),[t,m]);return{containerEl:o,setContainerEl:l,innerEl:m,setInnerEl:d,inflate:f,keepInView:b,deflate:v}},tt=n(11),nt=n.n(tt),at=function(e){var t=Object(a.useState)(e),n=Object(c.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){i(e)}),[e]),[r,i]},rt={follow:!1,division:2,scale:600,bpm:120,progressOffset:180,scrollSpeed:.03,thumbScrollSpeed:.027,scaleSpeed:5e-4,minScale:50,maxScale:2e3};var it=function(e){var t=e.music,n=e.score,r=Object(a.useMemo)((function(){var e=nt()(),t=!0,a=!1,r=void 0;try{for(var i,o=n[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var c=i.value,l=c.type,s=c.cmd,u=c.beat,m=c.bpm;"System"===l&&"BPM"===s&&(e=e.insert(u,{bpm:m}))}}catch(d){a=!0,r=d}finally{try{t||null==o.return||o.return()}finally{if(a)throw r}}return e}),[n]),i=Object(a.useMemo)((function(){var e=nt()(),t=!0,a=!1,r=void 0;try{for(var i,o=n[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var c=i.value,l=c.type,s=c.beat,u=c.lane,m=Object(p.a)(c,["type","beat","lane"]);"Note"===l&&(e=e.insert(s,Object(O.a)({},m,{lane:u-1})))}}catch(d){a=!0,r=d}finally{try{t||null==o.return||o.return()}finally{if(a)throw r}}return e}),[n]),o=at(r),l=Object(c.a)(o,2),s=l[0],u=l[1],m=at(i),d=Object(c.a)(m,2),f=d[0],b=d[1],v=Object(a.useState)(nt()()),h=Object(c.a)(v,2),g=h[0],E=h[1];!function(e){var t=e.timers,n=e.notes,r=Object(a.useMemo)(C,[]),i=r.submit,o=r.save;Object(a.useEffect)((function(){return window.addEventListener("beforeunload",o),function(){return window.removeEventListener("beforeunload",o)}}),[o]),Object(a.useEffect)((function(){i(t,n)}),[n,i,t])}({timers:s,notes:f});var j=Object(a.useMemo)((function(){for(var e=[],n=0,a=s.begin,r=s.at(1);a.hasNext;a.next(),r.next()){var i=a.key,o=a.value.bpm,c=r.key,l=n,u=n+(c-i)/o*60;e.push({time1:l,time2:u,beat1:i,beat2:c,bpm:o}),n=u}var m=s.end,d=m.key,f=m.value.bpm;return e.push({time1:n,time2:t.duration,beat1:d,beat2:(t.duration-n)/60*f+d,bpm:f}),e}),[s,t]),y=Object(a.useMemo)((function(){var e=nt()(),t=!0,n=!1,a=void 0;try{for(var r,i=j[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,c=o.time1,l=o.beat1,s=o.bpm;e=e.insert(c,{beat:l,bpm:s})}}catch(u){n=!0,a=u}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}return e=e.insert(j[j.length-1].time2,{beat:j[j.length-1].beat2})}),[j]),k=Object(a.useMemo)((function(){var e=nt()(),t=!0,n=!1,a=void 0;try{for(var r,i=function(){var t=r.value,n=t.beat1,a=t.beat2,i=t.time1,o=t.bpm;f.forEach((function(t,a){var r=(t-n)/o*60+i;e=e.insert(r,Object(O.a)({},a,{beat:t}))}),n,a)},o=j[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)i()}catch(c){n=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return e}),[j,f]),x=Object(a.useMemo)((function(){var e=nt()(),t=!0,n=!1,a=void 0;try{for(var r,i=function(){var t=r.value,n=t.beat1,a=t.beat2,i=t.time1,o=t.bpm;g.forEach((function(t,a){var r=(t-n)/o*60+i;e=e.insert(r,Object(O.a)({},a,{beat:t}))}),n,a)},o=j[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)i()}catch(c){n=!0,a=c}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return e}),[j,g]),w=Object(a.useState)(rt.division),S=Object(c.a)(w,2),N=S[0],F=S[1],M=Object(a.useState)(rt.follow),D=Object(c.a)(M,2),L=D[0],B=D[1],T=Object(a.useState)(rt.scale),R=Object(c.a)(T,2),z=R[0],H=R[1],K=Object(a.useCallback)((function(e){var t=y.le(e),n=t.key,a=t.value,r=a.bpm,i=a.beat,o=y.gt(e).value.beat,c=i+Math.round((e-n)/60*r*N)/N;c>o&&(c=o);var l=n+(c-i)/r*60;return{beat:c,time:l,bpm:r,delta:Math.abs(l-e)/60*r*N}}),[N,y]),Y=Object(a.useCallback)((function(e){var t=k.le(e),n=t.valid,a=t.index;return n?a+1:0}),[k]),I=Object(a.useCallback)((function(e,t,n){for(var a=e.ge(t);a.valid&&a.key===t;a.next())if(a.value.lane===n)return a;return null}),[]),X=Object(a.useCallback)((function(e,t){return I(f,e,t)}),[I,f]),P=Object(a.useCallback)((function(e,t){k.forEach((function(n,a){if(t){for(var r in t)if(t[r]!==a[r])return;e(n,a)}}))}),[k]),W=Object(a.useCallback)((function(e){for(var t=k.begin;t.valid;){var n=t.key,a=[];do{a.push(t.value),t.next()}while(t.key<=n&&t.valid);e(n,a)}}),[k]),A=Object(a.useCallback)((function(e,t,n,a,r){var i,o=t.le(n),c=o.key,l=o.value,s=l.beat,u=l.bpm,m=s+(n-c)/60*u,d=r*r,f=NaN;return e.forEach((function(e,t){var n=t.lane,r=Math.pow((n-a)/8,2)+Math.pow(e-m,2);r<d&&(d=r,i=e,f=n)}),m-r,m+r),isNaN(f)?null:{beat:i,lane:f,time:c+(i-s)/u*60}}),[]),q=Object(a.useCallback)((function(e,t,n){return A(f,y,e,t,n)}),[A,f,y]),$=Object(a.useState)(rt.bpm),U=Object(c.a)($,2),J=U[0],V=U[1];return Object(O.a)({music:t,timers:s,setTimers:u,notes:f,setNotes:b,markers:g,setMarkers:E,ranges:j,time2Timers:y,time2Notes:k,time2Markers:x},rt,{division:N,setDivision:F,follow:L,setFollow:B,scale:z,setScale:H,currentBPM:J,setCurrentBPM:V,quantize:K,countNotes:Y,findNotePure:I,findNote:X,forEachNote:P,forEachGroup:W,matchNotePure:A,matchNote:q})};function ot(e){var t=0,n=0,a=0,r=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),a=10*t,r=10*n,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||r)&&e.deltaMode&&(1===e.deltaMode?(a*=40,r*=40):(a*=800,r*=800)),a&&!t&&(t=a<1?-1:1),r&&!n&&(n=r<1?-1:1),{spinX:t,spinY:n,pixelX:a,pixelY:r}}var ct=Object(l.a)({root:{position:"relative",width:"11em",fontSize:"".concat(470/11,"px"),height:"100%",backgroundColor:"#000000",overflow:"hidden"},inner:{position:"absolute",left:0,top:0,width:"100%",height:5e3}});var lt=function(e){var t=e.music,n=e.scale,i=e.setScale,o=e.scaleSpeed,c=e.minScale,l=e.maxScale,s=e.scrollSpeed,u=e.containerEl,m=e.setContainerEl,d=e.innerEl,f=e.setInnerEl,b=e.children,v=ct(),p=Object(a.useCallback)((function(e){if(u){var a=ot(e.nativeEvent).pixelY;if(e.ctrlKey){var r=n*t.duration,m=(e.clientY+u.scrollTop)/r,d=n*(1-a*o);d<c&&(d=c),d>l&&(d=l);var f=d*t.duration,b=m*f-e.clientY;b<0&&(b=0),b+window.innerHeight>f&&(b=f-window.innerHeight),u.scrollTop=b,i(d)}else{var v=n*t.duration,p=u.scrollTop+a*s*Math.sqrt(n);p<0&&(p=0),p+window.innerHeight>v&&(p=v-window.innerHeight),u.scrollTop=p}}}),[u,n,t.duration,o,c,l,i,s]);Object(a.useEffect)((function(){var e=function(e){if(e.ctrlKey)return e.stopPropagation(),e.preventDefault(),!1};return window.addEventListener("wheel",e,{passive:!1}),function(){return window.removeEventListener("wheel",e)}}),[]),Object(a.useEffect)((function(){if(d&&u){var e=d.getBoundingClientRect().height;u.scrollTop=e-window.innerHeight}}),[u,d]);var h=Object(a.useCallback)((function(e){e.preventDefault(),e.stopPropagation()}),[]);return r.a.createElement("div",{ref:m,className:v.root,onWheel:p,onContextMenu:h},r.a.createElement("div",{ref:f,style:{height:t.duration*n},className:v.inner},b))},st=Object(l.a)({root:{position:"absolute",height:"100%",width:"".concat(7/11*100,"%"),left:"".concat(2/11*100,"%"),opacity:.5,"&$thumb":{opacity:.3}},lanes:{position:"absolute",left:0,top:0,width:"100%",height:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"},sideLane:{width:0,borderRight:"5px solid #FFF",marginRight:-2,marginLeft:-2},middleLane:{width:0,borderRight:"1px solid #FFF"},bar:{position:"absolute",left:0,width:"100%",borderBottom:"1px dashed rgba(255, 255, 255, 0.6)"},major:{borderBottom:"1px solid #FFF"},thumb:{}});var ut=function(e){var t=e.music.duration,n=e.ranges,i=e.division,o=e.thumb,c=void 0!==o&&o,l=st(),s=Object(a.useMemo)((function(){var e=[],a=!0,o=!1,c=void 0;try{for(var s,u=n[Symbol.iterator]();!(a=(s=u.next()).done);a=!0)for(var m=s.value,d=m.beat1,f=m.beat2,b=m.bpm,p=m.time1,h=d;h<f;h+=1/i){var E=h-d,j=p+E/b*60,O=Math.abs(Math.round(E)-E)<1e-5;e.push(r.a.createElement("div",{key:j,className:g()(l.bar,Object(v.a)({},l.major,O)),style:{bottom:"".concat(j/t*100,"%")}}))}}catch(y){o=!0,c=y}finally{try{a||null==u.return||u.return()}finally{if(o)throw c}}return e}),[n,t,i,l]);return r.a.createElement("div",{className:g()(l.root,Object(v.a)({},l.thumb,c))},r.a.createElement("div",{className:l.lanes},r.a.createElement("div",{className:c?l.middleLane:l.sideLane}),r.a.createElement("div",{className:l.middleLane}),r.a.createElement("div",{className:l.middleLane}),r.a.createElement("div",{className:l.middleLane}),r.a.createElement("div",{className:l.middleLane}),r.a.createElement("div",{className:l.middleLane}),r.a.createElement("div",{className:l.middleLane}),r.a.createElement("div",{className:c?l.middleLane:l.sideLane})),s)},mt=n(50),dt=n.n(mt),ft=n(51),bt=n.n(ft),vt=Object(l.a)({root:{position:"absolute",height:"100%",width:"".concat(7/11*100,"%"),left:"".concat(2/11*100,"%")},note:{width:"1em",height:"1em",borderRadius:"50%",position:"absolute",marginBottom:"-0.5em","&$focusable:hover $focus":{visibility:"initial"},"&$thumb":{transform:"scale(0.5)"},boxSizing:"border-box","&$selected":{border:"4px solid #5996FF"},"&$middle":{border:"none"}},focusable:{cursor:"pointer"},focus:{position:"absolute",width:"1.4em",height:"1.4em",left:"-0.2em",top:"-0.2em",pointerEvents:"none",visibility:"hidden",userSelect:"none"},single:{backgroundColor:"#FFF"},slide:{backgroundColor:"#7ADEAE"},flick:{backgroundColor:"#FFA0E8","&:after":{content:"''",position:"absolute",left:"50%",top:"50%",width:0,height:0,borderLeft:"".concat(10/60,"em solid transparent"),borderRight:"".concat(10/60,"em solid transparent"),borderBottom:"".concat(16.739/60,"em solid #FFF"),borderTop:"none",marginLeft:"-".concat(10/60,"em"),marginTop:"-".concat(16.739/60/2,"em")},"&$thumb:after":{visibility:"hidden"}},middle:{"&:after":{content:"''",position:"absolute",left:0,right:0,bottom:"50%",borderBottom:"3px solid #7ADEAE",marginBottom:-1.5},"&$middleSelected:after":{borderBottom:"3px solid #5996FF"},"&$thumb:after":{opacity:.6}},tapLine:{position:"absolute",marginLeft:"1em",marginRight:0,height:0,marginBottom:-1.5,borderBottom:"3px solid #FFF"},snake:{position:"absolute",left:0,right:0,display:"flex"},thumb:{},selected:{position:"absolute",height:"100%",left:0,top:0,pointerEvents:"none",userSelect:"none",zIndex:2},middleSelected:{}});function pt(e){var t,n=e.time,a=e.duration,i=e.lane,o=e.note,c=e.flick,l=e.start,s=e.end,u=e.code,m=e.thumb,d=e.selected,f=vt(),b="Single"===o,p="Slide"===o,h=l||s,E=!m&&(u.startsWith("placement/")||u.startsWith("modification/")||"select"===u),j=p&&!h,O="select"===u;return r.a.createElement("div",{className:g()(f.note,(t={},Object(v.a)(t,f.single,b&&!c),Object(v.a)(t,f.slide,p&&h&&!c),Object(v.a)(t,f.flick,c),Object(v.a)(t,f.middle,j),Object(v.a)(t,f.focusable,E),Object(v.a)(t,f.thumb,m),Object(v.a)(t,f.middleSelected,j&&d&&O),t)),style:{bottom:"".concat(n/a*100,"%"),left:"".concat(i/7*100,"%")}},r.a.createElement("img",{className:f.focus,alt:"focus",src:dt.a}),!m&&d&&!j&&O&&r.a.createElement("img",{className:f.selected,alt:"selected",src:bt.a}))}function ht(e){var t=e.x0,n=e.x1,a=e.y0,i=e.y1,o=(e.thumb,vt());return r.a.createElement("div",{className:o.snake,style:{bottom:"".concat(100*a,"%"),top:"".concat(100*(1-i),"%")}},r.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 7 1",preserveAspectRatio:"none"},r.a.createElement("polygon",{fill:"rgba(122, 222, 174, 0.4)",strokeWidth:"0",points:"".concat(t,",1 ").concat(t+1,",1 ").concat(n+1,",0 ").concat(n,",0")})))}var gt=function(e){var t=e.time2Notes,n=e.music.duration,i=e.notes,o=e.setNotes,c=e.findNote,l=e.forEachNote,s=e.forEachGroup,u=e.code,d=e.thumb,f=void 0!==d&&d,b=vt(),v=Object(a.useMemo)((function(){var e=[];return f||["A","B"].forEach((function(t){var a=0,i=-1;l((function(o,c){var l=c.lane,s=c.end;if(-1!==i){var u=o/n;e.push(r.a.createElement(ht,{key:"snake-".concat(a,"-").concat(u,"-").concat(t),x0:i,x1:l,y0:a,y1:u}))}i=s?-1:l,a=o/n}),{pos:t,note:"Slide"})})),e}),[n,l,f]),p=Object(a.useMemo)((function(){var e=[];return f||s((function(t,a){var i=8,o=-1,c=!0,l=!1,s=void 0;try{for(var u,m=a[Symbol.iterator]();!(c=(u=m.next()).done);c=!0){var d=u.value,f=d.lane,v=d.note,p=d.start,h=d.end;("Slide"!==v||p||h)&&(i=Math.min(i,f),o=Math.max(o,f))}}catch(g){l=!0,s=g}finally{try{c||null==m.return||m.return()}finally{if(l)throw s}}i<o-1&&e.push(r.a.createElement("div",{key:"tap-line-".concat(t),className:b.tapLine,style:{bottom:"".concat(t/n*100,"%"),left:"".concat(i/7*100,"%"),right:"".concat((7-o)/7*100,"%")}}))})),e}),[b,n,s,f]),h=Object(a.useMemo)((function(){var e=[];return t.forEach((function(t,a){e.push(r.a.createElement(pt,Object.assign({key:"note-".concat(a.beat,"-").concat(a.lane),time:t,duration:n,notes:i,setNotes:o,findNote:c,code:u,thumb:f},a)))})),e}),[u,n,c,i,o,t,f]),g=Object(a.useMemo)((function(){return[].concat(Object(m.a)(v),Object(m.a)(p),Object(m.a)(h))}),[v,p,h]);return r.a.createElement("div",{className:b.root},g)},Et=function(e){var t=e.onDragStart,n=e.onDrag,r=e.onDragEnd,i=e.el,o=Object(a.useMemo)((function(){return{left:!1,right:!1,dragging:!1,shift:!1,lestX:0,lastY:0,startX:0,startY:0}}),[]),c=Object(a.useCallback)((function(e){if((0===e.button&&(o.left=!0),2===e.button&&(o.right=!0),o.shift=e.shiftKey,o.lastX=e.clientX,o.lastY=e.clientY,o.startX=e.clientX,o.startY=e.clientY,!o.dragging)&&(o.dragging=!0,t&&!1===t(e,o)))return void(o.left=o.right=o.dragging=!1);e.preventDefault(),e.stopPropagation()}),[t,o]),l=Object(a.useCallback)((function(e){if(o.shift=e.shiftKey,o.dragging){var t=Math.round(Math.abs(e.clientY-o.lastY)/15);0===t&&(t=1);for(var a=1;a<=t;++a){var r=a/t,i=o.lastX+(e.clientX-o.lastX)*r,c=o.lastY+(e.clientY-o.lastY)*r;n&&n({clientX:i,clientY:c},o)}o.lastX=e.clientX,o.lastY=e.clientY}e.preventDefault(),e.stopPropagation()}),[n,o]),s=Object(a.useCallback)((function(e){o.dragging&&(r&&r(e,o),o.dragging=!1),0===e.button&&(o.left=!1),2===e.button&&(o.right=!1),e.preventDefault(),e.stopPropagation()}),[r,o]);Object(a.useEffect)((function(){if(i)return i.addEventListener("mousedown",c),i.addEventListener("mousemove",l),i.addEventListener("mouseup",s),function(){i.removeEventListener("mousedown",c),i.removeEventListener("mousemove",l),i.removeEventListener("mouseup",s)}}),[i,c,l,s])},jt=Object(l.a)({root:{position:"relative",backgroundColor:"#000000",width:"11em",fontSize:"".concat(78/11,"px"),right:0,top:0,height:"100%",overflow:"hidden"}});var Ot=function(e){var t=e.children,n=e.scale,i=e.music.duration,o=e.containerEl,l=e.innerEl,s=e.thumbScrollSpeed,u=jt(),m=Object(a.useState)(null),d=Object(c.a)(m,2),f=d[0],b=d[1],v=Object(a.useCallback)((function(e,t){var a=t.left;if(o&&l&&a){var r=e.clientY/window.innerHeight*i,c=window.innerHeight/n,s=l.getBoundingClientRect().height,u=(r-c/2)/i*s;u<0&&(u=0),u+window.innerHeight>s&&(u=s-window.innerHeight),o.scrollTop=u}}),[o,i,l,n]);Et({onDrag:v,onDragEnd:v,el:f});var p=Object(a.useCallback)((function(e){if(o&&l){var t=ot(e.nativeEvent).pixelY,a=l.getBoundingClientRect().height,r=o.scrollTop/a*window.innerHeight,i=window.innerHeight/n,c=r+t*s;c<0&&(c=0),c+i>window.innerHeight&&(c=window.innerHeight-i);var u=c/window.innerHeight*a;o.scrollTop=u}}),[o,l,n,s]);return r.a.createElement("div",{className:u.root,ref:b,onWheel:p},t)},yt=function(e){Object(a.useEffect)((function(){var t=!0;return requestAnimationFrame((function n(){e&&e(),t&&requestAnimationFrame(n)})),function(){t=!1}}),[e])},kt=Object(l.a)({stencil:{position:"absolute",left:0,width:"100%",backgroundColor:"rgba(0, 0, 0, 0.65)",pointerEvents:"none"}});var Ct=function(e){var t=e.innerEl,n=e.containerEl,i=kt(),o=Object(a.useState)(null),l=Object(c.a)(o,2),s=l[0],u=l[1],m=Object(a.useState)(null),d=Object(c.a)(m,2),f=d[0],b=d[1],v=Object(a.useCallback)((function(){if(t){var e=t.getBoundingClientRect().height,a=n.scrollTop/e,r=(n.scrollTop+window.innerHeight)/e;s&&(s.style.bottom="".concat(100*(1-a),"%")),f&&(f.style.top="".concat(100*r,"%"))}}),[t,n,s,f]);return yt(v),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{ref:u,className:i.stencil,style:{top:0}}),r.a.createElement("div",{ref:b,className:i.stencil,style:{bottom:0}}))},xt=Object(l.a)({root:{position:"absolute",height:"100%",left:"".concat(2/11*100,"%"),right:"".concat(2/11*100,"%")},timer:{position:"absolute",left:0,right:0,height:"0.6em",marginBottom:"-0.3em","&:after":{content:"''",position:"absolute",left:0,right:0,bottom:"50%",borderBottom:"3px solid #FFCD18",marginBottom:-1.5,pointerEvents:"none"}},bpm:{position:"absolute",left:"100%",top:"50%",marginTop:"-0.5em",paddingLeft:"0.25em",fontSize:"0.6em",lineHeight:1,color:"#FFCD18",fontFamily:"D-DIN",fontWeight:"normal",willChange:"opacity"},lastBPM:{willChange:"opacity",position:"fixed",left:"calc(25vw + ".concat(15,"em)"),bottom:0,marginLeft:"0.25em",paddingBottom:"0.6em",fontSize:"0.6em",lineHeight:1,color:"#FFCD18",fontFamily:"D-DIN",fontWeight:"normal","&:after":{content:"''",position:"absolute",left:"50%",bottom:"0.25em",width:0,height:0,marginLeft:"-0.2em",borderTop:"0.2em solid #FFCD18",borderLeft:"0.2em solid transparent",borderRight:"0.2em solid transparent"}}});function wt(e){var t=e.time,n=e.bpm,i=e.duration,o=e.observer,l=xt(),s=Object(a.useState)(null),u=Object(c.a)(s,2),m=u[0],d=u[1];return Object(a.useEffect)((function(){if(m)return o.observe(m),function(){return o.unobserve(m)}}),[m,o]),r.a.createElement("div",{ref:d,className:l.timer,style:{bottom:"".concat(t/i*100,"%")}},r.a.createElement("div",{className:l.bpm},n))}var St=function(e){var t=e.time2Timers,n=e.music.duration,i=e.containerEl,o=e.innerEl,l=xt(),s=Object(a.useCallback)((function(e){var t=!0,n=!1,a=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,c=o.boundingClientRect,l=c.top,s=c.bottom;o.target.style.opacity=(l+s)/2<window.innerHeight?1:0}}catch(u){n=!0,a=u}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}}),[]),u=Object(a.useMemo)((function(){return new IntersectionObserver(s,{threshold:.5})}),[s]);Object(a.useEffect)((function(){if(u)return function(){return u.disconnect()}}),[u]);var m=Object(a.useMemo)((function(){var e=[];return t.forEach((function(t,a){var i=a.beat,o=a.bpm;e.push(r.a.createElement(wt,{key:i,time:t,bpm:o,duration:n,observer:u}))})),e}),[t,n,u]),d=Object(a.useState)(null),f=Object(c.a)(d,2),b=f[0],v=f[1],p=Object(a.useCallback)((function(){if(i&&o&&b){var e=o.getBoundingClientRect(),a=e.height,r=e.width,c=Math.max((1-(i.scrollTop+window.innerHeight)/a)*n,0),l=r/11,s=t.gt(c),u=s.key;if(s.valid&&u-c<1.25*l/a*n)b.style.opacity=0;else{b.style.opacity=1;var m=t.le(c).value.bpm;b.innerHTML="".concat(m)}}}),[i,n,o,b,t]);return yt(p),r.a.createElement("div",{className:l.root},m,r.a.createElement("div",{className:l.lastBPM,ref:v}))},Nt=Object(l.a)({root:{position:"absolute",height:"100%",left:"".concat(2/11*100,"%"),right:"".concat(2/11*100,"%")},timer:{position:"absolute",left:0,right:0,height:0,borderBottom:"1px solid #FFCD18",marginBottom:-.5}});function Ft(e){var t=e.time,n=e.duration,a=Nt();return r.a.createElement("div",{className:a.timer,style:{bottom:"".concat(t/n*100,"%")}})}var Mt=function(e){var t=e.time2Timers,n=e.music.duration,i=Nt(),o=Object(a.useMemo)((function(){var e=[];return t.forEach((function(t,a){var i=a.beat;e.push(r.a.createElement(Ft,{key:i,time:t,duration:n}))})),e}),[t,n]);return r.a.createElement("div",{className:i.root},o)},Dt=n(5),Lt=n.n(Dt);var Bt=function(e){var t=e.music,n=e.code,i=e.setCode,o=Object(a.useCallback)((function(e,n){t.paused?t.play():t.pause(),n.stopPropagation(),n.preventDefault()}),[t]),c=Object(a.useCallback)((function(){return i("player")}),[i]);return Object(a.useEffect)((function(){"player"!==n&&t.pause()}),[n,t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt.a,{handleKeys:["r"],onKeyEvent:c}),r.a.createElement(Lt.a,{isDisabled:"player"!==n,handleKeys:["space"],onKeyEvent:o}))},Tt=n(17),Rt=n(52),zt=n.n(Rt),Ht=n(53),Kt=n.n(Ht);var Yt=function(e){var t=e.music,n=e.time2Notes,i=Object(a.useMemo)((function(){return new Tt.Howl({src:[Kt.a]})}),[]),o=Object(a.useMemo)((function(){return new Tt.Howl({src:[zt.a]})}),[]),c=Object(a.useRef)(0),l=Object(a.useCallback)((function(){if(!t.paused){var e=!1,a=!1;n.forEach((function(t,n){n.flick?a=!0:e=!0}),c.current,t.currentTime),c.current=t.currentTime,e&&i.play(),a&&o.play()}}),[o,t,i,n]);return yt(l),r.a.createElement("div",null)},It=Object(l.a)({root:{position:"absolute",left:0,width:"100%",height:0,borderBottom:"3px solid #ff4e67",marginTop:-1.5}});var Xt=function(e){var t=e.music,n=e.innerEl,i=e.follow,o=e.progressOffset,l=e.code,s=e.keepInView,u=e.inflate,m=It(),d=Object(a.useState)(null),f=Object(c.a)(d,2),b=f[0],v=f[1],p=Object(a.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!t.paused){var a=n.getBoundingClientRect().height,r=t.currentTime/t.duration,c=(1-r)*a;i&&!e&&s(c+o);var l=c/a;b&&(b.style.top="".concat(100*l,"%"))}}),[b,n,t,i,s,o]);yt(p);var h=Object(a.useCallback)((function(e){if("player"===l){var n=u(e).time;t.currentTime=n,t.paused&&t.play(),p(!0)}}),[l,u,t,p]);return ae(n,"click",h),Object(a.useEffect)(p,[p,l]),"player"===l&&r.a.createElement("div",{ref:v,className:m.root})},Pt=Object(l.a)({root:{position:"absolute",left:"".concat(2/11*100,"%"),right:"".concat(2/11*100,"%"),height:0,borderBottom:"3px solid #5996FF",marginTop:-1.5,pointerEvents:"none"},notesCounter:{position:"absolute",right:"100%",top:0,marginTop:"-0.5em",paddingRight:"0.25em",fontSize:"0.6em",lineHeight:1,color:"#5996FF",fontFamily:"D-DIN",fontWeight:"normal"}});var Wt=function(e){var t=e.inflate,n=e.innerEl,i=e.countNotes,o=e.code,l=Pt(),s=Object(a.useState)(null),u=Object(c.a)(s,2),m=u[0],d=u[1],f=Object(a.useState)(null),b=Object(c.a)(f,2),v=b[0],p=b[1],h=Object(a.useCallback)((function(e){var n=t(e),a=n.ratioTop,r=n.time;m&&(m.style.top="".concat(100*a,"%")),v&&(v.innerHTML="".concat(i(r)))}),[m,v,t,i]);return ae(n,"mousemove",h),"player"===o&&r.a.createElement("div",{ref:d,className:l.root},r.a.createElement("div",{ref:p,className:l.notesCounter}))},At=n(54),qt=n.n(At),$t=Object(l.a)({root:{position:"absolute",height:"100%",left:"".concat(9/11*100,"%"),width:"".concat(2/11*100,"%")},marker:{position:"absolute",left:"".concat(1/6,"em"),height:"0.53em",marginBottom:"-".concat(.265,"em"),cursor:"pointer",transition:"transform 80ms cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateX(15%)"}}});var Ut=function(e){var t=e.time2Markers,n=e.markers,i=e.setMarkers,o=e.music,c=e.quantize,l=e.code,s=$t(),u=Object(a.useCallback)((function(e){var t=e.target.getAttribute("data-beat");i(n.remove(t))}),[n,i]),m=Object(a.useCallback)((function(e){var t=e.target.getAttribute("data-time");o.currentTime=t,e.preventDefault(),e.stopPropagation()}),[o]),d=Object(a.useMemo)((function(){var e=[];return t.forEach((function(t,n){var a=n.beat;e.push(r.a.createElement("img",{key:a,className:s.marker,style:{bottom:"".concat(t/o.duration*100,"%")},src:qt.a,alt:"marker","data-beat":a,"data-time":t,onContextMenu:u,onClick:m}))})),e}),[t,s,o,u,m]),f=Object(a.useCallback)((function(){var e=c(o.currentTime).beat;n.find(e).valid||i(n.insert(e,{}))}),[n,o,c,i]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt.a,{isDisabled:"player"!==l,handleKeys:["e"],onKeyEvent:f}),r.a.createElement("div",{className:s.root},d))},Jt=function(e,t){var n=e.notes,r=e.setNotes,i=e.inflate,o=e.code,c=e.findNotePure,l=e.matchNotePure,s=e.time2Timers,u=e.quantize,m=e.innerEl,d=t.prefix,f=t.useRemove,b=void 0===f||f,v=t.type,p=t.onClick,h=t.quantizeThreshold,g=void 0===h?.25:h,E=t.snapThreshold,j=void 0===E?.1:E,O=Object(a.useRef)(n);Object(a.useEffect)((function(){O.current=n}),[n]);var y=Object(a.useRef)(o);Object(a.useEffect)((function(){y.current=o}),[o]);var k=Object(a.useCallback)((function(){if(!o.startsWith(d))return!1}),[o,d]),C=Object(a.useCallback)((function(e,t){var n=t.shift,a=t.left,m=t.right,d=O.current,f=function(e){r(e),O.current=e};if(n){if(a)switch(v){case"quantize":var h=i(e),E=h.time,y=h.lane,k=u(E),C=k.beat;if(k.delta>g)return;var x=Math.round(y);if(x<0||x>=7)return;p(o,d,c,f,C,x,!1);break;case"snap":var w=i(e),S=w.time,N=w.lane,F=l(d,s,S,N,j);if(!F)return;var M=F.beat,D=F.lane;p(o,d,c,f,M,D,!1)}if(b&&m){var L=i(e),B=L.time,T=L.lane,R=l(d,s,B,T,j);if(!R)return;var z=R.beat,H=R.lane,K=c(d,z,H);K&&f(K.remove())}}}),[o,s,c,u,i,r,l,v,b,p,g,j]),x=Object(a.useCallback)((function(e,t){var n=t.shift,a=t.left,m=t.right,d=O.current;if(!n){var f=i(e),h=f.time,E=f.lane;if(a)switch(v){case"quantize":var y=i(e),k=y.time,C=y.lane,x=u(k),w=x.beat;if(x.delta>g)return;var S=Math.round(C);if(S<0||S>=7)return;p(o,d,c,r,w,S,!0);break;case"snap":var N=i(e),F=N.time,M=N.lane,D=l(d,s,F,M,j);if(!D)return;var L=D.beat,B=D.lane;p(o,d,c,r,L,B,!0)}if(b&&m){var T=l(d,s,h,E,j);if(!T)return;var R=T.beat,z=T.lane,H=c(d,R,z);H&&r(H.remove())}}}),[o,s,c,i,l,u,r,v,b,p,g,j]);Et({onDragStart:k,onDrag:C,onDragEnd:x,el:m})},Vt=function(e,t,n,a,r,i,o){switch(e){case"placement/single":if(n(t,r,i))break;a(t.insert(r,{note:"Single",lane:i}));break;case"placement/slide-a":case"placement/slide-b":var c=e.substring(e.length-1).toUpperCase(),l=n(t,r,i);if(l){if(o){var s=l.value,u=s.note,m=s.pos,d=s.end,f=s.start;if("Slide"!==u||m!==c)break;a(l.update({lane:i,pos:c,note:"Slide",flick:!1,start:!1,end:!(d||f)}))}}else{for(var b=!0,v=t.lt(r);v.valid;v.prev()){var p=v.value,h=p.note,g=p.pos,E=p.end;if("Slide"===h&&g===c){E||(b=!1);break}}a(t.insert(r,{lane:i,pos:c,note:"Slide",flick:!1,start:b,end:!1}))}}};var Gt=function(e){var t=e.setCode,n=Object(a.useCallback)((function(){return t("placement/single")}),[t]),i=Object(a.useCallback)((function(){return t("placement/slide-a")}),[t]),o=Object(a.useCallback)((function(){return t("placement/slide-b")}),[t]);return Jt(e,{prefix:"placement/",type:"quantize",onClick:Vt}),r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt.a,{handleKeys:["f"],onKeyEvent:n}),r.a.createElement(Lt.a,{handleKeys:["s"],onKeyEvent:i}),r.a.createElement(Lt.a,{handleKeys:["d"],onKeyEvent:o}))};var Zt=function(e){var t=e.setDivision,n=Object(a.useCallback)((function(){return t(1)}),[t]),i=Object(a.useCallback)((function(){return t(2)}),[t]),o=Object(a.useCallback)((function(){return t(3)}),[t]),c=Object(a.useCallback)((function(){return t(4)}),[t]),l=Object(a.useCallback)((function(){return t(6)}),[t]),s=Object(a.useCallback)((function(){return t(8)}),[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt.a,{handleKeys:["1"],onKeyEvent:n}),r.a.createElement(Lt.a,{handleKeys:["2"],onKeyEvent:i}),r.a.createElement(Lt.a,{handleKeys:["3"],onKeyEvent:o}),r.a.createElement(Lt.a,{handleKeys:["4"],onKeyEvent:c}),r.a.createElement(Lt.a,{handleKeys:["6"],onKeyEvent:l}),r.a.createElement(Lt.a,{handleKeys:["8"],onKeyEvent:s}))},_t=Object(l.a)({root:{position:"absolute",left:"".concat(2/11*100,"%"),right:"".concat(2/11*100,"%"),height:0,borderBottom:"3px solid #5996FF",marginBottom:-1.5,pointerEvents:"none"},notesCounter:{position:"absolute",right:"100%",top:0,marginTop:"-0.5em",paddingRight:"0.25em",fontSize:"0.6em",lineHeight:1,color:"#5996FF",fontFamily:"D-DIN",fontWeight:"normal"}});var Qt=function(e){var t=e.music.duration,n=e.innerEl,i=e.quantize,o=e.inflate,l=e.code,s=_t(),u=Object(a.useState)(null),m=Object(c.a)(u,2),d=m[0],f=m[1],b=Object(a.useState)(null),v=Object(c.a)(b,2),p=v[0],h=v[1],g=Object(a.useCallback)((function(e){var n=o(e).time,a=i(n),r=a.time,c=a.beat;d&&(d.style.bottom="".concat(r/t*100,"%")),p&&(p.innerHTML="".concat(c.toFixed(2),"'"))}),[o,i,d,t,p]);return ae(n,"mousemove",g),(l.startsWith("placement/")||l.startsWith("modification/")||"timer"===l)&&r.a.createElement("div",{ref:f,className:s.root},r.a.createElement("div",{ref:h,className:s.notesCounter}))},en=function(e,t,n,a,r,i){switch(e){case"modification/flick":var o=n(t,r,i);if(!o)break;var c=o.value,l=o.value,s=l.flick,u=l.note,m=l.end;if("Slide"===u&&!m)break;a(o.update(Object(O.a)({},c,{flick:!s})))}};var tn=function(e){var t=e.setCode;Jt(e,{prefix:"modification/",type:"snap",onClick:en});var n=Object(a.useCallback)((function(){return t("modification/flick")}),[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt.a,{handleKeys:["w"],onKeyEvent:n}))};var nn=function(e){var t=e.code,n=e.innerEl,i=e.setCode,o=e.inflate,c=e.quantize,l=e.timers,s=e.setTimers,u=e.currentBPM,m=Object(a.useCallback)((function(){return i("timer")}),[i]),d=Object(a.useCallback)((function(e){if("timer"===t){var n=o(e).time,a=c(n).beat,r=l.find(a);r.valid?s(r.update({bpm:u})):s(l.insert(a,{bpm:u}))}}),[t,u,o,c,s,l]);ae(n,"click",d);var f=Object(a.useCallback)((function(e){if("timer"===t){var n=o(e).time,a=c(n).beat,r=l.find(a);r.valid&&s(r.remove())}}),[t,o,c,s,l]);return ae(n,"contextmenu",f),r.a.createElement(Lt.a,{handleKeys:["a"],onKeyEvent:m})},an=Object(l.a)({dragArea:{position:"fixed",backgroundColor:"rgba(89, 150, 255, 0.4)",border:"1px solid #5996FF",visibility:"hidden"},dragLine:{position:"fixed",pointerEvents:"none",left:0,top:0,right:0,bottom:0}});var rn=function(e){var t=e.code,n=e.inflate,i=e.setCode,o=e.notes,l=e.setNotes,s=e.time2Timers,u=e.matchNotePure,m=e.findNotePure,d=e.innerEl,f=e.quantize,b=e.deflate,v=an(),p=Object(a.useCallback)((function(){return i("select")}),[i]),h=Object(a.useCallback)((function(e,a){if("select"!==t)return!1;a.click=!0;var r=n(e),i=r.time,c=r.lane,l=u(o,s,i,c,.1);if(l){a.move=!0;var d=l.time,f=l.lane,v=l.beat,p=b({time:d,lane:f}),h=p.x,g=p.y;a.startX=h,a.startY=g,a.startIndex=m(o,v,f).index}else a.move=!1}),[t,b,m,n,u,o,s]),g=Object(a.useState)(null),E=Object(c.a)(g,2),j=E[0],y=E[1],k=Object(a.useState)(null),C=Object(c.a)(k,2),x=C[0],w=C[1],S=Object(a.useCallback)((function(e,t){var a=t.startX,r=t.startY;if(Math.sqrt(Math.pow(e.clientX-a,2)+Math.pow(e.clientY-r,2))>10&&(t.click=!1),j){j.style.visibility=t.move?"hidden":"unset";var i=Math.min(e.clientX,a),o=Math.max(e.clientX,a),c=Math.min(e.clientY,r),l=Math.max(e.clientY,r);j.style.left="".concat(i,"px"),j.style.top="".concat(c,"px"),j.style.width="".concat(o-i,"px"),j.style.height="".concat(l-c,"px")}if(x){var s=n(e),u=s.time,m=s.lane,d=f(u).time,v=Math.round(m);v<0&&(v=0),v>6&&(v=6);var p=b({time:d,lane:v}),h=p.x,g=p.y;x.style.visibility=t.move?"unset":"hidden";var E=t.shift?a:h,O=a,y=g,k=r;x.setAttribute("x1","".concat(E)),x.setAttribute("x2","".concat(O)),x.setAttribute("y1","".concat(y)),x.setAttribute("y2","".concat(k))}}),[b,j,x,n,f]),N=Object(a.useCallback)((function(e){for(var t=e.begin;t.valid;t.next()){var n=t,a=n.index,r=n.value.selected,i=void 0!==r&&r,o=n.value;i&&(e=t.update(Object(O.a)({},o,{selected:!1})),t=e.at(a))}return e}),[]),F=Object(a.useCallback)((function(e,t,n,a,r){for(var i=e.ge(t);i.valid&&i.key<n;i.next()){var o=i,c=o.index,l=o.value,s=o.value,u=s.lane,m=s.selected;u>=a&&u<r&&(e=i.update(Object(O.a)({},l,{selected:!m})),i=e.at(c))}return e}),[]),M=Object(a.useCallback)((function(e,t){var a=t.right,r=t.startX,i=t.startY,c=t.shift,d=t.click,b=t.move,v=t.startIndex,p=n(e),h=p.time,g=p.beat,E=p.lane;if(a){var y=u(o,s,h,E,.1);if(y){var k=o,C=m(k,y.beat,y.lane),w=C.index;if(!C.value.selected){var S=(k=N(k)).at(w);k=S.update(Object(O.a)({},S.value,{selected:!0}))}for(var M=nt()(),D=k.begin;D.valid;D.next()){var L=D.key,B=D.value;D.value.selected||(M=M.insert(L,B))}l(M)}}else if(d){var T=o;c||(T=N(T));var R=u(o,s,h,E,.1);if(R){var z=R.beat,H=R.lane,K=m(T,z,H);T=K.update(Object(O.a)({},K.value,{selected:!K.value.selected}))}l(T)}else if(b){var Y=n(e),I=Y.time,X=Y.lane,P=f(I).beat,W=Math.round(X);W<0&&(W=0),W>6&&(W=6);var A=nt()(),q=o,$=q.at(v),U=$.key,J=$.value,V=J.selected,G=J.lane;if(!V){var Z=(q=N(q)).at(v);q=Z.update(Object(O.a)({},Z.value,{selected:!0}))}for(var _=P-U,Q=c?0:W-G,ee=function(e,t){var n=t.lane;m(A,e,n)||(A=A.insert(e,t))},te=q.begin;te.valid;te.next()){var ne=te.key,ae=te.value,re=te.value,ie=re.selected,oe=re.lane;if(ie){var ce=ne+_;if(ce<0)continue;var le=oe+Q;le<0&&(le=0),le>6&&(le=6),ee(ce,Object(O.a)({},ae,{lane:le}))}else ee(ne,ae)}l(A)}else{var se=o;c||(se=N(se));var ue=n({clientX:r,clientY:i}),me=ue.beat,de=ue.lane,fe=g,be=E,ve=Math.min(me,fe),pe=Math.max(me,fe),he=Math.min(de,be),ge=Math.max(de,be);se=F(se,ve,pe,he,ge),l(se)}j&&(j.style.visibility="hidden"),x&&(x.style.visibility="hidden")}),[N,j,x,m,n,u,o,f,l,s,F]);return Et({onDragStart:h,onDrag:S,onDragEnd:M,el:d}),r.a.createElement(r.a.Fragment,null,r.a.createElement(Lt.a,{handleKeys:["v"],onKeyEvent:p}),r.a.createElement("div",{className:v.dragArea,ref:y}),r.a.createElement("div",{className:v.dragLine},r.a.createElement("svg",{width:"100%",height:"100%"},r.a.createElement("line",{stroke:"#5996FF",strokeWidth:"2",x1:"100",x2:"200",y1:"100",y2:"200",ref:w,style:{visibility:"hidden"}}))))},on=Object(l.a)({middle:{position:"absolute",left:"25%",top:0,height:"100%",display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"stretch"},right:{position:"absolute",right:0,height:"100%",top:0}});var cn=function(e){var t=e.music,n=e.score,a=on(),i=it({music:t,score:n}),o=et(i),c=Qe(),l=Object(O.a)({music:t},i,{},o,{},c);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:a.middle},r.a.createElement(lt,l,r.a.createElement(ut,l),r.a.createElement(St,l),r.a.createElement(Qt,l),r.a.createElement(Gt,l),r.a.createElement(gt,l),r.a.createElement(Wt,l),r.a.createElement(Xt,l),r.a.createElement(Bt,l),r.a.createElement(Yt,l),r.a.createElement(Ut,l),r.a.createElement(Zt,l),r.a.createElement(tn,l),r.a.createElement(nn,l),r.a.createElement(rn,l)),r.a.createElement(_e,Object.assign({music:t},l))),r.a.createElement("div",{className:a.right},r.a.createElement(Ot,l,r.a.createElement(ut,Object.assign({},l,{division:.25,thumb:!0})),r.a.createElement(Mt,l),r.a.createElement(gt,Object.assign({},l,{thumb:!0})),r.a.createElement(Ct,l))))},ln=Object(l.a)({middle:{position:"absolute",left:"25%",top:0,height:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:470,fontSize:28,fontWeight:"bold",backgroundColor:"#000",color:"#FFF"},right:{position:"absolute",right:0,height:"100%",top:0,width:"11em",fontSize:"".concat(78/11,"px"),backgroundColor:"#000"}});var sn=function(e){var t=e.children,n=ln();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:n.middle},t),r.a.createElement("div",{className:n.right}))},un=Object(l.a)({root:{width:"100%",height:"100%"},left:{position:"absolute",left:0,top:0},middle:{position:"absolute",left:"25%",top:0,height:"100%"}});var mn=function(){var e=un(),t=Object(a.useMemo)((function(){return function(){var e=localStorage.getItem("score");return null===e?y:JSON.parse(e)}()}),[]),n=Object(a.useState)(t),i=Object(c.a)(n,2),o=i[0],l=i[1],s=Object(a.useState)(localStorage.getItem("music")),u=Object(c.a)(s,2),m=u[0],d=u[1];Object(a.useEffect)((function(){m&&localStorage.setItem("music",m)}),[m]);var f=Object(a.useMemo)((function(){return new Audio}),[]);Object(a.useEffect)((function(){f.src=m,f.load()}),[f,m]);var b=Object(a.useState)(!1),v=Object(c.a)(b,2),p=v[0],h=v[1],g=Object(a.useCallback)((function(){return h(f.duration>0)}),[f]);ae(f,"durationchange",g);var E=Object(a.useCallback)((function(){return h(!1)}),[]);ae(f,"emptied",E);var j={score:o,setScore:l,musicURL:m,setMusicURL:d,music:f,musicLoaded:p};return r.a.createElement("div",{className:e.root},r.a.createElement("div",{className:e.left},r.a.createElement(ne,j)),p?r.a.createElement(cn,j):r.a.createElement(sn,null,null===m?"\u8bf7\u5148\u9009\u62e9\u6b4c\u66f2":"\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u5019"))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(mn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}]),[[56,1,2]]]);
//# sourceMappingURL=main.b9ac029d.chunk.js.map